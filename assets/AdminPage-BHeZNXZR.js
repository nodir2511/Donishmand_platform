import{e as i,u as v,r as s,k as x,j as e,L as h,U as w}from"./index-BrecVWwG.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=i("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=i("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=i("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=i("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),U=()=>{const{t:z}=v(),[c,d]=s.useState([]),[g,u]=s.useState(!0),[l,p]=s.useState(""),[f,o]=s.useState(null);s.useEffect(()=>{j()},[]);const j=async()=>{try{const{data:t,error:a}=await x.from("profiles").select("*").order("created_at",{ascending:!1});if(a)throw a;d(t||[])}catch(t){console.error("Error fetching users:",t)}finally{u(!1)}},b=async(t,a)=>{o(t);try{const{error:r}=await x.from("profiles").update({role:a}).eq("id",t);if(r)throw r;d(c.map(n=>n.id===t?{...n,role:a}:n))}catch(r){console.error("Error updating role:",r),alert("Failed to update role")}finally{o(null)}},y=t=>{switch(t){case"super_admin":return e.jsx(k,{className:"text-red-500",size:20});case"admin":return e.jsx(S,{className:"text-gaming-accent",size:20});case"teacher":return e.jsx(M,{className:"text-gaming-primary",size:20});default:return e.jsx(w,{className:"text-gray-400",size:20})}},N=t=>{switch(t){case"super_admin":return"border-red-500/50 bg-red-500/10 text-red-400";case"admin":return"border-gaming-accent/50 bg-gaming-accent/10 text-gaming-accent";case"teacher":return"border-gaming-primary/50 bg-gaming-primary/10 text-gaming-primary";default:return"border-white/10 bg-white/5 text-gray-400"}},m=c.filter(t=>{var a,r;return((a=t.email)==null?void 0:a.toLowerCase().includes(l.toLowerCase()))||((r=t.full_name)==null?void 0:r.toLowerCase().includes(l.toLowerCase()))});return g?e.jsx("div",{className:"min-h-screen pt-24 flex items-center justify-center",children:e.jsx(h,{className:"animate-spin text-gaming-primary",size:40})}):e.jsxs("div",{className:"min-h-screen pt-24 pb-12 px-4 container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-heading font-bold text-white mb-2",children:"Управление пользователями"}),e.jsx("p",{className:"text-gaming-textMuted",children:"Управление ролями и доступом пользователей"})]}),e.jsxs("div",{className:"mb-6 relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Поиск пользователей...",value:l,onChange:t=>p(t.target.value),className:"w-full bg-gaming-card border border-white/10 rounded-xl py-3 pl-10 pr-4 text-white focus:outline-none focus:border-gaming-primary transition-colors"})]}),e.jsxs("div",{className:"bg-gaming-card border border-white/5 rounded-2xl overflow-hidden backdrop-blur-xl",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5 bg-white/5",children:[e.jsx("th",{className:"p-4 text-gaming-textMuted font-medium",children:"Пользователь"}),e.jsx("th",{className:"p-4 text-gaming-textMuted font-medium",children:"Email"}),e.jsx("th",{className:"p-4 text-gaming-textMuted font-medium",children:"Роль"}),e.jsx("th",{className:"p-4 text-gaming-textMuted font-medium",children:"Действия"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:m.map(t=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gaming-primary/20 flex items-center justify-center border border-gaming-primary/30",children:y(t.role)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:t.full_name||"Без имени"}),e.jsxs("div",{className:"text-xs text-gaming-textMuted",children:["ID: ",t.id.slice(0,8),"..."]})]})]})}),e.jsx("td",{className:"p-4 text-gray-300",children:t.email||"Нет email"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs border ${N(t.role)}`,children:t.role||"user"})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex items-center gap-2",children:f===t.id?e.jsx(h,{className:"animate-spin text-gaming-primary",size:20}):e.jsxs("select",{value:t.role||"user",onChange:a=>b(t.id,a.target.value),className:"bg-black/40 border border-white/10 rounded-lg py-1.5 px-3 text-sm text-gray-300 focus:outline-none focus:border-gaming-primary cursor-pointer hover:bg-black/60 transition-colors",children:[e.jsx("option",{value:"user",children:"Пользователь"}),e.jsx("option",{value:"teacher",children:"Учитель"}),e.jsx("option",{value:"admin",children:"Админ"}),e.jsx("option",{value:"super_admin",children:"Супер Админ"})]})})})]},t.id))})]})}),m.length===0&&e.jsx("div",{className:"p-8 text-center text-gaming-textMuted",children:"Пользователи не найдены"})]})]})};export{U as default};
