import{j as e}from"./editor-f5jKbLka.js";import{u as ie,r as s}from"./vendor-DfgOC3sD.js";import{u as ne}from"./index-D66Skuuy.js";import{b as le,c as v}from"./branchService-lYS7PZw6.js";import{u as oe,a6 as k,a7 as U,J as $,_ as z,k as S,w as M,x as de,f as G,A as ce,a8 as me,X}from"./ui-BCi4cqbw.js";import"./supabase-CQnWzhEg.js";const fe=()=>{const{t:xe}=oe(),H=ie(),{user:c,profile:r}=ne(),[m,y]=s.useState([]),[K,_]=s.useState(!0),[B,E]=s.useState(null),[Q,i]=s.useState(!1),[x,h]=s.useState(""),[w,u]=s.useState(""),[N,g]=s.useState(""),[I,J]=s.useState(!1),[D,n]=s.useState(""),[V,l]=s.useState(!1),[p,b]=s.useState(""),[A,L]=s.useState(!1),[T,o]=s.useState(""),[C,W]=s.useState([]),[j,Y]=s.useState("all"),f=["teacher","admin","super_admin"].includes(r==null?void 0:r.role),d=(r==null?void 0:r.role)==="student",P=[{id:"math",name:"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",icon:"üìê"},{id:"physics",name:"–§–∏–∑–∏–∫–∞",icon:"‚ö°"},{id:"dt",name:"Design and Technology",icon:"üõ†Ô∏è"},{id:"biology",name:"–ë–∏–æ–ª–æ–≥–∏—è",icon:"üß¨"},{id:"chemistry",name:"–•–∏–º–∏—è",icon:"üß™"},{id:"history",name:"–ò—Å—Ç–æ—Ä–∏—è",icon:"üìú"}];s.useEffect(()=>{r&&(q(),Z())},[r]);const Z=async()=>{try{const t=await le.getBranches();W(t)}catch(t){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∏–ª–∏–∞–ª–æ–≤:",t)}},q=async()=>{_(!0),E(null);try{if(f){const t=await v.getTeacherClasses(c.id);y(t)}else if(d){const t=await v.getStudentClasses(c.id);y(t)}}catch(t){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤:",t),E("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤")}finally{_(!1)}},ee=async t=>{if(t.preventDefault(),n(""),!x.trim()){n("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞");return}J(!0);try{const a=await v.createClass(x,c.id,w||null,N||null);y([{...a,studentsCount:0},...m]),i(!1),h(""),u(""),g("")}catch(a){console.error("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞:",a),n("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")}finally{J(!1)}},te=async t=>{if(t.preventDefault(),o(""),!p.trim()){o("–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è");return}L(!0);try{await v.joinClassByCode(c.id,p,r.role),await q(),l(!1),b("")}catch(a){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:",a),o(a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–ª–∞—Å—Å—É")}finally{L(!1)}},se=t=>{H(`/classes/${t}`)},ae=t=>{if(!t)return"";const a={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString(void 0,a)},F=m.filter(t=>j==="all"?!0:j==="none"?!t.branch_id:t.branch_id===j);return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-heading font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(k,{className:"text-gaming-primary",size:32}),d?"–ú–æ–∏ –∫–ª–∞—Å—Å—ã":"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞–º–∏"]}),e.jsx("p",{className:"text-gaming-textMuted",children:d?"–ö–ª–∞—Å—Å—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —Å–æ—Å—Ç–æ–∏—Ç–µ":"–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∫–ª–∞—Å—Å—ã –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —É—á–µ–Ω–∏–∫–∞–º–∏"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("button",{onClick:()=>{l(!0),b(""),o("")},className:"flex items-center gap-2 px-6 py-3 bg-white/10 text-white rounded-xl font-medium transition-all shadow-lg hover:bg-white/20 active:scale-95",children:[e.jsx(U,{size:20}),"–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ –∫–æ–¥—É"]}),f&&e.jsxs("button",{onClick:()=>{i(!0),h(""),u(""),g(""),n("")},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-gaming-primary to-gaming-purple text-white rounded-xl font-medium transition-all shadow-lg hover:shadow-gaming-primary/25 hover:scale-105 active:scale-95",children:[e.jsx($,{size:20}),"–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å"]})]})]}),m.length>0&&C.length>0&&e.jsx("div",{className:"mb-6 flex justify-end",children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:j,onChange:t=>Y(t.target.value),className:"bg-gaming-card border border-white/10 rounded-xl py-2 pl-4 pr-10 text-white focus:outline-none focus:border-gaming-primary appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"–í—Å–µ —Ñ–∏–ª–∏–∞–ª—ã"}),e.jsx("option",{value:"none",children:"–ë–µ–∑ —Ñ–∏–ª–∏–∞–ª–∞"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",size:16})]})}),K?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(S,{className:"animate-spin text-gaming-primary",size:40})}):B?e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 p-6 rounded-2xl flex items-center gap-4",children:[e.jsx(M,{size:24}),e.jsx("p",{children:B})]}):m.length===0?e.jsxs("div",{className:"bg-gaming-card/40 border border-white/5 rounded-2xl p-12 text-center text-gaming-textMuted flex flex-col items-center",children:[e.jsx(de,{size:64,className:"mb-4 text-gaming-primary/50"}),e.jsx("h3",{className:"text-xl text-white font-medium mb-2",children:d?"–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –Ω–∏ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ":"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤"}),e.jsx("p",{className:"max-w-md mx-auto relative z-10",children:d?"–°–ø—Ä–æ—Å–∏—Ç–µ —É –≤–∞—à–µ–≥–æ —É—á–∏—Ç–µ–ª—è, –¥–æ–±–∞–≤–∏–ª –ª–∏ –æ–Ω –≤–∞—Å –≤ —Å–≤–æ–π –∫–ª–∞—Å—Å.":"–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –∫–ª–∞—Å—Å, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –¥–æ–±–∞–≤–ª—è—Ç—å —É—á–µ–Ω–∏–∫–æ–≤ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å."}),f?e.jsx("button",{onClick:()=>{i(!0),h(""),u(""),g(""),n("")},className:"mt-6 px-6 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-xl transition-colors backdrop-blur-md relative z-10",children:"–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –∫–ª–∞—Å—Å"}):e.jsx("button",{onClick:()=>{l(!0),b(""),o("")},className:"mt-6 px-6 py-2.5 bg-gaming-primary/20 text-gaming-primary hover:bg-gaming-primary hover:text-white rounded-xl transition-colors backdrop-blur-md relative z-10 font-medium",children:"–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ø–æ –∫–æ–¥—É"})]}):F.length===0?e.jsx("div",{className:"bg-gaming-card/40 border border-white/5 rounded-2xl p-12 text-center text-gaming-textMuted",children:e.jsx("p",{children:"–ù–µ—Ç –∫–ª–∞—Å—Å–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Ñ–∏–ª–∏–∞–ª—É."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map((t,a)=>{var O,R;return e.jsxs("div",{onClick:()=>se(t.id),className:"bg-gaming-card/60 backdrop-blur-xl border border-white/10 rounded-2xl p-6 cursor-pointer group hover:border-gaming-primary/50 transition-all duration-300 hover:shadow-[0_0_30px_rgba(108,93,211,0.15)] hover:-translate-y-1 animate-fade-in-up",style:{animationDelay:`${a*.1}s`},children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 bg-gaming-primary/10 rounded-xl text-gaming-primary group-hover:scale-110 transition-transform",children:e.jsx(G,{size:24})}),e.jsx(ce,{className:"text-gaming-textMuted opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all",size:20})]}),e.jsx("h3",{className:"text-xl font-heading font-bold text-white mb-2 line-clamp-2",children:t.name}),e.jsxs("div",{className:"space-y-2 mt-4 text-sm text-gaming-textMuted",children:[f?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{size:16}),e.jsxs("span",{children:["–£—á–µ–Ω–∏–∫–æ–≤: ",e.jsx("strong",{className:"text-white",children:t.studentsCount||0})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{size:16}),e.jsxs("span",{children:["–£—á–∏—Ç–µ–ª—å: ",e.jsx("strong",{className:"text-white",children:((O=t.teacher)==null?void 0:O.full_name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"})]})]}),t.branch&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:16}),e.jsxs("span",{children:["–§–∏–ª–∏–∞–ª: ",e.jsx("strong",{className:"text-white",children:t.branch.name})]})]}),t.subject_id&&e.jsx("div",{className:"flex items-center gap-2 text-gaming-textMuted",children:e.jsxs("span",{children:["–ü—Ä–µ–¥–º–µ—Ç: ",e.jsx("strong",{className:"text-gaming-accent",children:((R=P.find(re=>re.id===t.subject_id))==null?void 0:R.name)||t.subject_id})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{size:16}),e.jsxs("span",{children:["–°–æ–∑–¥–∞–Ω: ",ae(t.created_at||t.joinedAt)]})]})]})]},t.id)})}),Q&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-gaming-card border border-white/10 rounded-2xl w-full max-w-md overflow-hidden animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/5",children:[e.jsx("h2",{className:"text-xl font-heading font-bold text-white",children:"–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(X,{size:24})})]}),e.jsxs("form",{onSubmit:ee,className:"p-6",children:[D&&e.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-xl text-red-400 text-sm flex items-center gap-2",children:[e.jsx(M,{size:16}),D]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞"}),e.jsx("input",{type:"text",value:x,onChange:t=>h(t.target.value),placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: 10-–ê –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞",className:"w-full bg-black/30 border border-white/10 rounded-xl py-3 px-4 text-white placeholder-gray-500 focus:outline-none focus:border-gaming-primary transition-colors",autoFocus:!0,required:!0}),e.jsx("p",{className:"mt-2 text-xs text-gaming-textMuted",children:"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã —É—á–µ–Ω–∏–∫–∞–º –±—ã–ª–æ –ª–µ–≥—á–µ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:"–ü—Ä–µ–¥–º–µ—Ç (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:N,onChange:t=>g(t.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl py-3 pl-4 pr-10 text-white focus:outline-none focus:border-gaming-primary appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"–ë–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø—Ä–µ–¥–º–µ—Ç—É"}),P.map(t=>e.jsxs("option",{value:t.id,children:[t.icon," ",t.name]},t.id))]}),e.jsx(G,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",size:18})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:"–§–∏–ª–∏–∞–ª (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:w,onChange:t=>u(t.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl py-3 pl-4 pr-10 text-white focus:outline-none focus:border-gaming-primary appearance-none cursor-pointer",children:[e.jsx("option",{value:"",children:"–ë–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Ñ–∏–ª–∏–∞–ª—É"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(z,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",size:18})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-5 py-2.5 rounded-xl border border-white/10 text-white hover:bg-white/5 transition-colors",children:"–û—Ç–º–µ–Ω–∞"}),e.jsxs("button",{type:"submit",disabled:I||!x.trim(),className:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-gaming-primary text-white font-medium hover:bg-gaming-primary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[I?e.jsx(S,{size:18,className:"animate-spin"}):e.jsx($,{size:18}),"–°–æ–∑–¥–∞—Ç—å"]})]})]})]})}),V&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-gaming-card border border-white/10 rounded-2xl w-full max-w-md overflow-hidden animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/5",children:[e.jsxs("h2",{className:"text-xl font-heading font-bold text-white flex items-center gap-2",children:[e.jsx(U,{className:"text-gaming-primary"}),"–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–ª–∞—Å—Å—É"]}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(X,{size:24})})]}),e.jsxs("form",{onSubmit:te,className:"p-6",children:[T&&e.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-xl text-red-400 text-sm flex items-center gap-2",children:[e.jsx(M,{size:16}),T]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:"–ö–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è"}),e.jsx("input",{type:"text",value:p,onChange:t=>b(t.target.value.toUpperCase()),placeholder:"–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥...",className:"w-full bg-black/30 border border-white/10 rounded-xl py-4 px-4 text-center text-xl font-bold tracking-widest text-gaming-primary placeholder-gray-600 focus:outline-none focus:border-gaming-primary transition-colors",autoFocus:!0,required:!0}),e.jsx("p",{className:"mt-4 text-xs text-gaming-textMuted text-center",children:"–ö–æ–¥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —É —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–ª–∞—Å—Å–∞."})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-5 py-2.5 rounded-xl border border-white/10 text-white hover:bg-white/5 transition-colors",children:"–û—Ç–º–µ–Ω–∞"}),e.jsx("button",{type:"submit",disabled:A||!p.trim(),className:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-gaming-primary text-white font-medium hover:bg-gaming-primary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:A?e.jsx(S,{size:18,className:"animate-spin"}):"–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è"})]})]})]})})]})};export{fe as default};
