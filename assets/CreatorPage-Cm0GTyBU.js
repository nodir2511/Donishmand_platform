const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LessonContentEditor-maHd02Mn.js","assets/index-DRfO7QNx.js","assets/index-CBc2x8US.css","assets/video-GjhmAmWB.js","assets/katex-BMcjISZR.js","assets/SyllabusContext-x_XbzDWO.js","assets/save-CHh5reZj.js","assets/useDebounce-tfDXdiEZ.js","assets/chevron-left-DH9hOaJo.js"])))=>i.map(i=>d[i]);
import{e as ze,r as l,R as te,g as Ge,u as Ut,b as Gn,h as dt,j as a,L as Hn,S as Kn,i as It,C as tn,_ as qn}from"./index-DRfO7QNx.js";import{B as Jn,s as ut,i as nn,F as yn}from"./SyllabusContext-x_XbzDWO.js";import{u as Zn}from"./useDebounce-tfDXdiEZ.js";import{C as Qn}from"./chevron-left-DH9hOaJo.js";import{G as er,S as ft}from"./save-CHh5reZj.js";import{V as tr,C as nr,P as rr}from"./video-GjhmAmWB.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=ze("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=ze("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=ze("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=ze("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=ze("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=ze("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const wt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Be(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Wt(e){return"nodeType"in e}function re(e){var t,n;return e?Be(e)?e:Wt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Vt(e){const{Document:t}=re(e);return e instanceof t}function tt(e){return Be(e)?!1:e instanceof re(e).HTMLElement}function Sn(e){return e instanceof re(e).SVGElement}function $e(e){return e?Be(e)?e.document:Wt(e)?Vt(e)?e:tt(e)||Sn(e)?e.ownerDocument:document:document:document}const xe=wt?l.useLayoutEffect:l.useEffect;function Gt(e){const t=l.useRef(e);return xe(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function ar(){const e=l.useRef(null),t=l.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Ze(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return xe(()=>{n.current!==e&&(n.current=e)},t),n}function nt(e,t){const n=l.useRef();return l.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function xt(e){const t=Gt(e),n=l.useRef(null),r=l.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function _t(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let Mt={};function rt(e,t){return l.useMemo(()=>{if(t)return t;const n=Mt[e]==null?0:Mt[e]+1;return Mt[e]=n,e+"-"+n},[e,t])}function jn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((o,d)=>{const c=Object.entries(d);for(const[u,f]of c){const g=o[u];g!=null&&(o[u]=g+e*f)}return o},{...t})}}const Fe=jn(1),Qe=jn(-1);function cr(e){return"clientX"in e&&"clientY"in e}function Ht(e){if(!e)return!1;const{KeyboardEvent:t}=re(e.target);return t&&e instanceof t}function lr(e){if(!e)return!1;const{TouchEvent:t}=re(e.target);return t&&e instanceof t}function Ft(e){if(lr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return cr(e)?{x:e.clientX,y:e.clientY}:null}const Oe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Oe.Translate.toString(e),Oe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),sn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function dr(e){return e.matches(sn)?e:e.querySelector(sn)}const ur={display:"none"};function fr(e){let{id:t,value:n}=e;return te.createElement("div",{id:t,style:ur},n)}function gr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return te.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function hr(){const[e,t]=l.useState("");return{announce:l.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Cn=l.createContext(null);function pr(e){const t=l.useContext(Cn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function mr(){const[e]=l.useState(()=>new Set),t=l.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[l.useCallback(r=>{let{type:s,event:o}=r;e.forEach(d=>{var c;return(c=d[s])==null?void 0:c.call(d,o)})},[e]),t]}const xr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},vr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function br(e){let{announcements:t=vr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=xr}=e;const{announce:o,announcement:d}=hr(),c=rt("DndLiveRegion"),[u,f]=l.useState(!1);if(l.useEffect(()=>{f(!0)},[]),pr(l.useMemo(()=>({onDragStart(h){let{active:b}=h;o(t.onDragStart({active:b}))},onDragMove(h){let{active:b,over:x}=h;t.onDragMove&&o(t.onDragMove({active:b,over:x}))},onDragOver(h){let{active:b,over:x}=h;o(t.onDragOver({active:b,over:x}))},onDragEnd(h){let{active:b,over:x}=h;o(t.onDragEnd({active:b,over:x}))},onDragCancel(h){let{active:b,over:x}=h;o(t.onDragCancel({active:b,over:x}))}}),[o,t])),!u)return null;const g=te.createElement(te.Fragment,null,te.createElement(fr,{id:r,value:s.draggable}),te.createElement(gr,{id:c,announcement:d}));return n?Ge.createPortal(g,n):g}var H;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(H||(H={}));function vt(){}function on(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function yr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ge=Object.freeze({x:0,y:0});function Tn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Rn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function wr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function an(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function Nn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function cn(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Sr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=cn(t,t.left,t.top),o=[];for(const d of r){const{id:c}=d,u=n.get(c);if(u){const f=Tn(cn(u),s);o.push({id:c,data:{droppableContainer:d,value:f}})}}return o.sort(Rn)},jr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=an(t),o=[];for(const d of r){const{id:c}=d,u=n.get(c);if(u){const f=an(u),g=s.reduce((b,x,E)=>b+Tn(f[E],x),0),h=Number((g/4).toFixed(4));o.push({id:c,data:{droppableContainer:d,value:h}})}}return o.sort(Rn)};function Cr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),d=s-r,c=o-n;if(r<s&&n<o){const u=t.width*t.height,f=e.width*e.height,g=d*c,h=g/(u+f-g);return Number(h.toFixed(4))}return 0}const Tr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const o of r){const{id:d}=o,c=n.get(d);if(c){const u=Cr(c,t);u>0&&s.push({id:d,data:{droppableContainer:o,value:u}})}}return s.sort(wr)};function Rr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Dn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ge}function Nr(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s.reduce((d,c)=>({...d,top:d.top+e*c.y,bottom:d.bottom+e*c.y,left:d.left+e*c.x,right:d.right+e*c.x}),{...n})}}const Dr=Nr(1);function Er(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ir(e,t,n){const r=Er(t);if(!r)return e;const{scaleX:s,scaleY:o,x:d,y:c}=r,u=e.left-d-(1-s)*parseFloat(n),f=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),g=s?e.width/s:e.width,h=o?e.height/o:e.height;return{width:g,height:h,top:f,right:u+g,bottom:f+h,left:u}}const Mr={ignoreTransform:!1};function Ye(e,t){t===void 0&&(t=Mr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:g}=re(e).getComputedStyle(e);f&&(n=Ir(n,f,g))}const{top:r,left:s,width:o,height:d,bottom:c,right:u}=n;return{top:r,left:s,width:o,height:d,bottom:c,right:u}}function ln(e){return Ye(e,{ignoreTransform:!0})}function kr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Ar(e,t){return t===void 0&&(t=re(e).getComputedStyle(e)),t.position==="fixed"}function Lr(e,t){t===void 0&&(t=re(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?n.test(o):!1})}function St(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Vt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!tt(s)||Sn(s)||n.includes(s))return n;const o=re(e).getComputedStyle(s);return s!==e&&Lr(s,o)&&n.push(s),Ar(s,o)?n:r(s.parentNode)}return e?r(e):n}function En(e){const[t]=St(e,1);return t??null}function kt(e){return!wt||!e?null:Be(e)?e:Wt(e)?Vt(e)||e===$e(e).scrollingElement?window:tt(e)?e:null:null}function In(e){return Be(e)?e.scrollX:e.scrollLeft}function Mn(e){return Be(e)?e.scrollY:e.scrollTop}function Bt(e){return{x:In(e),y:Mn(e)}}var q;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(q||(q={}));function kn(e){return!wt||!e?!1:e===document.scrollingElement}function An(e){const t={x:0,y:0},n=kn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,d=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:s,isLeft:o,isBottom:d,isRight:c,maxScroll:r,minScroll:t}}const Or={x:.2,y:.2};function zr(e,t,n,r,s){let{top:o,left:d,right:c,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=Or);const{isTop:f,isBottom:g,isLeft:h,isRight:b}=An(e),x={x:0,y:0},E={x:0,y:0},S={height:t.height*s.y,width:t.width*s.x};return!f&&o<=t.top+S.height?(x.y=q.Backward,E.y=r*Math.abs((t.top+S.height-o)/S.height)):!g&&u>=t.bottom-S.height&&(x.y=q.Forward,E.y=r*Math.abs((t.bottom-S.height-u)/S.height)),!b&&c>=t.right-S.width?(x.x=q.Forward,E.x=r*Math.abs((t.right-S.width-c)/S.width)):!h&&d<=t.left+S.width&&(x.x=q.Backward,E.x=r*Math.abs((t.left+S.width-d)/S.width)),{direction:x,speed:E}}function Pr(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:d}=window;return{top:0,left:0,right:o,bottom:d,width:o,height:d}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function Ln(e){return e.reduce((t,n)=>Fe(t,Bt(n)),ge)}function _r(e){return e.reduce((t,n)=>t+In(n),0)}function Fr(e){return e.reduce((t,n)=>t+Mn(n),0)}function Br(e,t){if(t===void 0&&(t=Ye),!e)return;const{top:n,left:r,bottom:s,right:o}=t(e);En(e)&&(s<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const $r=[["x",["left","right"],_r],["y",["top","bottom"],Fr]];class Kt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=St(n),s=Ln(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,d,c]of $r)for(const u of d)Object.defineProperty(this,u,{get:()=>{const f=c(r),g=s[o]-f;return this.rect[u]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class He{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Yr(e){const{EventTarget:t}=re(e);return e instanceof t?e:$e(e)}function At(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ce;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ce||(ce={}));function dn(e){e.preventDefault()}function Ur(e){e.stopPropagation()}var P;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(P||(P={}));const On={start:[P.Space,P.Enter],cancel:[P.Esc],end:[P.Space,P.Enter,P.Tab]},Xr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case P.Right:return{...n,x:n.x+25};case P.Left:return{...n,x:n.x-25};case P.Down:return{...n,y:n.y+25};case P.Up:return{...n,y:n.y-25}}};class qt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new He($e(n)),this.windowListeners=new He(re(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ce.Resize,this.handleCancel),this.windowListeners.add(ce.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ce.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Br(r),n(ge)}handleKeyDown(t){if(Ht(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:o=On,coordinateGetter:d=Xr,scrollBehavior:c="smooth"}=s,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=r.current,g=f?{x:f.left,y:f.top}:ge;this.referenceCoordinates||(this.referenceCoordinates=g);const h=d(t,{active:n,context:r.current,currentCoordinates:g});if(h){const b=Qe(h,g),x={x:0,y:0},{scrollableAncestors:E}=r.current;for(const S of E){const v=t.code,{isTop:I,isRight:k,isLeft:D,isBottom:A,maxScroll:z,minScroll:L}=An(S),N=Pr(S),T={x:Math.min(v===P.Right?N.right-N.width/2:N.right,Math.max(v===P.Right?N.left:N.left+N.width/2,h.x)),y:Math.min(v===P.Down?N.bottom-N.height/2:N.bottom,Math.max(v===P.Down?N.top:N.top+N.height/2,h.y))},Y=v===P.Right&&!k||v===P.Left&&!D,X=v===P.Down&&!A||v===P.Up&&!I;if(Y&&T.x!==h.x){const $=S.scrollLeft+b.x,Z=v===P.Right&&$<=z.x||v===P.Left&&$>=L.x;if(Z&&!b.y){S.scrollTo({left:$,behavior:c});return}Z?x.x=S.scrollLeft-$:x.x=v===P.Right?S.scrollLeft-z.x:S.scrollLeft-L.x,x.x&&S.scrollBy({left:-x.x,behavior:c});break}else if(X&&T.y!==h.y){const $=S.scrollTop+b.y,Z=v===P.Down&&$<=z.y||v===P.Up&&$>=L.y;if(Z&&!b.x){S.scrollTo({top:$,behavior:c});return}Z?x.y=S.scrollTop-$:x.y=v===P.Down?S.scrollTop-z.y:S.scrollTop-L.y,x.y&&S.scrollBy({top:-x.y,behavior:c});break}}this.handleMove(t,Fe(Qe(h,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}qt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=On,onActivation:s}=t,{active:o}=n;const{code:d}=e.nativeEvent;if(r.start.includes(d)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function un(e){return!!(e&&"distance"in e)}function fn(e){return!!(e&&"delay"in e)}class Jt{constructor(t,n,r){var s;r===void 0&&(r=Yr(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:d}=o;this.props=t,this.events=n,this.document=$e(d),this.documentListeners=new He(this.document),this.listeners=new He(r),this.windowListeners=new He(re(d)),this.initialCoordinates=(s=Ft(o))!=null?s:ge,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ce.Resize,this.handleCancel),this.windowListeners.add(ce.DragStart,dn),this.windowListeners.add(ce.VisibilityChange,this.handleCancel),this.windowListeners.add(ce.ContextMenu,dn),this.documentListeners.add(ce.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(fn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(un(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ce.Click,Ur,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ce.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:o}=this,{onMove:d,options:{activationConstraint:c}}=o;if(!s)return;const u=(n=Ft(t))!=null?n:ge,f=Qe(s,u);if(!r&&c){if(un(c)){if(c.tolerance!=null&&At(f,c.tolerance))return this.handleCancel();if(At(f,c.distance))return this.handleStart()}if(fn(c)&&At(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),d(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===P.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Wr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Zt extends Jt{constructor(t){const{event:n}=t,r=$e(n.target);super(t,Wr,r)}}Zt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Vr={move:{name:"mousemove"},end:{name:"mouseup"}};var $t;(function(e){e[e.RightClick=2]="RightClick"})($t||($t={}));class Gr extends Jt{constructor(t){super(t,Vr,$e(t.event.target))}}Gr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===$t.RightClick?!1:(r==null||r({event:n}),!0)}}];const Lt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Hr extends Jt{constructor(t){super(t,Lt)}static setup(){return window.addEventListener(Lt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Lt.move.name,t)};function t(){}}}Hr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Ke;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ke||(Ke={}));var bt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(bt||(bt={}));function Kr(e){let{acceleration:t,activator:n=Ke.Pointer,canScroll:r,draggingRect:s,enabled:o,interval:d=5,order:c=bt.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:g,delta:h,threshold:b}=e;const x=Jr({delta:h,disabled:!o}),[E,S]=ar(),v=l.useRef({x:0,y:0}),I=l.useRef({x:0,y:0}),k=l.useMemo(()=>{switch(n){case Ke.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Ke.DraggableRect:return s}},[n,s,u]),D=l.useRef(null),A=l.useCallback(()=>{const L=D.current;if(!L)return;const N=v.current.x*I.current.x,T=v.current.y*I.current.y;L.scrollBy(N,T)},[]),z=l.useMemo(()=>c===bt.TreeOrder?[...f].reverse():f,[c,f]);l.useEffect(()=>{if(!o||!f.length||!k){S();return}for(const L of z){if((r==null?void 0:r(L))===!1)continue;const N=f.indexOf(L),T=g[N];if(!T)continue;const{direction:Y,speed:X}=zr(L,T,k,t,b);for(const $ of["x","y"])x[$][Y[$]]||(X[$]=0,Y[$]=0);if(X.x>0||X.y>0){S(),D.current=L,E(A,d),v.current=X,I.current=Y;return}}v.current={x:0,y:0},I.current={x:0,y:0},S()},[t,A,r,S,o,d,JSON.stringify(k),JSON.stringify(x),E,f,z,g,JSON.stringify(b)])}const qr={x:{[q.Backward]:!1,[q.Forward]:!1},y:{[q.Backward]:!1,[q.Forward]:!1}};function Jr(e){let{delta:t,disabled:n}=e;const r=_t(t);return nt(s=>{if(n||!r||!s)return qr;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[q.Backward]:s.x[q.Backward]||o.x===-1,[q.Forward]:s.x[q.Forward]||o.x===1},y:{[q.Backward]:s.y[q.Backward]||o.y===-1,[q.Forward]:s.y[q.Forward]||o.y===1}}},[n,t,r])}function Zr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return nt(s=>{var o;return t==null?null:(o=r??s)!=null?o:null},[r,t])}function Qr(e,t){return l.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,o=s.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,r)}));return[...n,...o]},[]),[e,t])}var et;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(et||(et={}));var Yt;(function(e){e.Optimized="optimized"})(Yt||(Yt={}));const gn=new Map;function es(e,t){let{dragging:n,dependencies:r,config:s}=t;const[o,d]=l.useState(null),{frequency:c,measure:u,strategy:f}=s,g=l.useRef(e),h=v(),b=Ze(h),x=l.useCallback(function(I){I===void 0&&(I=[]),!b.current&&d(k=>k===null?I:k.concat(I.filter(D=>!k.includes(D))))},[b]),E=l.useRef(null),S=nt(I=>{if(h&&!n)return gn;if(!I||I===gn||g.current!==e||o!=null){const k=new Map;for(let D of e){if(!D)continue;if(o&&o.length>0&&!o.includes(D.id)&&D.rect.current){k.set(D.id,D.rect.current);continue}const A=D.node.current,z=A?new Kt(u(A),A):null;D.rect.current=z,z&&k.set(D.id,z)}return k}return I},[e,o,n,h,u]);return l.useEffect(()=>{g.current=e},[e]),l.useEffect(()=>{h||x()},[n,h]),l.useEffect(()=>{o&&o.length>0&&d(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof c!="number"||E.current!==null||(E.current=setTimeout(()=>{x(),E.current=null},c))},[c,h,x,...r]),{droppableRects:S,measureDroppableContainers:x,measuringScheduled:o!=null};function v(){switch(f){case et.Always:return!1;case et.BeforeDragging:return n;default:return!n}}}function zn(e,t){return nt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ts(e,t){return zn(e,t)}function ns(e){let{callback:t,disabled:n}=e;const r=Gt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function jt(e){let{callback:t,disabled:n}=e;const r=Gt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function rs(e){return new Kt(Ye(e),e)}function hn(e,t,n){t===void 0&&(t=rs);const[r,s]=l.useState(null);function o(){s(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??n)!=null?f:null}const g=t(e);return JSON.stringify(u)===JSON.stringify(g)?u:g})}const d=ns({callback(u){if(e)for(const f of u){const{type:g,target:h}=f;if(g==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),c=jt({callback:o});return xe(()=>{o(),e?(c==null||c.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),d==null||d.disconnect())},[e]),r}function ss(e){const t=zn(e);return Dn(e,t)}const pn=[];function os(e){const t=l.useRef(e),n=nt(r=>e?r&&r!==pn&&e&&t.current&&e.parentNode===t.current.parentNode?r:St(e):pn,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function is(e){const[t,n]=l.useState(null),r=l.useRef(e),s=l.useCallback(o=>{const d=kt(o.target);d&&n(c=>c?(c.set(d,Bt(d)),new Map(c)):null)},[]);return l.useEffect(()=>{const o=r.current;if(e!==o){d(o);const c=e.map(u=>{const f=kt(u);return f?(f.addEventListener("scroll",s,{passive:!0}),[f,Bt(f)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=e}return()=>{d(e),d(o)};function d(c){c.forEach(u=>{const f=kt(u);f==null||f.removeEventListener("scroll",s)})}},[s,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,d)=>Fe(o,d),ge):Ln(e):ge,[e,t])}function mn(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const r=e!==ge;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Qe(e,n.current):ge}function as(e){l.useEffect(()=>{if(!wt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function cs(e,t){return l.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:o}=r;return n[s]=d=>{o(d,t)},n},{}),[e,t])}function Pn(e){return l.useMemo(()=>e?kr(e):null,[e])}const xn=[];function ls(e,t){t===void 0&&(t=Ye);const[n]=e,r=Pn(n?re(n):null),[s,o]=l.useState(xn);function d(){o(()=>e.length?e.map(u=>kn(u)?r:new Kt(t(u),u)):xn)}const c=jt({callback:d});return xe(()=>{c==null||c.disconnect(),d(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),s}function ds(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return tt(t)?t:e}function us(e){let{measure:t}=e;const[n,r]=l.useState(null),s=l.useCallback(f=>{for(const{target:g}of f)if(tt(g)){r(h=>{const b=t(g);return h?{...h,width:b.width,height:b.height}:b});break}},[t]),o=jt({callback:s}),d=l.useCallback(f=>{const g=ds(f);o==null||o.disconnect(),g&&(o==null||o.observe(g)),r(g?t(g):null)},[t,o]),[c,u]=xt(d);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const fs=[{sensor:Zt,options:{}},{sensor:qt,options:{}}],gs={current:{}},mt={draggable:{measure:ln},droppable:{measure:ln,strategy:et.WhileDragging,frequency:Yt.Optimized},dragOverlay:{measure:Ye}};class qe extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const hs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new qe,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:vt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:mt,measureDroppableContainers:vt,windowRect:null,measuringScheduled:!1},ps={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:vt,draggableNodes:new Map,over:null,measureDroppableContainers:vt},Ct=l.createContext(ps),_n=l.createContext(hs);function ms(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new qe}}}function xs(e,t){switch(t.type){case H.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case H.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case H.DragEnd:case H.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case H.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new qe(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case H.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const d=new qe(e.droppable.containers);return d.set(n,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:d}}}case H.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new qe(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function vs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=l.useContext(Ct),o=_t(r),d=_t(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!r&&o&&d!=null){if(!Ht(o)||document.activeElement===o.target)return;const c=s.get(d);if(!c)return;const{activatorNode:u,node:f}=c;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const g of[u.current,f.current]){if(!g)continue;const h=dr(g);if(h){h.focus();break}}})}},[r,t,s,d,o]),null}function bs(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...r}),n):n}function ys(e){return l.useMemo(()=>({draggable:{...mt.draggable,...e==null?void 0:e.draggable},droppable:{...mt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...mt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ws(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const o=l.useRef(!1),{x:d,y:c}=typeof s=="boolean"?{x:s,y:s}:s;xe(()=>{if(!d&&!c||!t){o.current=!1;return}if(o.current||!r)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const g=n(f),h=Dn(g,r);if(d||(h.x=0),c||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const b=En(f);b&&b.scrollBy({top:h.y,left:h.x})}},[t,d,c,r,n])}const Fn=l.createContext({...ge,scaleX:1,scaleY:1});var Me;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Me||(Me={}));const Ss=l.memo(function(t){var n,r,s,o;let{id:d,accessibility:c,autoScroll:u=!0,children:f,sensors:g=fs,collisionDetection:h=Tr,measuring:b,modifiers:x,...E}=t;const S=l.useReducer(xs,void 0,ms),[v,I]=S,[k,D]=mr(),[A,z]=l.useState(Me.Uninitialized),L=A===Me.Initialized,{draggable:{active:N,nodes:T,translate:Y},droppable:{containers:X}}=v,$=N!=null?T.get(N):null,Z=l.useRef({initial:null,translated:null}),J=l.useMemo(()=>{var p;return N!=null?{id:N,data:(p=$==null?void 0:$.data)!=null?p:gs,rect:Z}:null},[N,$]),Q=l.useRef(null),[ve,be]=l.useState(null),[V,ye]=l.useState(null),se=Ze(E,Object.values(E)),he=rt("DndDescribedBy",d),ke=l.useMemo(()=>X.getEnabled(),[X]),K=ys(b),{droppableRects:le,measureDroppableContainers:de,measuringScheduled:Ae}=es(ke,{dragging:L,dependencies:[Y.x,Y.y],config:K.droppable}),oe=Zr(T,N),Ue=l.useMemo(()=>V?Ft(V):null,[V]),we=i(),pe=ts(oe,K.draggable.measure);ws({activeNode:N!=null?T.get(N):null,config:we.layoutShiftCompensation,initialRect:pe,measure:K.draggable.measure});const F=hn(oe,K.draggable.measure,pe),Le=hn(oe?oe.parentElement:null),ie=l.useRef({activatorEvent:null,active:null,activeNode:oe,collisionRect:null,collisions:null,droppableRects:le,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:X,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Te=X.getNodeFor((n=ie.current.over)==null?void 0:n.id),ue=us({measure:K.dragOverlay.measure}),Re=(r=ue.nodeRef.current)!=null?r:oe,Ne=L?(s=ue.rect)!=null?s:F:null,Xe=!!(ue.nodeRef.current&&ue.rect),st=ss(Xe?null:F),We=Pn(Re?re(Re):null),me=os(L?Te??oe:null),Pe=ls(me),fe=bs(x,{transform:{x:Y.x-st.x,y:Y.y-st.y,scaleX:1,scaleY:1},activatorEvent:V,active:J,activeNodeRect:F,containerNodeRect:Le,draggingNodeRect:Ne,over:ie.current.over,overlayNodeRect:ue.rect,scrollableAncestors:me,scrollableAncestorRects:Pe,windowRect:We}),ae=Ue?Fe(Ue,Y):null,ot=is(me),en=mn(ot),it=mn(ot,[F]),De=Fe(fe,en),Se=Ne?Dr(Ne,fe):null,Ee=J&&Se?h({active:J,collisionRect:Se,droppableRects:le,droppableContainers:ke,pointerCoordinates:ae}):null,at=Nn(Ee,"id"),[je,ee]=l.useState(null),Tt=Xe?fe:Fe(fe,it),Rt=Rr(Tt,(o=je==null?void 0:je.rect)!=null?o:null,F),Ve=l.useRef(null),ct=l.useCallback((p,w)=>{let{sensor:y,options:m}=w;if(Q.current==null)return;const j=T.get(Q.current);if(!j)return;const R=p.nativeEvent,M=new y({active:Q.current,activeNode:j,event:R,options:m,context:ie,onAbort(_){if(!T.get(_))return;const{onDragAbort:O}=se.current,B={id:_};O==null||O(B),k({type:"onDragAbort",event:B})},onPending(_,U,O,B){if(!T.get(_))return;const{onDragPending:W}=se.current,ne={id:_,constraint:U,initialCoordinates:O,offset:B};W==null||W(ne),k({type:"onDragPending",event:ne})},onStart(_){const U=Q.current;if(U==null)return;const O=T.get(U);if(!O)return;const{onDragStart:B}=se.current,G={activatorEvent:R,active:{id:U,data:O.data,rect:Z}};Ge.unstable_batchedUpdates(()=>{B==null||B(G),z(Me.Initializing),I({type:H.DragStart,initialCoordinates:_,active:U}),k({type:"onDragStart",event:G}),be(Ve.current),ye(R)})},onMove(_){I({type:H.DragMove,coordinates:_})},onEnd:C(H.DragEnd),onCancel:C(H.DragCancel)});Ve.current=M;function C(_){return async function(){const{active:O,collisions:B,over:G,scrollAdjustedTranslate:W}=ie.current;let ne=null;if(O&&W){const{cancelDrop:Ce}=se.current;ne={activatorEvent:R,active:O,collisions:B,delta:W,over:G},_===H.DragEnd&&typeof Ce=="function"&&await Promise.resolve(Ce(ne))&&(_=H.DragCancel)}Q.current=null,Ge.unstable_batchedUpdates(()=>{I({type:_}),z(Me.Uninitialized),ee(null),be(null),ye(null),Ve.current=null;const Ce=_===H.DragEnd?"onDragEnd":"onDragCancel";if(ne){const Et=se.current[Ce];Et==null||Et(ne),k({type:Ce,event:ne})}})}}},[T]),Nt=l.useCallback((p,w)=>(y,m)=>{const j=y.nativeEvent,R=T.get(m);if(Q.current!==null||!R||j.dndKit||j.defaultPrevented)return;const M={active:R};p(y,w.options,M)===!0&&(j.dndKit={capturedBy:w.sensor},Q.current=m,ct(y,w))},[T,ct]),lt=Qr(g,Nt);as(g),xe(()=>{F&&A===Me.Initializing&&z(Me.Initialized)},[F,A]),l.useEffect(()=>{const{onDragMove:p}=se.current,{active:w,activatorEvent:y,collisions:m,over:j}=ie.current;if(!w||!y)return;const R={active:w,activatorEvent:y,collisions:m,delta:{x:De.x,y:De.y},over:j};Ge.unstable_batchedUpdates(()=>{p==null||p(R),k({type:"onDragMove",event:R})})},[De.x,De.y]),l.useEffect(()=>{const{active:p,activatorEvent:w,collisions:y,droppableContainers:m,scrollAdjustedTranslate:j}=ie.current;if(!p||Q.current==null||!w||!j)return;const{onDragOver:R}=se.current,M=m.get(at),C=M&&M.rect.current?{id:M.id,rect:M.rect.current,data:M.data,disabled:M.disabled}:null,_={active:p,activatorEvent:w,collisions:y,delta:{x:j.x,y:j.y},over:C};Ge.unstable_batchedUpdates(()=>{ee(C),R==null||R(_),k({type:"onDragOver",event:_})})},[at]),xe(()=>{ie.current={activatorEvent:V,active:J,activeNode:oe,collisionRect:Se,collisions:Ee,droppableRects:le,draggableNodes:T,draggingNode:Re,draggingNodeRect:Ne,droppableContainers:X,over:je,scrollableAncestors:me,scrollAdjustedTranslate:De},Z.current={initial:Ne,translated:Se}},[J,oe,Ee,Se,T,Re,Ne,le,X,je,me,De]),Kr({...we,delta:Y,draggingRect:Se,pointerCoordinates:ae,scrollableAncestors:me,scrollableAncestorRects:Pe});const _e=l.useMemo(()=>({active:J,activeNode:oe,activeNodeRect:F,activatorEvent:V,collisions:Ee,containerNodeRect:Le,dragOverlay:ue,draggableNodes:T,droppableContainers:X,droppableRects:le,over:je,measureDroppableContainers:de,scrollableAncestors:me,scrollableAncestorRects:Pe,measuringConfiguration:K,measuringScheduled:Ae,windowRect:We}),[J,oe,F,V,Ee,Le,ue,T,X,le,je,de,me,Pe,K,Ae,We]),Dt=l.useMemo(()=>({activatorEvent:V,activators:lt,active:J,activeNodeRect:F,ariaDescribedById:{draggable:he},dispatch:I,draggableNodes:T,over:je,measureDroppableContainers:de}),[V,lt,J,F,I,he,T,je,de]);return te.createElement(Cn.Provider,{value:D},te.createElement(Ct.Provider,{value:Dt},te.createElement(_n.Provider,{value:_e},te.createElement(Fn.Provider,{value:Rt},f)),te.createElement(vs,{disabled:(c==null?void 0:c.restoreFocus)===!1})),te.createElement(br,{...c,hiddenTextDescribedById:he}));function i(){const p=(ve==null?void 0:ve.autoScrollEnabled)===!1,w=typeof u=="object"?u.enabled===!1:u===!1,y=L&&!p&&!w;return typeof u=="object"?{...u,enabled:y}:{enabled:y}}}),js=l.createContext(null),vn="button",Cs="Draggable";function Ts(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const o=rt(Cs),{activators:d,activatorEvent:c,active:u,activeNodeRect:f,ariaDescribedById:g,draggableNodes:h,over:b}=l.useContext(Ct),{role:x=vn,roleDescription:E="draggable",tabIndex:S=0}=s??{},v=(u==null?void 0:u.id)===t,I=l.useContext(v?Fn:js),[k,D]=xt(),[A,z]=xt(),L=cs(d,t),N=Ze(n);xe(()=>(h.set(t,{id:t,key:o,node:k,activatorNode:A,data:N}),()=>{const Y=h.get(t);Y&&Y.key===o&&h.delete(t)}),[h,t]);const T=l.useMemo(()=>({role:x,tabIndex:S,"aria-disabled":r,"aria-pressed":v&&x===vn?!0:void 0,"aria-roledescription":E,"aria-describedby":g.draggable}),[r,x,S,v,E,g.draggable]);return{active:u,activatorEvent:c,activeNodeRect:f,attributes:T,isDragging:v,listeners:r?void 0:L,node:k,over:b,setNodeRef:D,setActivatorNodeRef:z,transform:I}}function Rs(){return l.useContext(_n)}const Ns="Droppable",Ds={timeout:25};function Es(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const o=rt(Ns),{active:d,dispatch:c,over:u,measureDroppableContainers:f}=l.useContext(Ct),g=l.useRef({disabled:n}),h=l.useRef(!1),b=l.useRef(null),x=l.useRef(null),{disabled:E,updateMeasurementsFor:S,timeout:v}={...Ds,...s},I=Ze(S??r),k=l.useCallback(()=>{if(!h.current){h.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(I.current)?I.current:[I.current]),x.current=null},v)},[v]),D=jt({callback:k,disabled:E||!d}),A=l.useCallback((T,Y)=>{D&&(Y&&(D.unobserve(Y),h.current=!1),T&&D.observe(T))},[D]),[z,L]=xt(A),N=Ze(t);return l.useEffect(()=>{!D||!z.current||(D.disconnect(),h.current=!1,D.observe(z.current))},[z,D]),l.useEffect(()=>(c({type:H.RegisterDroppable,element:{id:r,key:o,disabled:n,node:z,rect:b,data:N}}),()=>c({type:H.UnregisterDroppable,key:o,id:r})),[r]),l.useEffect(()=>{n!==g.current.disabled&&(c({type:H.SetDroppableDisabled,id:r,key:o,disabled:n}),g.current.disabled=n)},[r,o,n,c]),{active:d,rect:b,isOver:(u==null?void 0:u.id)===r,node:z,over:u,setNodeRef:L}}function Je(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Is(e,t){return e.reduce((n,r,s)=>{const o=t.get(r);return o&&(n[s]=o),n},Array(e.length))}function gt(e){return e!==null&&e>=0}function Ms(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ks(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Bn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const o=Je(t,r,n),d=t[s],c=o[s];return!c||!d?null:{x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height}},ht={scaleX:1,scaleY:1},Ot=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:o,overIndex:d}=e;const c=(t=o[n])!=null?t:r;if(!c)return null;if(s===n){const f=o[d];return f?{x:0,y:n<d?f.top+f.height-(c.top+c.height):f.top-c.top,...ht}:null}const u=As(o,s,n);return s>n&&s<=d?{x:0,y:-c.height-u,...ht}:s<n&&s>=d?{x:0,y:c.height+u,...ht}:{x:0,y:0,...ht}};function As(e,t,n){const r=e[t],s=e[t-1],o=e[t+1];return r?n<t?s?r.top-(s.top+s.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const $n="Sortable",Yn=te.createContext({activeIndex:-1,containerId:$n,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Bn,disabled:{draggable:!1,droppable:!1}});function zt(e){let{children:t,id:n,items:r,strategy:s=Bn,disabled:o=!1}=e;const{active:d,dragOverlay:c,droppableRects:u,over:f,measureDroppableContainers:g}=Rs(),h=rt($n,n),b=c.rect!==null,x=l.useMemo(()=>r.map(L=>typeof L=="object"&&"id"in L?L.id:L),[r]),E=d!=null,S=d?x.indexOf(d.id):-1,v=f?x.indexOf(f.id):-1,I=l.useRef(x),k=!Ms(x,I.current),D=v!==-1&&S===-1||k,A=ks(o);xe(()=>{k&&E&&g(x)},[k,x,E,g]),l.useEffect(()=>{I.current=x},[x]);const z=l.useMemo(()=>({activeIndex:S,containerId:h,disabled:A,disableTransforms:D,items:x,overIndex:v,useDragOverlay:b,sortedRects:Is(x,u),strategy:s}),[S,h,A.draggable,A.droppable,D,x,v,u,b,s]);return te.createElement(Yn.Provider,{value:z},t)}const Ls=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Je(n,r,s).indexOf(t)},Os=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:o,newIndex:d,previousItems:c,previousContainerId:u,transition:f}=e;return!f||!r||c!==o&&s===d?!1:n?!0:d!==s&&t===u},zs={duration:200,easing:"ease"},Un="transform",Ps=Oe.Transition.toString({property:Un,duration:0,easing:"linear"}),_s={roleDescription:"sortable"};function Fs(e){let{disabled:t,index:n,node:r,rect:s}=e;const[o,d]=l.useState(null),c=l.useRef(n);return xe(()=>{if(!t&&n!==c.current&&r.current){const u=s.current;if(u){const f=Ye(r.current,{ignoreTransform:!0}),g={x:u.left-f.left,y:u.top-f.top,scaleX:u.width/f.width,scaleY:u.height/f.height};(g.x||g.y)&&d(g)}}n!==c.current&&(c.current=n)},[t,n,r,s]),l.useEffect(()=>{o&&d(null)},[o]),o}function Qt(e){let{animateLayoutChanges:t=Os,attributes:n,disabled:r,data:s,getNewIndex:o=Ls,id:d,strategy:c,resizeObserverConfig:u,transition:f=zs}=e;const{items:g,containerId:h,activeIndex:b,disabled:x,disableTransforms:E,sortedRects:S,overIndex:v,useDragOverlay:I,strategy:k}=l.useContext(Yn),D=Bs(r,x),A=g.indexOf(d),z=l.useMemo(()=>({sortable:{containerId:h,index:A,items:g},...s}),[h,s,A,g]),L=l.useMemo(()=>g.slice(g.indexOf(d)),[g,d]),{rect:N,node:T,isOver:Y,setNodeRef:X}=Es({id:d,data:z,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:L,...u}}),{active:$,activatorEvent:Z,activeNodeRect:J,attributes:Q,setNodeRef:ve,listeners:be,isDragging:V,over:ye,setActivatorNodeRef:se,transform:he}=Ts({id:d,data:z,attributes:{..._s,...n},disabled:D.draggable}),ke=ir(X,ve),K=!!$,le=K&&!E&&gt(b)&&gt(v),de=!I&&V,Ae=de&&le?he:null,Ue=le?Ae??(c??k)({rects:S,activeNodeRect:J,activeIndex:b,overIndex:v,index:A}):null,we=gt(b)&&gt(v)?o({id:d,items:g,activeIndex:b,overIndex:v}):A,pe=$==null?void 0:$.id,F=l.useRef({activeId:pe,items:g,newIndex:we,containerId:h}),Le=g!==F.current.items,ie=t({active:$,containerId:h,isDragging:V,isSorting:K,id:d,index:A,items:g,newIndex:F.current.newIndex,previousItems:F.current.items,previousContainerId:F.current.containerId,transition:f,wasDragging:F.current.activeId!=null}),Te=Fs({disabled:!ie,index:A,node:T,rect:N});return l.useEffect(()=>{K&&F.current.newIndex!==we&&(F.current.newIndex=we),h!==F.current.containerId&&(F.current.containerId=h),g!==F.current.items&&(F.current.items=g)},[K,we,h,g]),l.useEffect(()=>{if(pe===F.current.activeId)return;if(pe!=null&&F.current.activeId==null){F.current.activeId=pe;return}const Re=setTimeout(()=>{F.current.activeId=pe},50);return()=>clearTimeout(Re)},[pe]),{active:$,activeIndex:b,attributes:Q,data:z,rect:N,index:A,newIndex:we,items:g,isOver:Y,isSorting:K,isDragging:V,listeners:be,node:T,overIndex:v,over:ye,setNodeRef:ke,setActivatorNodeRef:se,setDroppableNodeRef:X,setDraggableNodeRef:ve,transform:Te??Ue,transition:ue()};function ue(){if(Te||Le&&F.current.newIndex===A)return Ps;if(!(de&&!Ht(Z)||!f)&&(K||ie))return Oe.Transition.toString({...f,property:Un})}}function Bs(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function yt(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const $s=[P.Down,P.Right,P.Up,P.Left],Ys=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:o,over:d,scrollableAncestors:c}}=t;if($s.includes(e.code)){if(e.preventDefault(),!n||!r)return;const u=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const b=s.get(h.id);if(b)switch(e.code){case P.Down:r.top<b.top&&u.push(h);break;case P.Up:r.top>b.top&&u.push(h);break;case P.Left:r.left>b.left&&u.push(h);break;case P.Right:r.left<b.left&&u.push(h);break}});const f=jr({collisionRect:r,droppableRects:s,droppableContainers:u});let g=Nn(f,"id");if(g===(d==null?void 0:d.id)&&f.length>1&&(g=f[1].id),g!=null){const h=o.get(n.id),b=o.get(g),x=b?s.get(b.id):null,E=b==null?void 0:b.node.current;if(E&&x&&h&&b){const v=St(E).some((L,N)=>c[N]!==L),I=Xn(h,b),k=Us(h,b),D=v||!I?{x:0,y:0}:{x:k?r.width-x.width:0,y:k?r.height-x.height:0},A={x:x.left,y:x.top};return D.x&&D.y?A:Qe(A,D)}}}};function Xn(e,t){return!yt(e)||!yt(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Us(e,t){return!yt(e)||!yt(t)||!Xn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Xs="https://translate.googleapis.com/translate_a/single",Wn={раздел:"бахш",тема:"мавзӯъ",урок:"дарс",тест:"тест",вопрос:"савол",ответ:"ҷавоб",правильный:"дуруст",неправильный:"нодуруст",введение:"муқаддима",заключение:"хулоса",пример:"мисол",задача:"масъала",решение:"ҳал",формула:"формула",определение:"таъриф",теорема:"теорема",доказательство:"исбот",свойство:"хосият",правило:"қоида",упражнение:"машқ","домашнее задание":"вазифаи хонагӣ","контрольная работа":"кори назоратӣ",глава:"боб",параграф:"параграф",страница:"саҳифа",рисунок:"расм",таблица:"ҷадвал",график:"график",диаграмма:"диаграмма",число:"адад",цифра:"рақам",сумма:"ҷамъ",разность:"тафовут",произведение:"ҳосил",частное:"ҳосили тақсим",дробь:"касрс",процент:"фоиз",уравнение:"муодила",неравенство:"нобаробарӣ",функция:"функсия",переменная:"тағйирёбанда",константа:"доимӣ",точка:"нуқта",линия:"хат",прямая:"хатти рост",отрезок:"порча",луч:"нимхат",угол:"кунҷ",треугольник:"секунҷа",квадрат:"мураббаъ",прямоугольник:"росткунҷа",круг:"даврагӣ",окружность:"давра",площадь:"масоҳат",периметр:"периметр",объем:"ҳаҷм",длина:"дарозӣ",ширина:"паҳнӣ",высота:"баландӣ",математика:"математика",алгебра:"алгебра",геометрия:"геометрия",физика:"физика",химия:"химия",биология:"биология",история:"таърих",география:"география",литература:"адабиёт","русский язык":"забони русӣ","таджикский язык":"забони тоҷикӣ","английский язык":"забони англисӣ",информатика:"информатика"},Ws=Object.entries(Wn).reduce((e,[t,n])=>(e[n]=t,e),{}),Vs=(e,t="ru",n="tj")=>{if(!e)return"";let r=e.toLowerCase();const d=Object.entries(t==="ru"&&n==="tj"||t==="ru"&&n==="tg"?Wn:Ws).sort((c,u)=>u[0].length-c[0].length);for(const[c,u]of d){const f=new RegExp(c,"gi");r=r.replace(f,u)}return r.charAt(0).toUpperCase()+r.slice(1)},Gs=async(e,t="ru",n="tg")=>{try{const r=`${Xs}?client=gtx&sl=${t}&tl=${n}&dt=t&q=${encodeURIComponent(e)}`,o=await(await fetch(r)).json();if(o&&o[0])return o[0].map(d=>d[0]).join("");throw new Error("Invalid response")}catch(r){return console.warn("Google Translate API failed, using dictionary:",r),null}},Ie=async(e,t="ru",n="tj")=>{if(!e||!e.trim())return"";const o=await Gs(e,t==="tj"?"tg":t,n==="tj"?"tg":n);return o||Vs(e,t,n)},Hs=te.lazy(()=>qn(()=>import("./LessonContentEditor-maHd02Mn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Vn=[{id:"video",icon:tr,label:"creator.video"},{id:"text",icon:yn,label:"creator.text"},{id:"test",icon:nr,label:"creator.test"},{id:"presentation",icon:rr,label:"creator.presentation"}],bn="donishmand_creator_syllabus",Ks=({section:e,sectionIndex:t,children:n,onDelete:r})=>{const{attributes:s,listeners:o,setNodeRef:d,transform:c,transition:u,isDragging:f}=Qt({id:e.id}),g={transform:Oe.Transform.toString(c),transition:u,opacity:f?.5:1};return a.jsx("div",{ref:d,style:g,className:"bg-gaming-bg/30 rounded-2xl border border-white/5 overflow-hidden",children:a.jsxs("div",{className:"flex items-center p-4",children:[a.jsx("div",{...s,...o,className:"cursor-grab mr-3 text-gaming-textMuted hover:text-white",children:a.jsx(Xt,{size:18})}),n]})})},qs=({topic:e,topicIndex:t,sectionIndex:n,children:r})=>{const{attributes:s,listeners:o,setNodeRef:d,transform:c,transition:u,isDragging:f}=Qt({id:e.id}),g={transform:Oe.Transform.toString(c),transition:u,opacity:f?.5:1};return a.jsx("div",{ref:d,style:g,className:"bg-gaming-card/40 rounded-xl border border-white/5 overflow-hidden",children:a.jsxs("div",{className:"flex items-center p-3",children:[a.jsx("div",{...s,...o,className:"cursor-grab mr-2 text-gaming-textMuted hover:text-white",children:a.jsx(Xt,{size:16})}),r]})})},Js=({lesson:e,lessonIndex:t,sectionIndex:n,topicIndex:r,onDelete:s,onEdit:o,getLessonIcon:d})=>{var k,D,A,z,L,N;const{t:c,i18n:u}=Ut(),f=u.resolvedLanguage||"ru",{attributes:g,listeners:h,setNodeRef:b,transform:x,transition:E,isDragging:S}=Qt({id:e.id}),v=[];e.content&&(((k=e.content.video)!=null&&k.url||(D=e.content.video)!=null&&D.urlTj)&&v.push("video"),((((A=e.content.slidesRu)==null?void 0:A.length)||0)>0||(((z=e.content.slidesTj)==null?void 0:z.length)||0)>0)&&v.push("presentation"),(((N=(L=e.content.test)==null?void 0:L.questions)==null?void 0:N.length)||0)>0&&v.push("test"),(e.content.textRu||e.content.textTj)&&v.push("text")),v.length===0&&v.push(e.type||"text");const I={transform:Oe.Transform.toString(x),transition:E,opacity:S?.5:1};return a.jsxs("div",{ref:b,style:I,className:"flex items-center justify-between gap-3 p-2 bg-gaming-bg/30 rounded-lg border border-white/5",children:[a.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2 cursor-pointer group hover:bg-white/5 p-1 rounded-md transition-colors",onClick:()=>o(e),title:c("creator.clickToEdit"),children:[a.jsx("div",{...g,...h,className:"cursor-grab text-gaming-textMuted hover:text-white shrink-0",onClick:T=>T.stopPropagation(),children:a.jsx(Xt,{size:14})}),a.jsx("div",{className:"flex gap-1 shrink-0",children:v.map(T=>{var X;const Y=d(T);return a.jsx(Y,{size:14,className:"text-gaming-pink/70",title:c((X=Vn.find($=>$.id===T))==null?void 0:X.label)},T)})}),a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsxs("span",{className:"text-sm truncate block group-hover:text-gaming-primary transition-colors",children:[n+1,".",r+1,".",t+1,". ",f==="tj"&&e.titleTj||e.title]}),a.jsx("button",{onClick:T=>{T.preventDefault(),T.stopPropagation(),o(e,"rename")},className:"p-1 text-gaming-textMuted hover:text-gaming-accent transition-colors shrink-0 sm:opacity-0 group-hover:opacity-100",title:c("creator.editTitle"),children:a.jsx(pt,{size:12})})]})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{onClick:T=>{T.preventDefault(),T.stopPropagation(),o(e,"move")},className:"p-1 text-gaming-textMuted hover:text-gaming-accent transition-colors",title:c("creator.move"),children:a.jsx(wn,{size:14})}),a.jsx("button",{onClick:T=>{T.stopPropagation(),s(e.id)},className:"p-1 text-gaming-textMuted hover:text-red-400 transition-colors",title:c("creator.delete"),children:a.jsx(Pt,{size:14})})]})]})},Zs=({item:e,itemType:t,syllabus:n,onMove:r,onClose:s})=>{const{t:o,i18n:d}=Ut(),c=d.resolvedLanguage||"ru",[u,f]=l.useState(e.fromSectionId||""),[g,h]=l.useState(e.fromTopicId||""),b=n.sections||[],x=b.find(v=>v.id===u),E=(x==null?void 0:x.topics)||[],S=()=>{t==="topic"?u&&u!==e.fromSectionId&&r(u):t==="lesson"&&u&&g&&(u!==e.fromSectionId||g!==e.fromTopicId)&&r(u,g)};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:a.jsxs("div",{className:"w-full max-w-md bg-gaming-card/95 backdrop-blur-xl rounded-2xl border border-white/10 p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:o("creator.moveTo")}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:o("creator.section")}),a.jsxs("select",{value:u,onChange:v=>{f(v.target.value),h("")},className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white appearance-none",children:[a.jsx("option",{value:"",children:o("creator.selectSection")}),b.map(v=>a.jsx("option",{value:v.id,children:c==="tj"&&v.titleTj||v.title},v.id))]})]}),t==="lesson"&&a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:o("creator.topic")}),a.jsxs("select",{value:g,onChange:v=>h(v.target.value),disabled:!u,className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white appearance-none disabled:opacity-50",children:[a.jsx("option",{value:"",children:o("creator.selectTopic")}),E.map(v=>a.jsx("option",{value:v.id,children:c==="tj"&&v.titleTj||v.title},v.id))]})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsx("button",{onClick:S,className:"flex-1 px-4 py-2 bg-gaming-primary text-white rounded-xl hover:bg-gaming-primary/80",disabled:t==="topic"?!u:!u||!g,children:o("creator.move")}),a.jsx("button",{onClick:s,className:"px-4 py-2 text-gaming-textMuted hover:text-white",children:o("creator.cancel")})]})]})})},Qs=()=>{const{t:e,i18n:t}=Ut(),n=t.resolvedLanguage||"ru",r=Gn(),[s,o]=l.useState(()=>{const i=localStorage.getItem("creator_selected_subject");return i&&dt.includes(i)?i:dt[0]});l.useEffect(()=>{localStorage.setItem("creator_selected_subject",s)},[s]);const[d,c]=l.useState(()=>{const i=localStorage.getItem(bn);if(i)try{return JSON.parse(i)}catch{}const p={};return dt.forEach(w=>{p[w]={sections:[]}}),p}),[u,f]=l.useState("saved"),g=Zn(d,2e3);l.useEffect(()=>{if(!g)return;(async()=>{f("saving");try{g[s]&&(await ut.saveStructure(s,g[s]),nn(s)),f("saved")}catch(p){console.error("Ошибка авто-сохранения:",p),f("error")}})()},[g,s]);const[h,b]=l.useState("text"),[x,E]=l.useState(null),[S,v]=l.useState(()=>{try{const i=localStorage.getItem("creator_expanded_sections");return i?JSON.parse(i):{}}catch{return{}}}),[I,k]=l.useState(()=>{try{const i=localStorage.getItem("creator_expanded_topics");return i?JSON.parse(i):{}}catch{return{}}});l.useEffect(()=>{localStorage.setItem("creator_expanded_sections",JSON.stringify(S))},[S]),l.useEffect(()=>{localStorage.setItem("creator_expanded_topics",JSON.stringify(I))},[I]),l.useEffect(()=>{const i=()=>{sessionStorage.setItem("creator_scroll_position",window.scrollY)};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]),l.useEffect(()=>{const i=sessionStorage.getItem("creator_scroll_position");i&&setTimeout(()=>{window.scrollTo(0,parseInt(i))},100)},[d]);const[D,A]=l.useState(!1),[z,L]=l.useState(null),[N,T]=l.useState(null),[Y,X]=l.useState(""),[$,Z]=l.useState(""),[J,Q]=l.useState(""),[ve,be]=l.useState(""),[V,ye]=l.useState(""),[se,he]=l.useState(""),[ke,K]=l.useState(null),[le,de]=l.useState(null),Ae=yr(on(Zt,{activationConstraint:{distance:8}}),on(qt,{coordinateGetter:Ys})),[oe,Ue]=l.useState(null),[we,pe]=l.useState(null);l.useEffect(()=>{localStorage.setItem(bn,JSON.stringify(d))},[d]);const F=d[s]||{sections:[]},Le=i=>v(p=>({...p,[i]:!p[i]})),ie=i=>k(p=>({...p,[i]:!p[i]})),Te=i=>{const{active:p,over:w}=i;if(!w||p.id===w.id)return;const y=p.id,m=w.id,j=y.startsWith("sec_"),R=y.startsWith("top_"),M=y.startsWith("les_");if(j){c(C=>{const _=C[s].sections,U=_.findIndex(B=>B.id===y),O=_.findIndex(B=>B.id===m);return{...C,[s]:{...C[s],sections:Je(_,U,O)}}});return}if(R){c(C=>{const U=C[s].sections.map(O=>{const B=O.topics.map(G=>G.id);if(B.includes(y)&&B.includes(m)){const G=O.topics.findIndex(ne=>ne.id===y),W=O.topics.findIndex(ne=>ne.id===m);return{...O,topics:Je(O.topics,G,W)}}return O});return{...C,[s]:{...C[s],sections:U}}});return}M&&c(C=>{const U=C[s].sections.map(O=>({...O,topics:O.topics.map(B=>{const G=B.lessons.map(W=>W.id);if(G.includes(y)&&G.includes(m)){const W=B.lessons.findIndex(Ce=>Ce.id===y),ne=B.lessons.findIndex(Ce=>Ce.id===m);return{...B,lessons:Je(B.lessons,W,ne)}}return B})}));return{...C,[s]:{...C[s],sections:U}}})},ue=()=>{if(!Y.trim())return;const i={id:`sec_${Date.now()}`,title:Y.trim(),titleTj:$.trim()||autoTranslate(Y.trim(),"ru","tj"),topics:[]};c(p=>{var w;return{...p,[s]:{...p[s],sections:[...((w=p[s])==null?void 0:w.sections)||[],i]}}}),X(""),Z(""),A(!1)},Re=i=>{if(!J.trim())return;const p={id:`top_${Date.now()}`,title:J.trim(),titleTj:ve.trim()||autoTranslate(J.trim(),"ru","tj"),lessons:[]};c(w=>({...w,[s]:{...w[s],sections:w[s].sections.map(y=>y.id===i?{...y,topics:[...y.topics,p]}:y)}})),Q(""),be(""),L(null)},Ne=(i,p)=>{if(!V.trim())return;const w={id:`les_${Date.now()}`,title:V.trim(),titleTj:se.trim()||autoTranslate(V.trim(),"ru","tj"),type:"text",content:{}};c(y=>({...y,[s]:{...y[s],sections:y[s].sections.map(m=>m.id===i?{...m,topics:m.topics.map(j=>j.id===p?{...j,lessons:[...j.lessons,w]}:j)}:m)}})),ye(""),he(""),b("video"),T(null)},Xe=i=>{c(p=>({...p,[s]:{...p[s],sections:p[s].sections.filter(w=>w.id!==i)}}))},st=(i,p)=>{c(w=>({...w,[s]:{...w[s],sections:w[s].sections.map(y=>y.id===i?{...y,topics:y.topics.filter(m=>m.id!==p)}:y)}}))},We=(i,p,w)=>{c(y=>({...y,[s]:{...y[s],sections:y[s].sections.map(m=>m.id===i?{...m,topics:m.topics.map(j=>j.id===p?{...j,lessons:j.lessons.filter(R=>R.id!==w)}:j)}:m)}}))},me=(i,p,w)=>{c(y=>{const m={...y},j={...m[s]};let R=[...j.sections],M=null;return R=R.map((C,_)=>{if(C.id===p){const U=C.topics.findIndex(O=>O.id===i);if(U!==-1)return M=C.topics[U],{...C,topics:C.topics.filter(O=>O.id!==i)}}return C}),M?(R=R.map(C=>C.id===w?{...C,topics:[...C.topics,M]}:C),j.sections=R,m[s]=j,m):y}),E(null)},Pe=(i,p,w,y,m)=>{c(j=>{const R={...j},M=R[s];if(!M)return j;const C=M.sections.find(W=>W.id===p),_=M.sections.find(W=>W.id===y);if(!C||!_)return j;const U=C.topics.find(W=>W.id===w),O=_.topics.find(W=>W.id===m);if(!U||!O)return j;const B=U.lessons.findIndex(W=>W.id===i);if(B===-1)return j;const[G]=U.lessons.splice(B,1);return O.lessons.push(G),R}),E(null)},[fe,ae]=l.useState(null),ot=i=>{c(p=>{const w={...p},y=w[s];if(!y)return p;if(i.type==="section"){const m=y.sections.find(j=>j.id===i.id);m&&(m.title=i.titleRu,m.titleTj=i.titleTj)}else if(i.type==="topic"){const m=y.sections.find(R=>R.id===i.sectionId),j=m==null?void 0:m.topics.find(R=>R.id===i.id);j&&(j.title=i.titleRu,j.titleTj=i.titleTj)}else if(i.type==="lesson"){const m=y.sections.find(M=>M.id===i.sectionId),j=m==null?void 0:m.topics.find(M=>M.id===i.topicId),R=j==null?void 0:j.lessons.find(M=>M.id===i.id);R&&(R.title=i.titleRu,R.titleTj=i.titleTj)}return w}),ae(null)};l.useEffect(()=>{(async()=>{try{f("saving");const p=await ut.getStructure(s);p&&c(w=>({...w,[s]:p})),f("saved")}catch(p){console.error("Ошибка загрузки данных:",p)}})()},[s]);const[en,it]=l.useState(!1),De=async(i,p,w)=>{it(!0);try{let y=i;if(!i.content){const m=await ut.getLesson(i.id);m&&m.content&&(y={...i,content:m.content},c(j=>({...j,[s]:{...j[s],sections:j[s].sections.map(R=>R.id===p?{...R,topics:R.topics.map(M=>M.id===w?{...M,lessons:M.lessons.map(C=>C.id===i.id?y:C)}:M)}:R)}})))}K(y),de({sectionId:p,topicId:w})}catch(y){console.error("Ошибка подготовки урока:",y),alert("Не удалось загрузить урок")}finally{it(!1)}},[Se,Ee]=l.useState(!1),at=async i=>{var p,w,y,m,j,R;Ee(!0);try{const{sectionId:M,topicId:C}=le;let _="text";(((w=(p=i.content.test)==null?void 0:p.questions)==null?void 0:w.length)||0)>0?_="test":(y=i.content.video)!=null&&y.url||(m=i.content.video)!=null&&m.urlTj?_="video":((((j=i.content.slidesRu)==null?void 0:j.length)||0)>0||(((R=i.content.slidesTj)==null?void 0:R.length)||0)>0)&&(_="presentation");const U={...i,type:_};await ut.saveLesson(U,s),nn(s),c(O=>({...O,[s]:{...O[s],sections:O[s].sections.map(B=>B.id===M?{...B,topics:B.topics.map(G=>G.id===C?{...G,lessons:G.lessons.map(W=>W.id===i.id?U:W)}:G)}:B)}})),K(null),de(null)}catch(M){console.error("Ошибка сохранения урока:",M),alert(e("creator.errorSaveLesson"))}finally{Ee(!1)}},[je,ee]=l.useState({section:!1,topic:!1,lesson:!1}),Tt=async()=>{ee(i=>({...i,section:!0}));try{const i=await Ie(Y,"ru","tj");Z(i)}finally{ee(i=>({...i,section:!1}))}},Rt=async()=>{ee(i=>({...i,topic:!0}));try{const i=await Ie(J,"ru","tj");be(i)}finally{ee(i=>({...i,topic:!1}))}},Ve=async()=>{ee(i=>({...i,lesson:!0}));try{const i=await Ie(V,"ru","tj");he(i)}finally{ee(i=>({...i,lesson:!1}))}},ct=async()=>{ee(i=>({...i,section:!0}));try{const i=await Ie($,"tj","ru");X(i)}finally{ee(i=>({...i,section:!1}))}},Nt=async()=>{ee(i=>({...i,topic:!0}));try{const i=await Ie(ve,"tj","ru");Q(i)}finally{ee(i=>({...i,topic:!1}))}},lt=async()=>{ee(i=>({...i,lesson:!0}));try{const i=await Ie(se,"tj","ru");ye(i)}finally{ee(i=>({...i,lesson:!1}))}},_e=(i,p,w,y,m,j,R=e("creator.nameRu"),M=e("creator.nameTj"))=>a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{type:"text",value:i,onChange:C=>p(C.target.value),placeholder:R,className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-primary/50 transition-colors"}),a.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30 font-medium",children:"RU"})]}),a.jsx("button",{type:"button",onClick:j,className:"flex items-center gap-1 px-3 py-3 bg-gaming-primary/20 text-gaming-primary rounded-xl hover:bg-gaming-primary/30 transition-colors text-sm",title:e("creator.translateTjToRu"),children:a.jsx(Sparkles,{size:16,className:"rotate-180"})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("input",{type:"text",value:w,onChange:C=>y(C.target.value),placeholder:M,className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-accent/50 transition-colors"}),a.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30 font-medium",children:"TJ"})]}),a.jsx("button",{type:"button",onClick:m,className:"flex items-center gap-1 px-3 py-3 bg-gaming-accent/20 text-gaming-accent rounded-xl hover:bg-gaming-accent/30 transition-colors text-sm",title:e("creator.translateRuToTj"),children:a.jsx(Sparkles,{size:16})})]})]}),Dt=i=>{const p=Vn.find(w=>w.id===i);return p?p.icon:yn};return a.jsxs("div",{className:"min-h-screen bg-gaming-bg font-sans text-white p-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 sm:mb-8",children:[a.jsxs("button",{onClick:()=>r("/"),className:"flex items-center gap-2 text-gaming-textMuted hover:text-white transition-colors self-start",children:[a.jsx(Qn,{size:20}),e("creator.back")]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-gaming-card/50 border border-white/5 text-sm font-medium",children:[u==="saved"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-gaming-accent",children:"☁️"}),a.jsx("span",{className:"text-gaming-textMuted",children:e("creator.allSaved")})]}),u==="saving"&&a.jsxs(a.Fragment,{children:[a.jsx(Hn,{size:16,className:"text-gaming-primary animate-spin"}),a.jsx("span",{className:"text-white",children:e("creator.saving")})]}),u==="error"&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-red-500",children:"❌"}),a.jsx("span",{className:"text-red-400",children:e("creator.saveError")})]})]})]}),a.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold mb-2 flex items-center gap-3",children:[a.jsx(er,{className:"text-gaming-primary",size:32}),e("creator.panelTitle")]}),a.jsx("p",{className:"text-gaming-textMuted text-base sm:text-lg mb-6 sm:mb-8",children:e("creator.panelSubtitle")}),a.jsxs("div",{className:"mb-6 sm:mb-8",children:[a.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:e("creator.selectSubject")}),a.jsxs("div",{className:"relative",children:[a.jsx("select",{value:s,onChange:i=>o(i.target.value),className:"w-full sm:max-w-md bg-gaming-card/60 backdrop-blur-xl border border-white/10 rounded-xl px-4 py-3 text-white appearance-none cursor-pointer focus:outline-none focus:border-gaming-primary/50 transition-colors",children:dt.map(i=>{var p;return a.jsx("option",{value:i,className:"bg-gaming-card text-white",children:((p=Kn[i])==null?void 0:p[n])||i},i)})}),a.jsx(It,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gaming-textMuted pointer-events-none",size:20})]})]}),a.jsxs("div",{className:"bg-gaming-card/40 backdrop-blur-xl border border-white/5 rounded-3xl p-4 sm:p-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[a.jsx(or,{className:"text-gaming-primary",size:24}),e("creator.sections")]}),a.jsxs("button",{onClick:()=>A(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-gaming-primary/20 text-gaming-primary rounded-xl hover:bg-gaming-primary/30 transition-colors active:scale-95 w-full sm:w-auto",children:[a.jsx(sr,{size:18}),e("creator.addSection")]})]}),D&&a.jsxs("div",{className:"mb-6 p-4 bg-gaming-bg/50 rounded-2xl border border-gaming-primary/30",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-gaming-primary",children:e("creator.newSection")}),_e(Y,X,$,Z,Tt,ct),a.jsxs("div",{className:"flex gap-3 mt-4",children:[a.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 bg-gaming-primary text-white rounded-xl hover:bg-gaming-primary/80 transition-colors active:scale-95",children:[a.jsx(ft,{size:16}),e("creator.save")]}),a.jsx("button",{onClick:()=>{A(!1),X(""),Z("")},className:"px-4 py-2 text-gaming-textMuted hover:text-white transition-colors",children:e("creator.cancel")})]})]}),F.sections.length===0?a.jsxs("div",{className:"text-center py-12 text-gaming-textMuted",children:[a.jsx(Jn,{size:48,className:"mx-auto mb-4 opacity-30"}),a.jsx("p",{children:e("creator.noSections")})]}):a.jsx(Ss,{sensors:Ae,collisionDetection:Sr,onDragEnd:Te,children:a.jsx(zt,{items:F.sections.map(i=>i.id),strategy:Ot,children:a.jsx("div",{className:"space-y-4",children:F.sections.map((i,p)=>{var w,y;return a.jsx(Ks,{section:i,sectionIndex:p,lang:n,onDelete:Xe,children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between group/row",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-3 cursor-pointer",onClick:()=>Le(i.id),children:[S[i.id]?a.jsx(It,{size:20,className:"text-gaming-primary"}):a.jsx(tn,{size:20,className:"text-gaming-textMuted"}),a.jsxs("span",{className:"text-lg font-semibold",children:[p+1,". ",n==="tj"&&i.titleTj||i.title]}),a.jsx("button",{onClick:m=>{m.stopPropagation(),ae({type:"section",id:i.id,titleRu:i.title,titleTj:i.titleTj||""})},className:"p-1 text-gaming-textMuted hover:text-gaming-accent transition-colors sm:opacity-0 group-hover/row:opacity-100",title:e("creator.editTitle"),children:a.jsx(pt,{size:16})}),a.jsxs("span",{className:"text-sm text-gaming-textMuted",children:["(",((w=i.topics)==null?void 0:w.length)||0," ",e("creator.themes"),")"]})]}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsx("button",{onClick:m=>{m.stopPropagation(),Xe(i.id)},className:"p-2 text-gaming-textMuted hover:text-red-400 transition-colors",children:a.jsx(Pt,{size:18})})})]}),S[i.id]&&a.jsxs("div",{className:"mt-4 ml-8",children:[a.jsxs("button",{onClick:()=>L(i.id),className:"flex items-center gap-2 px-3 py-2 mb-4 text-sm text-gaming-accent hover:bg-gaming-accent/10 rounded-lg transition-colors",children:[a.jsx(rn,{size:16}),e("creator.addTopic")]}),z===i.id&&a.jsxs("div",{className:"mb-4 p-4 bg-gaming-card/50 rounded-xl border border-gaming-accent/30",children:[a.jsx("h4",{className:"text-md font-semibold mb-3 text-gaming-accent",children:e("creator.newTopic")}),_e(J,Q,ve,be,Rt,Nt),a.jsxs("div",{className:"flex gap-3 mt-4",children:[a.jsxs("button",{onClick:()=>Re(i.id),className:"flex items-center gap-2 px-3 py-2 bg-gaming-accent text-white rounded-lg hover:bg-gaming-accent/80 transition-colors active:scale-95 text-sm",children:[a.jsx(ft,{size:14}),e("creator.save")]}),a.jsx("button",{onClick:()=>{L(null),Q(""),be("")},className:"px-3 py-2 text-gaming-textMuted hover:text-white transition-colors text-sm",children:e("creator.cancel")})]})]}),((y=i.topics)==null?void 0:y.length)===0?a.jsx("p",{className:"text-sm text-gaming-textMuted",children:e("creator.noTopics")}):a.jsx(zt,{items:i.topics.map(m=>m.id),strategy:Ot,children:a.jsx("div",{className:"space-y-3",children:i.topics.map((m,j)=>{var R,M;return a.jsx(qs,{topic:m,topicIndex:j,sectionIndex:p,children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between group/row",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-2 cursor-pointer",onClick:()=>ie(m.id),children:[I[m.id]?a.jsx(It,{size:16,className:"text-gaming-accent"}):a.jsx(tn,{size:16,className:"text-gaming-textMuted"}),a.jsxs("span",{className:"font-medium",children:[p+1,".",j+1,". ",n==="tj"&&m.titleTj||m.title]}),a.jsx("button",{onClick:C=>{C.stopPropagation(),ae({type:"topic",id:m.id,sectionId:i.id,titleRu:m.title,titleTj:m.titleTj||""})},className:"p-1 text-gaming-textMuted hover:text-gaming-accent transition-colors sm:opacity-0 group-hover/row:opacity-100",title:e("creator.editTitle"),children:a.jsx(pt,{size:14})}),a.jsxs("span",{className:"text-xs text-gaming-textMuted",children:["(",((R=m.lessons)==null?void 0:R.length)||0," ",e("creator.lessons"),")"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:C=>{C.stopPropagation(),E({type:"topic",id:m.id,fromSectionId:i.id})},className:"p-1 text-gaming-textMuted hover:text-gaming-accent transition-colors",title:e("creator.move"),children:a.jsx(wn,{size:14})}),a.jsx("button",{onClick:C=>{C.stopPropagation(),st(i.id,m.id)},className:"p-1 text-gaming-textMuted hover:text-red-400 transition-colors",children:a.jsx(Pt,{size:16})})]})]}),I[m.id]&&a.jsxs("div",{className:"mt-3 ml-6",children:[a.jsxs("button",{onClick:()=>T({sectionId:i.id,topicId:m.id}),className:"flex items-center gap-2 px-2 py-1 mb-3 text-xs text-gaming-pink hover:bg-gaming-pink/10 rounded-lg transition-colors",children:[a.jsx(rn,{size:14}),e("creator.addLesson")]}),(N==null?void 0:N.sectionId)===i.id&&(N==null?void 0:N.topicId)===m.id&&a.jsxs("div",{className:"mb-3 p-3 bg-gaming-bg/50 rounded-lg border border-gaming-pink/30",children:[a.jsx("h5",{className:"text-sm font-semibold mb-3 text-gaming-pink",children:e("creator.newLesson")}),_e(V,ye,se,he,Ve,lt),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsxs("button",{onClick:()=>Ne(i.id,m.id),className:"flex items-center gap-2 px-3 py-2 bg-gaming-pink text-white rounded-lg hover:bg-gaming-pink/80 transition-colors active:scale-95 text-xs",children:[a.jsx(ft,{size:12}),e("creator.save")]}),a.jsx("button",{onClick:()=>{T(null),ye(""),he("")},className:"px-3 py-2 text-gaming-textMuted hover:text-white transition-colors text-xs",children:e("creator.cancel")})]})]}),((M=m.lessons)==null?void 0:M.length)===0?a.jsx("p",{className:"text-xs text-gaming-textMuted",children:e("creator.noLessons")}):a.jsx(zt,{items:m.lessons.map(C=>C.id),strategy:Ot,children:a.jsx("div",{className:"space-y-2",children:m.lessons.map((C,_)=>a.jsx(Js,{lesson:C,lessonIndex:_,sectionIndex:p,topicIndex:j,lang:n,onDelete:U=>We(i.id,m.id,U),onEdit:(U,O)=>{O==="move"?E({type:"lesson",id:C.id,fromSectionId:i.id,fromTopicId:m.id}):O==="rename"?ae({type:"lesson",id:C.id,sectionId:i.id,topicId:m.id,titleRu:C.title,titleTj:C.titleTj||""}):De(U,i.id,m.id)},getLessonIcon:Dt},C.id))})})]})]})},m.id)})})})]})]})},i.id)})})})})]}),ke&&a.jsx(Hs,{lesson:ke,onSave:at,onClose:()=>{Se||(K(null),de(null))},lang:n,isSaving:Se}),x&&a.jsx(Zs,{item:x,itemType:x.type,syllabus:d[s]||{sections:[]},onMove:(i,p)=>{x.type==="topic"&&me(x.id,x.fromSectionId,i),x.type==="lesson"&&Pe(x.id,x.fromSectionId,x.fromTopicId,i,p)},onClose:()=>E(null),lang:n}),fe&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:a.jsxs("div",{className:"w-full max-w-md bg-gaming-card/95 backdrop-blur-xl rounded-2xl border border-gaming-primary/30 p-6 shadow-2xl animate-in fade-in zoom-in duration-200",children:[a.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[a.jsx(pt,{className:"text-gaming-primary",size:24}),e("creator.editTitle")]}),_e(fe.titleRu,i=>ae(p=>({...p,titleRu:i})),fe.titleTj,i=>ae(p=>({...p,titleTj:i})),async()=>{const i=await Ie(fe.titleRu,"ru","tj");ae(p=>({...p,titleTj:i}))},async()=>{const i=await Ie(fe.titleTj,"tj","ru");ae(p=>({...p,titleRu:i}))}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsxs("button",{onClick:()=>ot(fe),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gaming-primary text-white rounded-xl hover:bg-gaming-primary/80 transition-colors font-medium shadow-lg shadow-gaming-primary/20",children:[a.jsx(ft,{size:18}),e("creator.save")]}),a.jsx("button",{onClick:()=>ae(null),className:"px-4 py-3 bg-white/5 text-gaming-textMuted hover:text-white rounded-xl hover:bg-white/10 transition-colors",children:e("creator.cancel")})]})]})})]})},io=Object.freeze(Object.defineProperty({__proto__:null,default:Qs},Symbol.toStringTag,{value:"Module"}));export{Oe as C,Ss as D,Xt as G,qt as K,pt as P,zt as S,Pt as T,yr as a,on as b,Zt as c,rn as d,Sr as e,Je as f,io as g,Ys as s,Ie as t,Qt as u,Ot as v};
