import{j as e,E as z,M as Q,m as I,N as G,n as fe,R as be,I as X,i as je,e as ye,f as ve,d as Y,C as Z,u as q,a as E,s as ee,K as te,P as se,D as re,c as ne,S as ae,v as ie,b as le}from"./editor-8tw8cCTw.js";import{r as k,R as H}from"./vendor-DfgOC3sD.js";import{t as _}from"./CreatorPage-DsoXfg-O.js";import{V as oe,a7 as K,S,k as C,al as Ne,am as we,an as Te,ao as ke,ap as Me,aq as Ce,ar as Re,as as Se,at as Ae,au as ze,av as $e,aw as P,ax as Le,ay as Ie,az as _e,aA as Ee,aB as He,aC as Ue,F as ce,u as F,aD as De,aE as Fe,N as de,aF as O,I as Oe,T as ue,X as J,j as Je,v as L,J as me,C as Be,p as B,G as W,i as Qe,D as Ge}from"./ui-DOqj-4Eh.js";import{k as xe}from"./katex-G9EdgA5J.js";import{a as U}from"./index-BdCfHgNm.js";import{u as Pe}from"./useDebounce-DE7P2URC.js";import"./SyllabusContext-o0j4gfFp.js";import"./supabase-CQnWzhEg.js";const Ve=({data:t,onChange:r,lang:n})=>{const[s,i]=k.useState(!1),a=(d,b)=>{r({...t,[d]:b})},p=async()=>{i(!0);try{const d=await _(t.descriptionRu||"","ru","tj");a("descriptionTj",d)}finally{i(!1)}},x=async()=>{i(!0);try{const d=await _(t.descriptionTj||"","tj","ru");a("descriptionRu",d)}finally{i(!1)}},u=()=>{a("urlTj",t.url||"")};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gaming-primary flex items-center gap-2",children:[e.jsx(oe,{size:20}),"Ð’Ð¸Ð´ÐµÐ¾Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gaming-textMuted mb-2 flex items-center gap-2",children:[e.jsx(K,{size:14}),n==="ru"?"Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð²Ð¸Ð´ÐµÐ¾ (RU)":"ÐŸÐ°Ð¹Ð²Ð°Ð½Ð´ Ð±Ð° Ð²Ð¸Ð´ÐµÐ¾ (RU)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"url",value:t.url||"",onChange:d=>a("url",d.target.value),placeholder:"https://youtube.com/...",className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-primary/50 transition-colors"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30 font-medium",children:"RU"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"block text-sm text-gaming-textMuted mb-2 flex items-center gap-2",children:[e.jsx(K,{size:14}),n==="ru"?"Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð²Ð¸Ð´ÐµÐ¾ (TJ)":"ÐŸÐ°Ð¹Ð²Ð°Ð½Ð´ Ð±Ð° Ð²Ð¸Ð´ÐµÐ¾ (TJ)"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"url",value:t.urlTj||"",onChange:d=>a("urlTj",d.target.value),placeholder:"https://youtube.com/...",className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-accent/50 transition-colors"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-white/30 font-medium",children:"TJ"})]})]}),e.jsx("button",{type:"button",onClick:u,className:"mt-7 flex items-center gap-1 px-3 py-3 h-fit bg-gaming-accent/20 text-gaming-accent rounded-xl hover:bg-gaming-accent/30 transition-colors",title:n==="ru"?"ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÑƒ":"ÐÑƒÑÑ…Ð°Ð±Ð°Ñ€Ð´Ð¾Ñ€Ó£",children:e.jsx(S,{size:16})})]}),e.jsx("div",{className:"border-t border-white/5 pt-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:n==="ru"?"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾ (RU)":"Ð¢Ð°Ð²ÑÐ¸Ñ„Ð¸ Ð²Ð¸Ð´ÐµÐ¾ (RU)"}),e.jsx("textarea",{value:t.descriptionRu||"",onChange:d=>a("descriptionRu",d.target.value),placeholder:n==="ru"?"ÐšÑ€Ð°Ñ‚ÐºÐ¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾...":"Ð¢Ð°Ð²ÑÐ¸Ñ„Ð¸ Ð¼ÑƒÑ…Ñ‚Ð°ÑÐ°Ñ€...",rows:3,className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-primary/50 transition-colors resize-none"})]}),e.jsx("button",{type:"button",onClick:x,disabled:s,className:"mt-7 flex items-center gap-1 px-3 py-3 h-fit bg-gaming-primary/20 text-gaming-primary rounded-xl hover:bg-gaming-primary/30 transition-colors disabled:opacity-50",title:"ÐŸÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ TJ -> RU",children:s?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(S,{size:16,className:"rotate-180"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:n==="ru"?"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾ (TJ)":"Ð¢Ð°Ð²ÑÐ¸Ñ„Ð¸ Ð²Ð¸Ð´ÐµÐ¾ (TJ)"}),e.jsx("textarea",{value:t.descriptionTj||"",onChange:d=>a("descriptionTj",d.target.value),placeholder:"Ð¢Ð°Ð²ÑÐ¸Ñ„Ð¸ Ð¼ÑƒÑ…Ñ‚Ð°ÑÐ°Ñ€...",rows:3,className:"w-full bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white placeholder-white/30 focus:outline-none focus:border-gaming-accent/50 transition-colors resize-none"})]}),e.jsx("button",{type:"button",onClick:p,disabled:s,className:"mt-7 flex items-center gap-1 px-3 py-3 h-fit bg-gaming-accent/20 text-gaming-accent rounded-xl hover:bg-gaming-accent/30 transition-colors disabled:opacity-50",title:"ÐŸÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ RU -> TJ",children:s?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(S,{size:16})})]}),(t.url||t.urlTj)&&e.jsxs("div",{className:"bg-gaming-card/30 rounded-xl p-3 text-sm text-gaming-textMuted",children:[e.jsx("span",{className:"text-gaming-primary font-medium",children:"ðŸ’¡ "}),n==="ru"?"Ð’Ð¸Ð´ÐµÐ¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ‚ÑŒÑÑ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ðµ ÑƒÑ€Ð¾ÐºÐ°":"Ð’Ð¸Ð´ÐµÐ¾ Ò³Ð°Ð½Ð³Ð¾Ð¼Ð¸ Ð´Ð¸Ð´Ð°Ð½Ð¸ Ð´Ð°Ñ€Ñ Ð½Ð°Ð¼Ð¾Ð¸Ñˆ Ð´Ð¾Ð´Ð° Ð¼ÐµÑˆÐ°Ð²Ð°Ð´"]})]})};var Ke=z.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const r=t.style.textAlign;return this.options.alignments.includes(r)?r:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:r})=>this.options.alignments.includes(t)?this.options.types.map(n=>r.updateAttributes(n,{textAlign:t})).some(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(r=>t.resetAttributes(r,"textAlign")).some(r=>r),toggleTextAlign:t=>({editor:r,commands:n})=>this.options.alignments.includes(t)?r.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),We=Ke,Xe=20,ge=(t,r=0)=>{const n=[];return!t.children.length||r>Xe||Array.from(t.children).forEach(s=>{s.tagName==="SPAN"?n.push(s):s.children.length&&n.push(...ge(s,r+1))}),n},Ye=t=>{if(!t.children.length)return;const r=ge(t);r&&r.forEach(n=>{var s,i;const a=n.getAttribute("style"),p=(i=(s=n.parentElement)==null?void 0:s.closest("span"))==null?void 0:i.getAttribute("style");n.setAttribute("style",`${p};${a}`)})},pe=Q.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&Ye(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",I(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:r})=>r.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:r}=t;return t.doc.nodesBetween(r.from,r.to,(n,s)=>{if(n.isTextblock)return!0;n.marks.filter(i=>i.type===this.type).some(i=>Object.values(i.attrs).some(a=>!!a))||t.removeMark(s,s+n.nodeSize,this.type)}),!0}}}}),Ze=z.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var r;const n=t.getAttribute("style");if(n){const s=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=s.length-1;i>=0;i-=1){const a=s[i].split(":");if(a.length>=2){const p=a[0].trim().toLowerCase(),x=a.slice(1).join(":").trim();if(p==="background-color")return x.replace(/['"]+/g,"")}}}return(r=t.style.backgroundColor)==null?void 0:r.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:r})=>r().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),he=z.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var r;const n=t.getAttribute("style");if(n){const s=n.split(";").map(i=>i.trim()).filter(Boolean);for(let i=s.length-1;i>=0;i-=1){const a=s[i].split(":");if(a.length>=2){const p=a[0].trim().toLowerCase(),x=a.slice(1).join(":").trim();if(p==="color")return x.replace(/['"]+/g,"")}}}return(r=t.style.color)==null?void 0:r.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:r})=>r().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),qe=z.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:r})=>r().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),et=z.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:r})=>r().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),tt=z.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:r})=>r().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});z.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(Ze.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(he.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(qe.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(et.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(tt.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(pe.configure(this.options.textStyle)),t}});var st=he,rt=Q.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(t){return t!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:t}){return["sub",I(this.options.HTMLAttributes,t),0]},addCommands(){return{setSubscript:()=>({commands:t})=>t.setMark(this.name),toggleSubscript:()=>({commands:t})=>t.toggleMark(this.name),unsetSubscript:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),nt=rt,at=Q.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(t){return t!=="super"?!1:null}}]},renderHTML({HTMLAttributes:t}){return["sup",I(this.options.HTMLAttributes,t),0]},addCommands(){return{setSuperscript:()=>({commands:t})=>t.setMark(this.name),toggleSuperscript:()=>({commands:t})=>t.toggleMark(this.name),unsetSuperscript:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),it=at,lt=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,ot=G.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{},resize:!1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",I(this.options.HTMLAttributes,t)]},parseMarkdown:(t,r)=>r.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var r,n,s,i,a,p;const x=(n=(r=t.attrs)==null?void 0:r.src)!=null?n:"",u=(i=(s=t.attrs)==null?void 0:s.alt)!=null?i:"",d=(p=(a=t.attrs)==null?void 0:a.title)!=null?p:"";return d?`![${u}](${x} "${d}")`:`![${u}](${x})`},addNodeView(){if(!this.options.resize||!this.options.resize.enabled||typeof document>"u")return null;const{directions:t,minWidth:r,minHeight:n,alwaysPreserveAspectRatio:s}=this.options.resize;return({node:i,getPos:a,HTMLAttributes:p,editor:x})=>{const u=document.createElement("img");Object.entries(p).forEach(([g,j])=>{if(j!=null)switch(g){case"width":case"height":break;default:u.setAttribute(g,j);break}}),u.src=p.src;const d=new be({element:u,editor:x,node:i,getPos:a,onResize:(g,j)=>{u.style.width=`${g}px`,u.style.height=`${j}px`},onCommit:(g,j)=>{const v=a();v!==void 0&&this.editor.chain().setNodeSelection(v).updateAttributes(this.name,{width:g,height:j}).run()},onUpdate:(g,j,v)=>g.type===i.type,options:{directions:t,min:{width:r,height:n},preserveAspectRatio:s===!0}}),b=d.dom;return b.style.visibility="hidden",b.style.pointerEvents="none",u.onload=()=>{b.style.visibility="",b.style.pointerEvents=""},d}},addCommands(){return{setImage:t=>({commands:r})=>r.insertContent({type:this.name,attrs:t})}},addInputRules(){return[fe({find:lt,type:this.type,getAttributes:t=>{const[,,r,n,s]=t;return{src:n,alt:r,title:s}}})]}}),ct=ot,dt=G.create({name:"blockMath",group:"block",atom:!0,addOptions(){return{onClick:void 0,katexOptions:void 0}},addAttributes(){return{latex:{default:"",parseHTML:t=>t.getAttribute("data-latex"),renderHTML:t=>({"data-latex":t.latex})}}},addCommands(){return{insertBlockMath:t=>({commands:r,editor:n})=>{const{latex:s,pos:i}=t;return s?r.insertContentAt(i??n.state.selection.from,{type:this.name,attrs:{latex:s}}):!1},deleteBlockMath:t=>({editor:r,tr:n})=>{var s;const i=(s=t==null?void 0:t.pos)!=null?s:r.state.selection.$from.pos,a=r.state.doc.nodeAt(i);return!a||a.type.name!==this.name?!1:(n.delete(i,i+a.nodeSize),!0)},updateBlockMath:t=>({editor:r,tr:n})=>{const s=t==null?void 0:t.latex;let i=t==null?void 0:t.pos;i===void 0&&(i=r.state.selection.$from.pos);const a=r.state.doc.nodeAt(i);return!a||a.type.name!==this.name?!1:(n.setNodeMarkup(i,this.type,{...a.attrs,latex:s||a.attrs.latex}),!0)}}},parseHTML(){return[{tag:'div[data-type="block-math"]'}]},renderHTML({HTMLAttributes:t}){return["div",I(t,{"data-type":"block-math"})]},parseMarkdown:t=>({type:"blockMath",attrs:{latex:t.latex}}),renderMarkdown:t=>{var r;return["$$",((r=t.attrs)==null?void 0:r.latex)||"","$$"].join(`
`)},markdownTokenizer:{name:"blockMath",level:"block",start:t=>t.indexOf("$$"),tokenize:t=>{const r=t.match(/^\$\$([^$]+)\$\$/);if(!r)return;const[n,s]=r;return{type:"blockMath",raw:n,latex:s.trim()}}},addInputRules(){return[new X({find:/^\$\$\$([^$]+)\$\$\$$/,handler:({state:t,range:r,match:n})=>{const[,s]=n,{tr:i}=t,a=r.from,p=r.to;i.replaceWith(a,p,this.type.create({latex:s}))}})]},addNodeView(){const{katexOptions:t}=this.options;return({node:r,getPos:n})=>{const s=document.createElement("div"),i=document.createElement("div");s.className="tiptap-mathematics-render",this.editor.isEditable&&s.classList.add("tiptap-mathematics-render--editable"),i.className="block-math-inner",s.dataset.type="block-math",s.setAttribute("data-latex",r.attrs.latex),s.appendChild(i);function a(){try{xe.render(r.attrs.latex,i,t),s.classList.remove("block-math-error")}catch{s.textContent=r.attrs.latex,s.classList.add("block-math-error")}}const p=x=>{x.preventDefault(),x.stopPropagation();const u=n();u!=null&&this.options.onClick&&this.options.onClick(r,u)};return this.options.onClick&&s.addEventListener("click",p),a(),{dom:s,destroy(){s.removeEventListener("click",p)}}}}}),ut=G.create({name:"inlineMath",group:"inline",inline:!0,atom:!0,addOptions(){return{onClick:void 0,katexOptions:void 0}},addAttributes(){return{latex:{default:"",parseHTML:t=>t.getAttribute("data-latex"),renderHTML:t=>({"data-latex":t.latex})}}},addCommands(){return{insertInlineMath:t=>({editor:r,tr:n})=>{var s;const i=t.latex,a=(s=t==null?void 0:t.pos)!=null?s:r.state.selection.from;return i?(n.replaceWith(a,a,this.type.create({latex:i})),!0):!1},deleteInlineMath:t=>({editor:r,tr:n})=>{var s;const i=(s=t==null?void 0:t.pos)!=null?s:r.state.selection.$from.pos,a=r.state.doc.nodeAt(i);return!a||a.type.name!==this.name?!1:(n.delete(i,i+a.nodeSize),!0)},updateInlineMath:t=>({editor:r,tr:n})=>{const s=t==null?void 0:t.latex;let i=t==null?void 0:t.pos;i===void 0&&(i=r.state.selection.$from.pos);const a=r.state.doc.nodeAt(i);return!a||a.type.name!==this.name?!1:(n.setNodeMarkup(i,this.type,{...a.attrs,latex:s}),!0)}}},parseHTML(){return[{tag:'span[data-type="inline-math"]'}]},renderHTML({HTMLAttributes:t}){return["span",I(t,{"data-type":"inline-math"})]},parseMarkdown:t=>({type:"inlineMath",attrs:{latex:t.latex}}),renderMarkdown:t=>{var r;return`$${((r=t.attrs)==null?void 0:r.latex)||""}$`},markdownTokenizer:{name:"inlineMath",level:"inline",start:t=>t.indexOf("$"),tokenize:t=>{const r=t.match(/^\$([^$]+)\$(?!\$)/);if(!r)return;const[n,s]=r;return{type:"inlineMath",raw:n,latex:s.trim()}}},addInputRules(){return[new X({find:/(^|[^$])(\$\$([^$\n]+?)\$\$)(?!\$)/,handler:({state:t,range:r,match:n})=>{const s=n[3],{tr:i}=t,a=r.from,p=r.to;i.replaceWith(a,p,this.type.create({latex:s}))}})]},addNodeView(){const{katexOptions:t}=this.options;return({node:r,getPos:n})=>{const s=document.createElement("span");s.className="tiptap-mathematics-render",this.editor.isEditable&&s.classList.add("tiptap-mathematics-render--editable"),s.dataset.type="inline-math",s.setAttribute("data-latex",r.attrs.latex);function i(){try{xe.render(r.attrs.latex,s,t),s.classList.remove("inline-math-error")}catch{s.textContent=r.attrs.latex,s.classList.add("inline-math-error")}}const a=p=>{p.preventDefault(),p.stopPropagation();const x=n();x!=null&&this.options.onClick&&this.options.onClick(r,x)};return this.options.onClick&&s.addEventListener("click",a),i(),{dom:s,destroy(){s.removeEventListener("click",a)}}}}}),mt=z.create({name:"Mathematics",addOptions(){return{inlineOptions:void 0,blockOptions:void 0,katexOptions:void 0}},addExtensions(){return[dt.configure({...this.options.blockOptions,katexOptions:this.options.katexOptions}),ut.configure({...this.options.inlineOptions,katexOptions:this.options.katexOptions})]}}),xt=mt;const gt=["#FFFFFF","#6C5DD3","#00E0FF","#FF49DB","#FFD700","#8E8EA0","#FF4444","#44FF44"],pt=({editor:t,minimal:r})=>{if(!t)return null;const n=({onClick:s,isActive:i,disabled:a,children:p,title:x})=>e.jsx("button",{onClick:s,disabled:a,title:x,className:`p-1.5 rounded-lg transition-colors ${i?"bg-gaming-primary text-white":"text-gaming-textMuted hover:text-white hover:bg-gaming-card/50"} ${a?"opacity-50 cursor-not-allowed":""}`,children:p});return e.jsxs("div",{className:"flex flex-wrap gap-1 p-2 bg-gaming-card/30 border-b border-white/5",children:[e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().undo().run(),disabled:!t.can().undo(),title:"ÐžÑ‚Ð¼ÐµÐ½Ð°",children:e.jsx(Ne,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().redo().run(),disabled:!t.can().redo(),title:"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€",children:e.jsx(we,{size:16})})]}),e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().toggleBold().run(),isActive:t.isActive("bold"),title:"Ð–Ð¸Ñ€Ð½Ñ‹Ð¹",children:e.jsx(Te,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleItalic().run(),isActive:t.isActive("italic"),title:"ÐšÑƒÑ€ÑÐ¸Ð²",children:e.jsx(ke,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleUnderline().run(),isActive:t.isActive("underline"),title:"ÐŸÐ¾Ð´Ñ‡ÐµÑ€ÐºÐ½ÑƒÑ‚Ñ‹Ð¹",children:e.jsx(Me,{size:16})}),!r&&e.jsx(n,{onClick:()=>t.chain().focus().toggleStrike().run(),isActive:t.isActive("strike"),title:"Ð—Ð°Ñ‡ÐµÑ€ÐºÐ½ÑƒÑ‚Ñ‹Ð¹",children:e.jsx(Ce,{size:16})})]}),e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().toggleSubscript().run(),isActive:t.isActive("subscript"),title:"ÐÐ¸Ð¶Ð½Ð¸Ð¹ Ð¸Ð½Ð´ÐµÐºÑ (Hâ‚‚O)",children:e.jsx(Re,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleSuperscript().run(),isActive:t.isActive("superscript"),title:"Ð’ÐµÑ€Ñ…Ð½Ð¸Ð¹ Ð¸Ð½Ð´ÐµÐºÑ (xÂ²)",children:e.jsx(Se,{size:16})})]}),!r&&e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:t.isActive("heading",{level:1}),title:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 1",children:e.jsx(Ae,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:t.isActive("heading",{level:2}),title:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 2",children:e.jsx(ze,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),isActive:t.isActive("heading",{level:3}),title:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº 3",children:e.jsx($e,{size:16})})]}),!r&&e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().toggleBulletList().run(),isActive:t.isActive("bulletList"),title:"ÐœÐ°Ñ€ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº",children:e.jsx(P,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().toggleOrderedList().run(),isActive:t.isActive("orderedList"),title:"ÐÑƒÐ¼ÐµÑ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº",children:e.jsx(Le,{size:16})})]}),!r&&e.jsxs("div",{className:"flex gap-0.5 border-r border-white/10 pr-2 mr-1",children:[e.jsx(n,{onClick:()=>t.chain().focus().setTextAlign("left").run(),isActive:t.isActive({textAlign:"left"}),title:"ÐŸÐ¾ Ð»ÐµÐ²Ð¾Ð¼Ñƒ ÐºÑ€Ð°ÑŽ",children:e.jsx(Ie,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().setTextAlign("center").run(),isActive:t.isActive({textAlign:"center"}),title:"ÐŸÐ¾ Ñ†ÐµÐ½Ñ‚Ñ€Ñƒ",children:e.jsx(_e,{size:16})}),e.jsx(n,{onClick:()=>t.chain().focus().setTextAlign("right").run(),isActive:t.isActive({textAlign:"right"}),title:"ÐŸÐ¾ Ð¿Ñ€Ð°Ð²Ð¾Ð¼Ñƒ ÐºÑ€Ð°ÑŽ",children:e.jsx(Ee,{size:16})})]}),e.jsx("div",{className:"flex gap-0.5 items-center border-r border-white/10 pr-2 mr-1",children:e.jsx(n,{onClick:()=>{const s=prompt("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ñƒ LaTeX (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: x^2 + y^2 = r^2):","x^2 + y^2 = r^2");s&&t.chain().focus().insertContent(`$${s}$`).run()},title:"Ð’ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ñƒ (LaTeX)",children:e.jsx(He,{size:16})})}),e.jsx("div",{className:"flex gap-0.5 items-center pl-1",children:e.jsxs("div",{className:"flex items-center gap-1 bg-gaming-bg/50 rounded-lg p-1",children:[e.jsx(Ue,{size:14,className:"text-gaming-textMuted ml-1"}),gt.map(s=>e.jsx("button",{onClick:()=>t.chain().focus().setColor(s).run(),className:`w-4 h-4 rounded-full border border-white/10 hover:scale-110 transition-transform ${t.isActive("textStyle",{color:s})?"ring-2 ring-white":""}`,style:{backgroundColor:s},title:s},s))]})})]})},D=({content:t,onChange:r,placeholder:n,minHeight:s="200px",minimal:i=!1,className:a=""})=>{const p=H.useRef(null),x=async g=>{if(g)try{const j=g.name.split(".").pop(),N=`${`${Date.now()}_${Math.random().toString(36).substring(2)}.${j}`}`,{error:M}=await U.storage.from("images").upload(N,g);if(M)throw M;const{data:R}=U.storage.from("images").getPublicUrl(N);b&&b.chain().focus().setImage({src:R.publicUrl}).run()}catch(j){console.error("Error uploading image:",j),alert("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ")}},u=g=>{const j=(g.clipboardData||g.originalEvent.clipboardData).items;for(const v of j)if(v.kind==="file"&&v.type.startsWith("image/")){g.preventDefault();const N=v.getAsFile();x(N);return}},d=H.useMemo(()=>[je,nt,it,pe,st,We.configure({types:["heading","paragraph"]}),ct.configure({inline:!0,allowBase64:!0}),xt.configure({katexOptions:{throwOnError:!1}})],[]),b=ye({extensions:d,content:t,onUpdate:({editor:g})=>{r(g.getHTML())},editorProps:{attributes:{class:`prose prose-invert max-w-none focus:outline-none px-4 py-3 text-white ${i?"text-sm":""}`,style:`min-height: ${s}`},handlePaste:(g,j)=>{u(j);const v=(j.clipboardData||j.originalEvent.clipboardData).items;for(const N of v)if(N.kind==="file"&&N.type.startsWith("image/"))return!0;return!1}}});return k.useEffect(()=>{if(b&&t!==b.getHTML()){if(b.getText()===""&&t==="")return;b.commands.setContent(t)}},[t,b]),e.jsxs("div",{className:`bg-gaming-bg/50 border border-white/10 rounded-xl overflow-hidden focus-within:border-gaming-primary/50 transition-colors ${a}`,children:[e.jsx("input",{type:"file",ref:p,className:"hidden",accept:"image/*",onChange:g=>x(g.target.files[0])}),e.jsx(pt,{editor:b,minimal:i}),e.jsx(ve,{editor:b,style:{minHeight:s}})]})},ht=({data:t,onChange:r,lang:n})=>{const[s,i]=k.useState(!1),a=(u,d)=>{r({...t,[u]:d})},p=async()=>{i(!0);try{const u=await _(t.bodyTj||"","tj","ru");a("bodyRu",u)}finally{i(!1)}},x=async()=>{i(!0);try{const u=await _(t.bodyRu||"","ru","tj");a("bodyTj",u)}finally{i(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gaming-accent flex items-center gap-2",children:[e.jsx(ce,{size:20}),n==="ru"?"Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»":"ÐœÐ°Ñ‚Ð½Ð¸ Ð´Ð°Ñ€ÑÓ£"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:n==="ru"?"Ð¢ÐµÐºÑÑ‚ (RU)":"ÐœÐ°Ñ‚Ð½ (RU)"}),e.jsx(D,{content:t.bodyRu||"",onChange:u=>a("bodyRu",u),placeholder:n==="ru"?"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ ÑƒÑ€Ð¾ÐºÐ°...":"ÐœÐ°Ñ‚Ð½Ð¸ Ð´Ð°Ñ€ÑÑ€Ð¾ Ð²Ð¾Ñ€Ð¸Ð´ ÐºÑƒÐ½ÐµÐ´..."})]}),e.jsx("button",{type:"button",onClick:p,disabled:s,className:"mt-7 flex items-center gap-1 px-3 py-3 h-fit bg-gaming-primary/20 text-gaming-primary rounded-xl hover:bg-gaming-primary/30 transition-colors disabled:opacity-50",title:"ÐŸÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ TJ -> RU",children:s?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(S,{size:16,className:"rotate-180"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-gaming-textMuted mb-2",children:n==="ru"?"Ð¢ÐµÐºÑÑ‚ (TJ)":"ÐœÐ°Ñ‚Ð½ (TJ)"}),e.jsx(D,{content:t.bodyTj||"",onChange:u=>a("bodyTj",u),placeholder:"ÐœÐ°Ñ‚Ð½Ð¸ Ð´Ð°Ñ€ÑÑ€Ð¾ Ð²Ð¾Ñ€Ð¸Ð´ ÐºÑƒÐ½ÐµÐ´..."})]}),e.jsx("button",{type:"button",onClick:x,disabled:s,className:"mt-7 flex items-center gap-1 px-3 py-3 h-fit bg-gaming-accent/20 text-gaming-accent rounded-xl hover:bg-gaming-accent/30 transition-colors disabled:opacity-50",title:"ÐŸÐµÑ€ÐµÐ²ÐµÑÑ‚Ð¸ RU -> TJ",children:s?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(S,{size:16})})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gaming-textMuted",children:[e.jsxs("span",{children:["RU: ",(t.bodyRu||"").length," ",n==="ru"?"ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²":"Ð°Ð»Ð¾Ð¼Ð°Ñ‚"]}),e.jsxs("span",{children:["TJ: ",(t.bodyTj||"").length," ",n==="ru"?"ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²":"Ð°Ð»Ð¾Ð¼Ð°Ñ‚"]})]})]})},ft={multiple_choice:P,matching:Fe,numeric:De},bt=({question:t,index:r,onEdit:n,onDelete:s,lang:i})=>{const{t:a,i18n:p}=F(),x=i||p.resolvedLanguage||"ru",{attributes:u,listeners:d,setNodeRef:b,transform:g,transition:j,isDragging:v}=Y({id:t.id}),N={transform:Z.Transform.toString(g),transition:j,opacity:v?.5:1},M=ft[t.type]||P,f=(()=>{const c=A=>A?A.toString().replace(/<[^>]*>?/gm,"").replace(/&nbsp;/g," ").trim():"",y=A=>{const V=c(A);return V!==""&&/^\d+$/.test(V)},m=x==="tj"?t.textTj:t.textRu,T=x==="tj"?t.textRu:t.textTj;if(m&&c(m).length>0)return m;if(T&&c(T).length>0)return T;const $=[t.question,t.text,t.title];for(const A of $)if(A&&!y(A))return A;return""})(),l=(c=>{if(!c)return"";let y=c.replace(/<\/(p|div|h\d|li|br)>/g," ");return y=y.replace(/<[^>]*>?/gm,""),y.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").trim()})(f)||a("creator.noQuestionText"),o=x==="tj"?t.imageTj||t.imageRu||t.image:t.imageRu||t.imageTj||t.image;return e.jsxs("div",{ref:b,style:N,className:"bg-gaming-card/40 rounded-xl border border-white/5 p-3 flex items-center gap-3 group hover:border-white/10 transition-colors",children:[e.jsx("div",{...u,...d,className:"cursor-grab text-gaming-textMuted hover:text-white shrink-0 p-1",children:e.jsx(de,{size:20})}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gaming-bg/50 flex items-center justify-center shrink-0 text-gaming-primary border border-white/5",children:e.jsx(M,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer py-1",onClick:()=>n(t),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs font-bold text-gaming-textMuted",children:["#",r+1]}),e.jsx("span",{className:"text-[10px] uppercase font-bold tracking-wider px-1.5 py-0.5 rounded bg-white/5 text-gaming-textMuted/70 border border-white/5",children:a(`creator.${t.type==="multiple_choice"?"singleChoice":t.type}`)}),o&&e.jsx(O,{size:14,className:"text-gaming-accent"})]}),e.jsx("p",{className:"text-sm text-white group-hover:text-gaming-primary transition-colors line-clamp-2 leading-relaxed font-medium",children:l})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0 ml-2",children:[e.jsx("button",{onClick:()=>n(t),className:"p-2 text-gaming-textMuted hover:text-gaming-accent transition-colors rounded-lg hover:bg-white/5",title:a("creator.edit"),children:e.jsx(Oe,{size:18})}),e.jsx("button",{onClick:()=>s(t.id),className:"p-2 text-gaming-textMuted hover:text-red-400 transition-colors rounded-lg hover:bg-white/5",title:a("creator.delete"),children:e.jsx(ue,{size:18})})]})]})},jt=({questions:t,onEdit:r,onDelete:n,lang:s})=>e.jsx("div",{className:"space-y-2",children:t.map((i,a)=>e.jsx(bt,{question:i,index:a,onEdit:r,onDelete:n,lang:s},i.id))}),yt=["","Ð¼","ÑÐ¼","Ð¼Ð¼","ÐºÐ¼","Ð¼Â²","ÑÐ¼Â²","Ð¼Â³","ÐºÐ³","Ð³","Ð»","Ð¼Ð»","Ñ","Ð¼Ð¸Ð½","Ñ‡","Â°","Â°C","%","Ð","Ð”Ð¶","Ð’Ñ‚"],vt=({question:t,onSave:r,onCancel:n})=>{const{t:s,i18n:i}=F();i.resolvedLanguage;const[a,p]=k.useState(()=>{const l=m=>m?m.toString().replace(/<[^>]*>?/gm,"").replace(/&nbsp;/g," ").trim():"",o=m=>{const T=l(m);return T!==""&&/^\d+$/.test(T)},c=m=>{if(!m)return"";const T=[m.question,m.text,m.title];for(const $ of T)if($&&!o($))return $;return""},y={...t,textRu:t.textRu||c(t),textTj:t.textTj??"",imageRu:t.imageRu??t.image??null,imageTj:t.imageTj??null};return y.options&&(y.options=y.options.map(m=>({...m,textRu:m.textRu||c(m),textTj:m.textTj??"",imageRu:m.imageRu??m.image??null,imageTj:m.imageTj??null}))),y.leftItems&&(y.leftItems=y.leftItems.map(m=>({...m,textRu:m.textRu||c(m),textTj:m.textTj??"",imageRu:m.imageRu??m.image??null,imageTj:m.imageTj??null}))),y.rightItems&&(y.rightItems=y.rightItems.map(m=>({...m,textRu:m.textRu||c(m),textTj:m.textTj??"",imageRu:m.imageRu??m.image??null,imageTj:m.imageTj??null}))),y}),[x,u]=k.useState({}),[d,b]=k.useState(!1),g=(l,o)=>p(c=>({...c,[l]:o})),j=(l,o,c)=>{const y=[...a.options];y[l]={...y[l],[o]:c},g("options",y)},v=(l,o,c)=>{const y=[...a.leftItems];y[l]={...y[l],[o]:c},g("leftItems",y)},N=(l,o,c)=>{const y=[...a.rightItems];y[l]={...y[l],[o]:c},g("rightItems",y)},M=(l,o)=>{g("correctMatches",{...a.correctMatches,[l]:o})},R=(l,o)=>{if(o.length>1&&(o=o.slice(-1)),o&&!/^\d$/.test(o))return;const c=[...a.digits];c[l]=o,g("digits",c)},f=async(l,o,c)=>{const y=c.join("_");u(m=>({...m,[y]:!0}));try{const m=await _(l,o==="ru_tj"?"ru":"tj",o==="ru_tj"?"tj":"ru");c.length===1?g(c[0],m):c[0]==="options"?j(c[1],c[2],m):c[0]==="leftItems"?v(c[1],c[2],m):c[0]==="rightItems"&&N(c[1],c[2],m)}finally{u(m=>({...m,[y]:!1}))}},w=async(l,o)=>{if(l){b(!0);try{const c=l.name.split(".").pop(),m=`${`${Date.now()}_${Math.random().toString(36).substring(2)}.${c}`}`,{error:T}=await U.storage.from("images").upload(m,l);if(T)throw T;const{data:$}=U.storage.from("images").getPublicUrl(m);o($.publicUrl)}catch(c){console.error("Upload error:",c),alert(s("creator.uploadError"))}finally{b(!1)}}},h=({image:l,onUpload:o,onRemove:c,size:y="md"})=>{const m=H.useRef(null);return l?e.jsxs("div",{className:`relative group ${y==="sm"?"w-10 h-10":"w-full h-32"} bg-gaming-card/50 rounded-lg border border-white/10 overflow-hidden`,children:[e.jsx("img",{src:l,alt:"Uploaded",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:c,className:"absolute top-1 right-1 p-1 bg-red-500/80 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(J,{size:12})})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:m,className:"hidden",accept:"image/*",onChange:T=>w(T.target.files[0],o),disabled:d}),e.jsx("button",{onClick:()=>{var T;return(T=m.current)==null?void 0:T.click()},disabled:d,className:`flex items-center justify-center ${y==="sm"?"w-10 h-10":"w-full h-10"} bg-gaming-bg/30 border border-white/10 rounded-lg hover:bg-gaming-bg/50 transition-colors`,children:d?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(O,{size:16})})]})};return e.jsxs("div",{className:"flex flex-col h-full bg-gaming-card max-h-[85vh] w-full max-w-4xl mx-auto rounded-2xl border border-white/10 shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10 bg-black/20",children:[e.jsxs("h3",{className:"text-lg font-bold text-gaming-primary flex items-center gap-2",children:[a.id.startsWith("new_")?s("creator.addQuestion"):s("creator.editQuestion"),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-white/5 rounded-full text-gaming-textMuted font-normal border border-white/5",children:s(`creator.${a.type==="multiple_choice"?"singleChoice":a.type}`)})]}),e.jsx("button",{onClick:n,className:"p-2 text-gaming-textMuted hover:text-white transition-colors rounded-lg hover:bg-white/5",children:e.jsx(J,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-medium text-gaming-textMuted ml-1",children:s("creator.imageRu")}),e.jsx(h,{image:a.imageRu,onUpload:l=>g("imageRu",l),onRemove:()=>g("imageRu",null),size:"lg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-medium text-gaming-textMuted ml-1",children:s("creator.imageTj")}),e.jsx(h,{image:a.imageTj,onUpload:l=>g("imageTj",l),onRemove:()=>g("imageTj",null),size:"lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-gaming-textMuted ml-1",children:s("creator.questionTextRu")}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"flex-1",children:e.jsx(D,{content:a.textRu,onChange:l=>g("textRu",l),placeholder:s("creator.enterQuestionText"),minimal:!0,minHeight:"80px"})}),e.jsx("button",{onClick:()=>f(a.textRu,"ru_tj",["textTj"]),disabled:x.textTj,className:"mt-2 p-2 bg-gaming-accent/20 text-gaming-accent rounded-lg hover:bg-gaming-accent/30 disabled:opacity-50",children:x.textTj?e.jsx(C,{size:14,className:"animate-spin"}):e.jsx(S,{size:14})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-gaming-textMuted ml-1",children:s("creator.questionTextTj")}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"flex-1",children:e.jsx(D,{content:a.textTj,onChange:l=>g("textTj",l),placeholder:s("creator.enterQuestionText"),minimal:!0,minHeight:"80px"})}),e.jsx("button",{onClick:()=>f(a.textTj,"tj_ru",["textRu"]),disabled:x.textRu,className:"mt-2 p-2 bg-gaming-primary/20 text-gaming-primary rounded-lg hover:bg-gaming-primary/30 disabled:opacity-50",children:x.textRu?e.jsx(C,{size:14,className:"animate-spin"}):e.jsx(S,{size:14,className:"rotate-180"})})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-white/5",children:[a.type==="multiple_choice"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-sm font-medium text-gaming-textMuted block mb-2",children:s("creator.answerOptions")}),a.options.map((l,o)=>e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("button",{onClick:()=>g("correctId",l.id),className:`w-8 h-8 rounded-lg flex items-center justify-center transition-all ${a.correctId===l.id?"bg-green-500/20 text-green-400 ring-1 ring-green-500/50":"bg-gaming-bg/30 text-gaming-textMuted hover:bg-white/5"}`,children:a.correctId===l.id?e.jsx(Je,{size:16}):e.jsx("span",{className:"text-xs font-bold",children:String.fromCharCode(65+o)})}),e.jsx("input",{type:"text",value:l.textRu,onChange:c=>j(o,"textRu",c.target.value),placeholder:"RU options",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded-lg px-3 py-2 text-sm focus:border-gaming-primary/50 outline-none"}),e.jsx("button",{onClick:()=>f(l.textRu,"ru_tj",["options",o,"textTj"]),disabled:x[`options_${o}_textTj`],className:"p-2 bg-gaming-accent/10 text-gaming-accent rounded-lg hover:bg-gaming-accent/20",children:x[`options_${o}_textTj`]?e.jsx(C,{size:12,className:"animate-spin"}):e.jsx(S,{size:12})}),e.jsx("input",{type:"text",value:l.textTj,onChange:c=>j(o,"textTj",c.target.value),placeholder:"TJ options",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded-lg px-3 py-2 text-sm focus:border-gaming-accent/50 outline-none"}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageRu,onUpload:c=>j(o,"imageRu",c),onRemove:()=>j(o,"imageRu",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"RU"})]}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageTj,onUpload:c=>j(o,"imageTj",c),onRemove:()=>j(o,"imageTj",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"TJ"})]})]},l.id))]}),a.type==="matching"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-bold text-gaming-textMuted uppercase tracking-wider",children:s("creator.leftColumn")}),a.leftItems.map((l,o)=>e.jsxs("div",{className:"p-3 bg-white/5 rounded-xl border border-white/5 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gaming-pink w-6 text-center",children:l.id}),e.jsx("input",{type:"text",value:l.textRu,onChange:c=>v(o,"textRu",c.target.value),placeholder:"RU",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded px-2 py-1 text-sm outline-none focus:border-gaming-pink/50"})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-8",children:[e.jsx("input",{type:"text",value:l.textTj,onChange:c=>v(o,"textTj",c.target.value),placeholder:"TJ",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded px-2 py-1 text-sm outline-none focus:border-gaming-accent/50"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(l.textRu,"ru_tj",["leftItems",o,"textTj"]),disabled:x[`leftItems_${o}_textTj`],className:"p-1.5 bg-gaming-accent/10 text-gaming-accent rounded hover:bg-gaming-accent/20 h-10",children:x[`leftItems_${o}_textTj`]?e.jsx(C,{size:12,className:"animate-spin"}):e.jsx(S,{size:12})}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageRu,onUpload:c=>v(o,"imageRu",c),onRemove:()=>v(o,"imageRu",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"RU"})]}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageTj,onUpload:c=>v(o,"imageTj",c),onRemove:()=>v(o,"imageTj",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"TJ"})]})]})]})]},l.id))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-xs font-bold text-gaming-textMuted uppercase tracking-wider",children:s("creator.rightColumn")}),a.rightItems.map((l,o)=>e.jsxs("div",{className:"p-3 bg-white/5 rounded-xl border border-white/5 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gaming-accent w-6 text-center",children:l.id}),e.jsx("input",{type:"text",value:l.textRu,onChange:c=>N(o,"textRu",c.target.value),placeholder:"RU",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded px-2 py-1 text-sm outline-none focus:border-gaming-primary/50"})]}),e.jsxs("div",{className:"flex items-center gap-2 pl-8",children:[e.jsx("input",{type:"text",value:l.textTj,onChange:c=>N(o,"textTj",c.target.value),placeholder:"TJ",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded px-2 py-1 text-sm outline-none focus:border-gaming-accent/50"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(l.textRu,"ru_tj",["rightItems",o,"textTj"]),disabled:x[`rightItems_${o}_textTj`],className:"p-1.5 bg-gaming-accent/10 text-gaming-accent rounded hover:bg-gaming-accent/20 h-10",children:x[`rightItems_${o}_textTj`]?e.jsx(C,{size:12,className:"animate-spin"}):e.jsx(S,{size:12})}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageRu,onUpload:c=>N(o,"imageRu",c),onRemove:()=>N(o,"imageRu",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"RU"})]}),e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx(h,{image:l.imageTj,onUpload:c=>N(o,"imageTj",c),onRemove:c=>N(o,"imageTj",null),size:"sm"}),e.jsx("span",{className:"text-[10px] text-gaming-textMuted",children:"TJ"})]})]})]})]},l.id))]})]}),e.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[e.jsx("span",{className:"text-sm font-semibold text-white block mb-4 text-center",children:s("creator.correctMatchesGrid")}),e.jsx("div",{className:"overflow-x-auto flex justify-center",children:e.jsxs("table",{className:"border-separate border-spacing-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-8"}),a.rightItems.map(l=>e.jsx("th",{className:"text-center font-bold text-gaming-accent text-sm pb-2",children:l.id},l.id))]})}),e.jsx("tbody",{children:a.leftItems.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center font-bold text-gaming-pink text-sm pr-2",children:l.id}),a.rightItems.map(o=>{const c=a.correctMatches[l.id]===o.id;return e.jsx("td",{className:"text-center p-0.5",children:e.jsx("button",{onClick:()=>M(l.id,o.id),className:`w-8 h-8 rounded-full border transition-all flex items-center justify-center ${c?"bg-gaming-primary border-gaming-primary shadow-[0_0_8px_rgba(var(--gaming-primary-rgb),0.5)]":"bg-white/5 border-white/20 hover:border-white/40"}`,children:c&&e.jsx("div",{className:"w-3 h-3 bg-white rounded-full"})})},o.id)})]},l.id))})]})})]})]}),a.type==="numeric"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("span",{className:"text-sm font-medium text-gaming-textMuted",children:s("creator.enterCorrectAnswer")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex gap-2",children:a.digits.map((l,o)=>e.jsx("input",{type:"text",value:l,onChange:c=>R(o,c.target.value),maxLength:1,className:"w-12 h-14 text-center text-2xl font-bold bg-gaming-bg/50 border-2 border-white/20 rounded-xl text-white outline-none focus:border-gaming-primary transition-colors",placeholder:"0"},o))}),e.jsx("select",{value:a.unit||"",onChange:l=>g("unit",l.target.value),className:"bg-gaming-bg/50 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-gaming-primary/50",children:yt.map(l=>e.jsx("option",{value:l,children:l||s("creator.noUnit")},l))})]})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-white/10 bg-black/20 flex justify-end gap-3 rounded-b-2xl",children:[e.jsx("button",{onClick:n,className:"px-5 py-2.5 text-gaming-textMuted hover:text-white transition-colors",children:s("creator.cancel")}),e.jsx("button",{onClick:()=>r(a),className:"px-6 py-2.5 bg-gaming-primary text-white rounded-xl hover:bg-gaming-primary/80 transition-colors shadow-lg shadow-gaming-primary/20 font-medium",children:s("creator.saveQuestion")})]})]})},Nt=[{id:"multiple_choice",icon:L,label:"creator.singleChoice"},{id:"matching",icon:L,label:"creator.matching"},{id:"numeric",icon:L,label:"creator.numeric"}],wt=({data:t,onChange:r,lang:n})=>{const{t:s}=F(),i=t.questions||[],[a,p]=k.useState(null),[x,u]=k.useState(!1),[d,b]=k.useState(null),g=q(E(se,{activationConstraint:{distance:8}}),E(te,{coordinateGetter:ee})),j=h=>{const l={id:`new_${Date.now()}`,type:h,textRu:"",textTj:"",imageRu:null,imageTj:null,...h==="multiple_choice"?{options:Array(4).fill(null).map((o,c)=>({id:`opt_${Date.now()}_${c}`,textRu:"",textTj:"",imageRu:null,imageTj:null})),correctId:null}:{},...h==="matching"?{leftItems:["A","B","C","D"].map(o=>({id:o,textRu:"",textTj:"",imageRu:null,imageTj:null})),rightItems:["1","2","3","4","5"].map(o=>({id:o,textRu:"",textTj:"",imageRu:null,imageTj:null})),correctMatches:{}}:{},...h==="numeric"?{digits:["","","",""],unit:""}:{}};p(l.id),N(l),u(!0),b(null)},[v,N]=k.useState(null),M=h=>{p(h.id),N(h),u(!0)},R=h=>{window.confirm(s("creator.confirmDelete"))&&r({...t,questions:i.filter(l=>l.id!==h)})},f=h=>{let l=[...i];if(h.id.startsWith("new_")){const o={...h,id:h.id.replace("new_","q_")};l.push(o)}else{const o=l.findIndex(c=>c.id===h.id);o!==-1&&(l[o]=h)}r({...t,questions:l}),u(!1),N(null),p(null)},w=h=>{const{active:l,over:o}=h;if(l.id!==o.id){const c=i.findIndex(m=>m.id===l.id),y=i.findIndex(m=>m.id===o.id);r({...t,questions:le(i,c,y)})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gaming-pink flex items-center gap-2",children:[e.jsx(L,{size:20}),s("creator.testQuestions"),e.jsxs("span",{className:"text-sm font-normal text-gaming-textMuted ml-2",children:["(",i.length,")"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>b(d==="top"?null:"top"),className:"flex items-center gap-2 px-3 py-2 bg-gaming-pink/20 text-gaming-pink rounded-xl hover:bg-gaming-pink/30 transition-colors text-sm",children:[e.jsx(me,{size:16}),s("creator.addQuestion"),e.jsx(Be,{size:14})]}),d==="top"&&e.jsx("div",{className:"absolute right-0 top-full mt-2 bg-gaming-card border border-white/10 rounded-xl shadow-xl z-20 min-w-[200px] overflow-hidden",children:Nt.map(h=>e.jsx("button",{onClick:()=>j(h.id),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-white/5 transition-colors text-left",children:e.jsx("span",{className:"text-sm",children:s(h.label)})},h.id))})]})]}),e.jsx(re,{sensors:g,collisionDetection:ne,onDragEnd:w,children:e.jsx(ae,{items:i.map(h=>h.id),strategy:ie,children:e.jsx(jt,{questions:i,onEdit:M,onDelete:R,lang:n})})}),i.length===0&&e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-white/5 rounded-xl bg-white/5 text-gaming-textMuted",children:[e.jsx(L,{size:40,className:"mx-auto mb-3 opacity-20"}),e.jsx("p",{children:s("creator.noQuestions")}),e.jsx("p",{className:"text-sm opacity-50",children:s("creator.addFirstQuestion")})]}),x&&v&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 animate-fade-in-up",children:e.jsx(vt,{question:v,onSave:f,onCancel:()=>u(!1)})})]})},Tt=(t,r=1600,n=.7)=>new Promise((s,i)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=p=>{const x=new Image;x.src=p.target.result,x.onload=()=>{const u=document.createElement("canvas");let d=x.width,b=x.height;d>b?d>r&&(b=Math.round(b*r/d),d=r):b>r&&(d=Math.round(d*r/b),b=r),u.width=d,u.height=b,u.getContext("2d").drawImage(x,0,0,d,b);const j=u.toDataURL("image/jpeg",n);s(j)},x.onerror=u=>i(u)},a.onerror=p=>i(p)}),kt=({slide:t,index:r,onUpdate:n,onDelete:s,lang:i,editLang:a})=>{const{attributes:p,listeners:x,setNodeRef:u,transform:d,transition:b}=Y({id:t.id}),g={transform:Z.Transform.toString(d),transition:b},j=a==="ru"?"captionRu":"captionTj",v=a==="ru"?i==="ru"?"ÐŸÐ¾Ð´Ð¿Ð¸ÑÑŒ (RU)":"Ð¡Ð°Ñ€Ð»Ð°Ð²Ò³Ð° (RU)":i==="ru"?"ÐŸÐ¾Ð´Ð¿Ð¸ÑÑŒ (TJ)":"Ð¡Ð°Ñ€Ð»Ð°Ð²Ò³Ð° (TJ)";return e.jsx("div",{ref:u,style:g,className:"bg-gaming-bg/30 rounded-xl p-4 border border-white/5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{...p,...x,className:"mt-2 cursor-grab text-gaming-textMuted hover:text-white",children:e.jsx(de,{size:18})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gaming-textMuted",children:["Ð¡Ð»Ð°Ð¹Ð´"," #",r+1]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("button",{onClick:()=>s(t.id),className:"p-1 text-gaming-textMuted hover:text-red-400 transition-colors",children:e.jsx(ue,{size:16})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{size:16,className:"text-gaming-textMuted"}),e.jsx("input",{type:"url",value:t.imageUrl||"",onChange:N=>n(t.id,"imageUrl",N.target.value),placeholder:i==="ru"?"URL Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ":"URL Ñ‚Ð°ÑÐ²Ð¸Ñ€",className:"flex-1 bg-gaming-bg/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 focus:outline-none focus:border-gaming-gold/50"})]}),t.imageUrl&&e.jsx("div",{className:"w-full h-32 rounded-lg overflow-hidden bg-gaming-card/50",children:e.jsx("img",{src:t.imageUrl,alt:`Slide ${r+1}`,className:"w-full h-full object-contain",onError:N=>{N.target.style.display="none"}})}),e.jsx("input",{type:"text",value:t[j]||"",onChange:N=>n(t.id,j,N.target.value),placeholder:v,className:`w-full bg-gaming-bg/50 border border-white/10 rounded-lg px-3 py-2 text-sm text-white placeholder-white/30 focus:outline-none transition-colors ${a==="ru"?"focus:border-gaming-primary/50":"focus:border-gaming-accent/50"}`})]})]})})},Mt=({slidesRu:t=[],slidesTj:r=[],onChange:n,lang:s})=>{const[i,a]=k.useState("ru"),[p,x]=k.useState(!1),u=H.useRef(null),d=i==="ru"?t:r,b=i==="ru"?"slidesRu":"slidesTj",g=q(E(se),E(te,{coordinateGetter:ee})),j=()=>{const f={id:`slide_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,imageUrl:"",captionRu:"",captionTj:""};n(b,[...d,f])},v=async f=>{const w=Array.from(f.target.files);if(w.length!==0){x(!0);try{const h=await Promise.all(w.map(async l=>{const o=await Tt(l);return{id:`slide_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,imageUrl:o,captionRu:"",captionTj:""}}));n(b,[...d,...h])}catch(h){console.error("Error compressing images:",h),alert(s==="ru"?"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹":"Ð¥Ð°Ñ‚Ð¾Ð³Ó£ Ò³Ð°Ð½Ð³Ð¾Ð¼Ð¸ Ð±Ð¾Ñ€ÐºÑƒÐ½Ð¸Ð¸ Ñ‚Ð°ÑÐ²Ð¸Ñ€Ò³Ð¾")}finally{x(!1),u.current&&(u.current.value="")}}},N=(f,w,h)=>{const l=d.map(o=>o.id===f?{...o,[w]:h}:o);n(b,l)},M=f=>{n(b,d.filter(w=>w.id!==f))},R=f=>{if(active.id!==over.id){const w=d.findIndex(l=>l.id===active.id),h=d.findIndex(l=>l.id===over.id);n(b,le(d,w,h))}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 bg-white/5 p-4 rounded-2xl border border-white/10",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gaming-gold flex items-center gap-2",children:[e.jsx(B,{size:20}),s==="ru"?"Ð¡Ð»Ð°Ð¹Ð´Ñ‹ Ð¿Ñ€ÐµÐ·ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸":"Ð¡Ð»Ð°Ð¹Ð´Ò³Ð¾Ð¸ Ð¿Ñ€ÐµÐ·ÐµÐ½Ñ‚Ð°Ñ‚ÑÐ¸Ñ"]}),e.jsxs("div",{className:"flex p-1 bg-black/30 rounded-xl border border-white/5 w-fit",children:[e.jsxs("button",{onClick:()=>a("ru"),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${i==="ru"?"bg-gaming-primary text-white shadow-lg":"text-gaming-textMuted hover:text-white"}`,children:[e.jsx(W,{size:14}),"Ð Ð£Ð¡"]}),e.jsxs("button",{onClick:()=>a("tj"),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${i==="tj"?"bg-gaming-accent text-white shadow-lg":"text-gaming-textMuted hover:text-white"}`,children:[e.jsx(W,{size:14}),"Ð¢ÐžÒ¶"]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center self-end sm:self-center",children:[e.jsx("input",{type:"file",ref:u,onChange:v,multiple:!0,accept:"image/*",className:"hidden"}),e.jsxs("button",{onClick:()=>{var f;return(f=u.current)==null?void 0:f.click()},disabled:p,className:"flex items-center gap-2 px-3 py-2 bg-gaming-accent/20 text-gaming-accent rounded-xl hover:bg-gaming-accent/30 transition-colors text-sm",children:[p?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(O,{size:16}),s==="ru"?"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ":"Ð‘Ð¾Ñ€ÐºÑƒÐ½Ó£"]}),e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-3 py-2 bg-gaming-gold/20 text-gaming-gold rounded-xl hover:bg-gaming-gold/30 transition-colors text-sm",children:[e.jsx(me,{size:16}),s==="ru"?"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ":"Ð˜Ð»Ð¾Ð²Ð°"]})]})]}),d.length===0?e.jsxs("div",{className:"text-center py-12 bg-gaming-bg/20 rounded-2xl border border-dashed border-white/10",children:[e.jsx(B,{size:48,className:"mx-auto mb-3 opacity-20 text-gaming-gold"}),e.jsx("p",{className:"text-gaming-textMuted",children:s==="ru"?`Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÐ»Ð°Ð¹Ð´Ð¾Ð² (${i==="ru"?"RU":"TJ"}) Ð¿ÑƒÑÑ‚`:`Ð Ó¯Ð¹Ñ…Ð°Ñ‚Ð¸ ÑÐ»Ð°Ð¹Ð´Ò³Ð¾ (${i==="ru"?"RU":"TJ"}) Ñ…Ð¾Ð»Ó£ Ð°ÑÑ‚`}),e.jsx("button",{onClick:j,className:"mt-4 px-4 py-2 text-sm text-gaming-gold hover:underline",children:s==="ru"?"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ ÑÐ»Ð°Ð¹Ð´":"Ð¯ÐºÑƒÐ¼ ÑÐ»Ð°Ð¹Ð´Ñ€Ð¾ ÑÐ¾Ð·ÐµÐ´"})]}):e.jsx(re,{sensors:g,collisionDetection:ne,onDragEnd:R,children:e.jsx(ae,{items:d.map(f=>f.id),strategy:ie,children:e.jsx("div",{className:"space-y-3",children:d.map((f,w)=>e.jsx(kt,{slide:f,index:w,lang:s,editLang:i,onUpdate:N,onDelete:M},f.id))})})})]})},Ct=[{id:"video",icon:oe,label:"creator.video"},{id:"text",icon:ce,label:"creator.text"},{id:"test",icon:L,label:"creator.test"},{id:"slides",icon:B,label:"creator.presentation"}],Ht=({lesson:t,onSave:r,onAutoSave:n,onClose:s,isSaving:i,autoSaveStatus:a})=>{const{t:p,i18n:x}=F(),u=x.resolvedLanguage||"ru",[d,b]=k.useState("video"),[g,j]=k.useState(t.content||{video:{url:"",descriptionRu:"",descriptionTj:""},text:{bodyRu:"",bodyTj:""},test:{questions:[]},slidesRu:[],slidesTj:[]}),v=Pe(g,1500);k.useEffect(()=>{n&&v&&JSON.stringify(v)!==JSON.stringify(t.content)&&n(v)},[v]);const N=f=>{b(f)},M=(f,w)=>{j(h=>({...h,[f]:w}))},R=()=>{r({...t,content:g})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/70 backdrop-blur-sm sm:p-4",children:e.jsxs("div",{className:"w-full max-w-4xl h-[90vh] sm:h-auto sm:max-h-[90vh] bg-gaming-card/95 backdrop-blur-xl rounded-t-3xl sm:rounded-3xl border border-white/10 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-white/10 shrink-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:p("creator.editing")}),a==="saving"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-white/5 rounded-full text-gaming-textMuted",children:[e.jsx(C,{size:12,className:"animate-spin"}),"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ..."]}),a==="saved"&&e.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 bg-green-500/10 text-green-400 rounded-full",children:[e.jsx(Qe,{size:12}),"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾ Ð² Ð±Ð°Ð·Ñƒ"]})]}),e.jsx("p",{className:"text-gaming-textMuted mt-1 text-sm sm:text-base truncate max-w-[200px] sm:max-w-md",children:u==="tj"&&t.titleTj||t.title})]}),e.jsx("button",{onClick:s,disabled:i,className:"p-2 text-gaming-textMuted hover:text-white transition-colors disabled:opacity-50",children:e.jsx(J,{size:24})})]}),e.jsx("div",{className:"flex gap-2 px-4 sm:px-6 py-3 sm:py-4 border-b border-white/5 overflow-x-auto shrink-0 no-scrollbar",children:Ct.map(f=>{const w=f.icon,h=d===f.id;return e.jsxs("button",{onClick:()=>N(f.id),disabled:i,className:`flex items-center gap-2 px-3 sm:px-4 py-2 rounded-xl whitespace-nowrap transition-all text-sm sm:text-base ${h?"bg-gaming-primary text-white":"bg-gaming-bg/50 text-gaming-textMuted hover:text-white"} ${i?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(w,{size:16,className:"sm:w-[18px] sm:h-[18px]"}),p(f.label)]},f.id)})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 pointer-events-auto",children:[i&&e.jsx("div",{className:"absolute inset-0 bg-black/20 z-10 flex items-center justify-center",children:e.jsx(C,{size:40,className:"animate-spin text-gaming-primary"})}),d==="video"&&e.jsx(Ve,{data:g.video||{},onChange:f=>M("video",f),lang:u}),d==="text"&&e.jsx(ht,{data:g.text||{},onChange:f=>M("text",f),lang:u}),d==="test"&&e.jsx(wt,{data:g.test||{questions:[]},onChange:f=>M("test",f),lang:u}),d==="slides"&&e.jsx(Mt,{slidesRu:g.slidesRu||[],slidesTj:g.slidesTj||[],onChange:(f,w)=>j(h=>({...h,[f]:w})),lang:u})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 sm:p-6 border-t border-white/10 shrink-0 bg-gaming-card/95",children:[e.jsx("button",{onClick:s,disabled:i,className:"px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base text-gaming-textMuted hover:text-white transition-colors disabled:opacity-50",children:p("creator.cancel")}),e.jsxs("button",{onClick:R,disabled:i,className:"flex items-center gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-gaming-primary text-white rounded-xl hover:bg-gaming-primary/80 transition-colors active:scale-95 text-sm sm:text-base disabled:opacity-70 disabled:active:scale-100",children:[i?e.jsx(C,{size:18,className:"animate-spin"}):e.jsx(Ge,{size:18}),p(i?"creator.saving":"creator.save")]})]})]})})};export{Ht as default};
