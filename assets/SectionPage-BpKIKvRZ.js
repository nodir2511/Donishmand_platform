import{a as v,b as N,c as w,j as e,u as y,L,d as k,A as C}from"./index-CrMD2eKm.js";import{C as T}from"./CourseLayout-Cji7AdFi.js";import{g as u}from"./progressHelpers-CJ7J7Gvk.js";import{u as M,F as p}from"./SyllabusContext-BFdS8Iuu.js";import{A as $}from"./arrow-left-D3ZV23JY.js";import"./home-Te0i9fN5.js";const A=({subjectId:n,sectionId:r,isTeacher:c,navigate:l})=>{const{t:s,i18n:j}=y(),d=j.resolvedLanguage||"ru",{subjectData:a,loading:f}=M();if(f)return e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx(L,{size:40,className:"text-gaming-primary animate-spin"})});const o=a==null?void 0:a.sections.find(t=>t.id===r),g=(a==null?void 0:a.sections.findIndex(t=>t.id===r))??-1;if(!o)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[40vh] text-white",children:[e.jsx("h2",{className:"text-2xl mb-4",children:s("sectionNotFound")}),e.jsx("button",{onClick:()=>l(`/subject/${n}`),className:"text-gaming-primary hover:underline",children:s("backToSubject")})]});const h=t=>d==="tj"&&t.titleTj?t.titleTj:t.title;return e.jsxs("div",{className:"max-w-5xl",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2 text-gaming-primary",children:[g+1,". ",h(o)]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsxs("button",{onClick:()=>l(`/subject/${n}`),className:"flex items-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-gaming-textMuted hover:text-white transition-all group w-fit",children:[e.jsx($,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:s("backToSubject")})]}),e.jsxs("p",{className:"text-gaming-textMuted",children:[o.topics.length," ",s("themesCount")]})]}),(()=>{const t=o.topics.flatMap(m=>m.lessons.map(x=>x.id)),i=u(t);return i&&!c?e.jsxs("div",{className:"mb-8 p-6 bg-gradient-to-r from-gaming-accent/10 to-gaming-blue/10 rounded-2xl border border-white/5 flex items-center gap-6",children:[e.jsx("div",{className:"p-4 bg-gaming-accent/20 rounded-full text-gaming-accent",children:e.jsx(p,{size:32})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-3xl font-bold text-white mb-1",children:[i.avgErrorRate,"%"]}),e.jsx("div",{className:"text-gaming-textMuted text-sm",children:d==="ru"?"Средний % ошибок по разделу":"Миёна % хатогиҳо дар бахш"}),e.jsx("div",{className:"text-xs text-gaming-textMuted mt-1 opacity-70",children:d==="ru"?`На основе ${i.completedLessons} пройденных уроков`:`Дар асоси ${i.completedLessons} дарсҳои гузашта`})]})]}):null})(),e.jsx("div",{className:"space-y-4",children:o.topics.map((t,i)=>{const m=t.lessons.map(b=>b.id),x=u(m);return e.jsxs(k,{to:`/subject/${n}/section/${r}/topic/${t.id}`,className:"group flex items-center gap-4 bg-gaming-card/40 backdrop-blur-xl border border-white/5 p-5 rounded-2xl hover:border-gaming-accent/50 transition-all duration-300 hover:bg-gaming-card/60",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gaming-accent/10 flex items-center justify-center text-gaming-accent group-hover:scale-110 transition-transform",children:e.jsx(p,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-lg font-bold group-hover:text-gaming-accent transition-colors truncate",children:[g+1,".",i+1,". ",h(t)]}),e.jsxs("p",{className:"text-sm text-gaming-textMuted",children:[t.lessons.length," ",s("lessonsCount")]})]}),x&&!c&&e.jsxs("div",{className:"mr-2 text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-white leading-none",children:[x.avgErrorRate,"%"]}),e.jsx("div",{className:"text-[10px] text-gaming-textMuted uppercase tracking-wider opacity-70",children:d==="ru"?"ошибок":"хато"})]}),e.jsx(C,{className:"text-white/20 group-hover:text-gaming-accent transition-colors shrink-0"})]},t.id)})})]})},P=()=>{const{subjectId:n,sectionId:r}=v(),c=N(),{isTeacher:l,isAdmin:s}=w();return e.jsx(T,{subjectId:n,children:e.jsx(A,{subjectId:n,sectionId:r,isTeacher:l||s,navigate:c})})};export{P as default};
