import{e as F,u as L,R as $,r as i,j as t,X as y,C as A}from"./index-DRfO7QNx.js";import{C as I}from"./katex-BMcjISZR.js";import{C as _}from"./chevron-left-DH9hOaJo.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=F("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),J=({slides:c,lessonId:d,onClose:u,onSlideView:x})=>{const{i18n:v}=L(),f=v.resolvedLanguage||"ru",h=$.useRef(null),[l,a]=i.useState(0),[o,m]=i.useState(!1),[r,k]=i.useState(()=>{const e=localStorage.getItem(`viewed_slides_${d}`);return e?JSON.parse(e):[]}),s=c[l];i.useEffect(()=>{if(s&&!r.includes(s.id)){const e=[...r,s.id];k(e),localStorage.setItem(`viewed_slides_${d}`,JSON.stringify(e)),x&&x(s.id)}},[l,s,r,d,x]);const g=i.useCallback(e=>{e.key==="ArrowLeft"||e.key==="ArrowUp"?a(n=>n>0?n-1:n):e.key==="ArrowRight"||e.key==="ArrowDown"||e.key===" "?a(n=>n<c.length-1?n+1:n):e.key==="Escape"?o?m(!1):u():(e.key==="f"||e.key==="F")&&m(n=>!n)},[c.length,o,u]);i.useEffect(()=>(window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)),[g]),i.useEffect(()=>{const e=()=>{m(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),h.current&&h.current.requestFullscreen().catch(n=>{console.log("Auto-fullscreen blocked:",n)}),()=>{document.removeEventListener("fullscreenchange",e),document.fullscreenElement&&document.exitFullscreen().catch(n=>console.log("Exit fullscreen error:",n))}},[]);const[j,p]=i.useState(null),N=e=>{p(e.touches[0].clientX)},E=e=>{if(!j)return;const n=e.changedTouches[0].clientX,w=j-n;Math.abs(w)>50&&(w>0&&l<c.length-1?a(b=>b+1):w<0&&l>0&&a(b=>b-1)),p(null)},C=()=>a(e=>e>0?e-1:e),z=()=>a(e=>e<c.length-1?e+1:e),R=()=>{var e;document.fullscreenElement?document.exitFullscreen().catch(n=>console.log(n)):(e=h.current)==null||e.requestFullscreen().catch(n=>console.log(n))},S=o?"fixed inset-0 z-[100] bg-black":"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4",T=o?"w-full h-full flex items-center justify-center":"w-full max-w-5xl max-h-[80vh] flex items-center justify-center";return t.jsxs("div",{ref:h,className:S,onTouchStart:N,onTouchEnd:E,children:[!o&&t.jsxs("div",{className:"absolute top-4 left-4 right-4 flex items-center justify-between z-10",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-white/70 text-sm",children:[l+1," / ",c.length]}),r.includes(s==null?void 0:s.id)&&t.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-green-500/20 text-green-400 rounded-full text-xs",children:[t.jsx(I,{size:12}),f==="ru"?"Просмотрено":"Дида шуд"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:R,className:"p-2 text-white/70 hover:text-white transition-colors rounded-lg hover:bg-white/10",title:"Fullscreen (F)",children:t.jsx(M,{size:20})}),t.jsx("button",{onClick:u,className:"p-2 text-white/70 hover:text-white transition-colors rounded-lg hover:bg-white/10",children:t.jsx(y,{size:24})})]})]}),o&&t.jsx("div",{className:"absolute top-4 right-4 z-10",children:t.jsx("button",{onClick:u,className:"p-2 text-white/50 hover:text-white transition-colors",children:t.jsx(y,{size:24})})}),t.jsx("div",{className:T,children:s&&t.jsx("img",{src:s.imageUrl,alt:f==="tj"&&s.captionTj||s.captionRu,className:o?"max-w-full max-h-full object-contain":"max-w-full max-h-[70vh] object-contain rounded-lg"})}),!o&&s&&(s.captionRu||s.captionTj)&&t.jsx("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 max-w-2xl text-center",children:t.jsx("p",{className:"text-white/90 text-lg bg-black/50 px-6 py-3 rounded-xl backdrop-blur-sm",children:f==="tj"&&s.captionTj||s.captionRu})}),t.jsx("button",{onClick:C,disabled:l===0,className:`absolute left-4 top-1/2 -translate-y-1/2 p-3 rounded-full transition-all ${l===0?"text-white/20 cursor-not-allowed":"text-white/70 hover:text-white hover:bg-white/10"}`,children:t.jsx(_,{size:32})}),t.jsx("button",{onClick:z,disabled:l===c.length-1,className:`absolute right-4 top-1/2 -translate-y-1/2 p-3 rounded-full transition-all ${l===c.length-1?"text-white/20 cursor-not-allowed":"text-white/70 hover:text-white hover:bg-white/10"}`,children:t.jsx(A,{size:32})}),t.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex items-center gap-2",children:c.map((e,n)=>t.jsx("button",{onClick:()=>a(n),className:`w-2 h-2 rounded-full transition-all ${n===l?"bg-white w-4":r.includes(e.id)?"bg-green-500/70 hover:bg-green-500":"bg-white/30 hover:bg-white/50"}`},e.id))}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white/10",children:t.jsx("div",{className:"h-full bg-gaming-primary transition-all duration-300",style:{width:`${(l+1)/c.length*100}%`}})})]})};export{J as default};
