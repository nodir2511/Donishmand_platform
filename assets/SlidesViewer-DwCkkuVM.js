import{j as t}from"./editor-B4b3M6em.js";import{R as F,r as a}from"./vendor-DfgOC3sD.js";import{u as L,i as $,aj as A,X as v,p as _,g as I}from"./ui-DAjowxi7.js";const J=({slides:c,lessonId:d,onClose:u,onSlideView:x})=>{const{i18n:k}=L(),f=k.resolvedLanguage||"ru",h=F.useRef(null),[l,i]=a.useState(0),[o,m]=a.useState(!1),[r,N]=a.useState(()=>{const e=localStorage.getItem(`viewed_slides_${d}`);return e?JSON.parse(e):[]}),n=c[l];a.useEffect(()=>{if(n&&!r.includes(n.id)){const e=[...r,n.id];N(e),localStorage.setItem(`viewed_slides_${d}`,JSON.stringify(e)),x&&x(n.id)}},[l,n,r,d,x]);const g=a.useCallback(e=>{e.key==="ArrowLeft"||e.key==="ArrowUp"?i(s=>s>0?s-1:s):e.key==="ArrowRight"||e.key==="ArrowDown"||e.key===" "?i(s=>s<c.length-1?s+1:s):e.key==="Escape"?o?m(!1):u():(e.key==="f"||e.key==="F")&&m(s=>!s)},[c.length,o,u]);a.useEffect(()=>(window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)),[g]),a.useEffect(()=>{const e=()=>{m(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),h.current&&h.current.requestFullscreen().catch(s=>{console.log("Auto-fullscreen blocked:",s)}),()=>{document.removeEventListener("fullscreenchange",e),document.fullscreenElement&&document.exitFullscreen().catch(s=>console.log("Exit fullscreen error:",s))}},[]);const[j,p]=a.useState(null),y=e=>{p(e.touches[0].clientX)},E=e=>{if(!j)return;const s=e.changedTouches[0].clientX,w=j-s;Math.abs(w)>50&&(w>0&&l<c.length-1?i(b=>b+1):w<0&&l>0&&i(b=>b-1)),p(null)},C=()=>i(e=>e>0?e-1:e),R=()=>i(e=>e<c.length-1?e+1:e),S=()=>{var e;document.fullscreenElement?document.exitFullscreen().catch(s=>console.log(s)):(e=h.current)==null||e.requestFullscreen().catch(s=>console.log(s))},T=o?"fixed inset-0 z-[100] bg-black":"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4",z=o?"w-full h-full flex items-center justify-center":"w-full max-w-5xl max-h-[80vh] flex items-center justify-center";return t.jsxs("div",{ref:h,className:T,onTouchStart:y,onTouchEnd:E,children:[!o&&t.jsxs("div",{className:"absolute top-4 left-4 right-4 flex items-center justify-between z-10",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-white/70 text-sm",children:[l+1," / ",c.length]}),r.includes(n==null?void 0:n.id)&&t.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-green-500/20 text-green-400 rounded-full text-xs",children:[t.jsx($,{size:12}),f==="ru"?"Просмотрено":"Дида шуд"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:S,className:"p-2 text-white/70 hover:text-white transition-colors rounded-lg hover:bg-white/10",title:"Fullscreen (F)",children:t.jsx(A,{size:20})}),t.jsx("button",{onClick:u,className:"p-2 text-white/70 hover:text-white transition-colors rounded-lg hover:bg-white/10",children:t.jsx(v,{size:24})})]})]}),o&&t.jsx("div",{className:"absolute top-4 right-4 z-10",children:t.jsx("button",{onClick:u,className:"p-2 text-white/50 hover:text-white transition-colors",children:t.jsx(v,{size:24})})}),t.jsx("div",{className:z,children:n&&t.jsx("img",{src:n.imageUrl,alt:f==="tj"&&n.captionTj||n.captionRu,className:o?"max-w-full max-h-full object-contain":"max-w-full max-h-[70vh] object-contain rounded-lg"})}),!o&&n&&(n.captionRu||n.captionTj)&&t.jsx("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 max-w-2xl text-center",children:t.jsx("p",{className:"text-white/90 text-lg bg-black/50 px-6 py-3 rounded-xl backdrop-blur-sm",children:f==="tj"&&n.captionTj||n.captionRu})}),t.jsx("button",{onClick:C,disabled:l===0,className:`absolute left-4 top-1/2 -translate-y-1/2 p-3 rounded-full transition-all ${l===0?"text-white/20 cursor-not-allowed":"text-white/70 hover:text-white hover:bg-white/10"}`,children:t.jsx(_,{size:32})}),t.jsx("button",{onClick:R,disabled:l===c.length-1,className:`absolute right-4 top-1/2 -translate-y-1/2 p-3 rounded-full transition-all ${l===c.length-1?"text-white/20 cursor-not-allowed":"text-white/70 hover:text-white hover:bg-white/10"}`,children:t.jsx(I,{size:32})}),t.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex items-center gap-2",children:c.map((e,s)=>t.jsx("button",{onClick:()=>i(s),className:`w-2 h-2 rounded-full transition-all ${s===l?"bg-white w-4":r.includes(e.id)?"bg-green-500/70 hover:bg-green-500":"bg-white/30 hover:bg-white/50"}`},e.id))}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white/10",children:t.jsx("div",{className:"h-full bg-gaming-primary transition-all duration-300",style:{width:`${(l+1)/c.length*100}%`}})})]})};export{J as default};
