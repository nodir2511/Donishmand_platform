import{u as N,a as v,r as c,S as w,j as e,L as y,A as S,M as L}from"./index-BXdmU-vp.js";import{C as k}from"./CourseLayout-CFtQD9dl.js";import{g as M}from"./progressHelpers-CJ7J7Gvk.js";import{L as C,s as E}from"./syllabusService-ZCJsE0Wq.js";import{A}from"./arrow-left-B3odD4S4.js";import{B as T}from"./file-text-BoruQKcu.js";import"./home-BizFRa69.js";const _=({lang:s,t:B,userRole:h})=>{var u;const{subjectId:r}=N(),l=v(),[m,x]=c.useState(null),[p,d]=c.useState(!0),f=h==="teacher",j=((u=w[r])==null?void 0:u[s])||r;if(c.useEffect(()=>{(async()=>{d(!0);try{const a=await E.getStructure(r);if(a)x(a);else{console.warn(`No structure found in Supabase for ${r}, using Mock data`);const i=L[r];i&&x(i)}}catch(a){console.error("Error fetching subject data:",a)}finally{d(!1)}})()},[r]),p)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gaming-bg",children:e.jsx(C,{size:40,className:"text-gaming-primary animate-spin"})});if(!m)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center text-white bg-gaming-bg",children:[e.jsx("h2",{className:"text-2xl mb-4",children:s==="ru"?"Предмет не найден":"Фан ёфт нашуд"}),e.jsx("button",{onClick:()=>l("/"),className:"text-gaming-primary hover:underline",children:s==="ru"?"На главную":"Ба асосӣ"})]});const b=t=>s==="tj"&&t.titleTj?t.titleTj:t.title;return e.jsx(k,{subjectId:r,lang:s,children:e.jsxs("div",{className:"max-w-5xl",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 text-white",children:j}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsxs("button",{onClick:()=>l("/"),className:"flex items-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-gaming-textMuted hover:text-white transition-all group w-fit",children:[e.jsx(A,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{className:"text-sm font-medium",children:s==="ru"?"На главную":"Ба асосӣ"})]}),e.jsx("p",{className:"text-gaming-textMuted text-lg",children:s==="ru"?"Выберите раздел для изучения":"Барои омӯзиш бахшро интихоб кунед"})]}),e.jsx("div",{className:"space-y-4",children:m.sections.map((t,a)=>{const i=t.topics.flatMap(n=>n.lessons.map(o=>o.id)),g=M(i);return e.jsxs(y,{to:`/subject/${r}/section/${t.id}`,className:"group flex items-center gap-4 bg-gaming-card/40 backdrop-blur-xl border border-white/5 p-5 rounded-2xl hover:border-gaming-primary/50 transition-all duration-300 hover:bg-gaming-card/60",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gaming-primary/10 flex items-center justify-center text-gaming-primary group-hover:scale-110 transition-transform",children:e.jsx(T,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-lg font-bold group-hover:text-gaming-primary transition-colors truncate",children:[a+1,". ",b(t)]}),e.jsxs("p",{className:"text-sm text-gaming-textMuted",children:[t.topics.length," ",s==="ru"?"тем":"мавзӯъ"," • ",t.topics.reduce((n,o)=>n+o.lessons.length,0)," ",s==="ru"?"уроков":"дарс"]})]}),g&&!f&&e.jsxs("div",{className:"mr-2 text-right",children:[e.jsxs("div",{className:"text-xl font-bold text-white leading-none",children:[g.avgErrorRate,"%"]}),e.jsx("div",{className:"text-[10px] text-gaming-textMuted uppercase tracking-wider opacity-70",children:s==="ru"?"ошибок":"хато"})]}),e.jsx(S,{className:"text-white/20 group-hover:text-gaming-primary transition-colors shrink-0"})]},t.id)})})]})})};export{_ as default};
