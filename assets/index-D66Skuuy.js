const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SubjectPage-CE_sDkf9.js","assets/editor-f5jKbLka.js","assets/vendor-DfgOC3sD.js","assets/ui-BCi4cqbw.js","assets/CourseLayout-Dhxaghnf.js","assets/SyllabusContext-fyPBenM0.js","assets/progressHelpers-CJ7J7Gvk.js","assets/supabase-CQnWzhEg.js","assets/SectionPage-IKG3i2eP.js","assets/TopicPage-zrx60W5j.js","assets/LessonPage-BHeghCnm.js","assets/katex-G9EdgA5J.js","assets/CreatorPage-JLn7dRH3.js","assets/useDebounce-DE7P2URC.js","assets/AdminPage-BbBX0an-.js","assets/branchService-lYS7PZw6.js","assets/AuthPage-Dy6LokgU.js","assets/ClassesPage-Q9daPVOr.js","assets/ClassDetailsPage-nGxOhO6n.js","assets/ProfilePage-CIogB2Fw.js","assets/NotFoundPage-C-a0jAnt.js","assets/browser-ponyfill-DPU6vdVN.js"])))=>i.map(i=>d[i]);
import{j as i}from"./editor-f5jKbLka.js";import{a as Me,r as T,u as $e,c as ee,L as C,N as J,R as E,B as Ue,d as ze,e as I}from"./vendor-DfgOC3sD.js";import{c as ve}from"./supabase-CQnWzhEg.js";import{u as z,S as Se,C as He,U as Fe,L as ue,X as Be,M as Xe,A as Ve,a as _e,b as Ne,c as K,d as Ge,G as Qe,e as We,B as Je,f as re,g as Ke,h as qe,i as Ye,j as Ze,k as et,l as tt,m as nt}from"./ui-BCi4cqbw.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();var se={},de=Me;se.createRoot=de.createRoot,se.hydrateRoot=de.hydrateRoot;const rt="modulepreload",st=function(t){return"/Donishmand_platform/"+t},me={},L=function(n,r,e){let o=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));o=Promise.allSettled(r.map(d=>{if(d=st(d),d in me)return;me[d]=!0;const p=d.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":rt,p||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((h,y)=>{m.addEventListener("load",h),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return o.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return n().catch(s)})},Te="https://holeptxxbmpmhlkgzpoa.supabase.co",ke="sb_publishable_p6Y6Ff7daOq0qNRUwD_aWQ_a14jcoFg",O=ve(Te,ke),it={getItem:()=>null,setItem:()=>{},removeItem:()=>{}},gn=ve(Te,ke,{auth:{storageKey:"sb-admin-create-user",storage:it,persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}}),Re=T.createContext({}),te=()=>T.useContext(Re),ot=()=>{Object.keys(localStorage).forEach(t=>{t.startsWith("sb-")&&localStorage.removeItem(t)}),Object.keys(sessionStorage).forEach(t=>{t.startsWith("sb-")&&sessionStorage.removeItem(t)})},at=({children:t})=>{var M;const r=(()=>{try{const f=localStorage.getItem("sb-profile-cache");if(f){let w;try{w=JSON.parse(f)}catch(N){return console.warn("‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–µ—à–∞ –ø—Ä–æ—Ñ–∏–ª—è, –∫–µ—à –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω",N),localStorage.removeItem("sb-profile-cache"),{user:null,profile:null,permissions:[],loading:!0}}if(Date.now()-w.timestamp<864e5)return{user:{id:w.userId},profile:w.profile,permissions:w.permissions||[],loading:!1}}}catch(f){console.error("Error reading initial cache",f)}return{user:null,profile:null,permissions:[],loading:!0}})(),[e,o]=T.useState(r.user),[s,a]=T.useState(r.profile),[l,d]=T.useState(r.permissions),[p,g]=T.useState(r.loading),m=T.useRef(!1),h=T.useRef(((M=r.user)==null?void 0:M.id)||null),y=async f=>{if(!f)return null;const w=(u,S=5e3)=>Promise.race([u,new Promise((x,j)=>setTimeout(()=>j(new Error("TIMEOUT")),S))]),N=async u=>{let S=[];if((u==null?void 0:u.role)==="teacher"){const{data:x}=await O.from("subject_permissions").select("subject_id, can_edit").eq("user_id",f.id);S=x||[]}d(S);try{u&&localStorage.setItem("sb-profile-cache",JSON.stringify({profile:u,permissions:S,userId:f.id,timestamp:Date.now()}))}catch(x){console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–µ—à–∞:",x)}return u};try{try{let{data:u,error:S}=await w(O.rpc("get_my_profile"),5e3);if(u&&u.length>0?u=u[0]:!S&&(!u||u.length===0)&&(u=null),u&&!S)return await N(u)}catch{}try{const{data:u,error:S}=await w(O.from("profiles").select("*").eq("id",f.id).maybeSingle(),1e4);if(u&&!S)return await N(u);S&&console.error("–û—à–∏–±–∫–∞ –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:",S)}catch(u){console.error("–¢–∞–π–º–∞—É—Ç –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:",u)}}catch(u){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è (Global):",u)}return null};T.useEffect(()=>{let f=!0,w=!1;(async()=>{try{const{data:{session:x}}=await O.auth.getSession();if(x!=null&&x.user){h.current===x.user.id||f&&g(!0),f&&(o(x.user),h.current=x.user.id);const _=await y(x.user);f&&a(_)}else f&&(o(null),h.current=null,a(null),d([]))}catch(x){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ auth:",x)}finally{f&&(w=!0,g(!1))}})();const{data:{subscription:u}}=O.auth.onAuthStateChange(async(x,j)=>{if(!m.current&&f){if(x==="SIGNED_OUT")o(null),h.current=null,a(null),d([]),g(!1);else if((x==="SIGNED_IN"||x==="TOKEN_REFRESHED")&&(j==null?void 0:j.user)&&j.user.id!==h.current){if(w&&h.current===j.user.id)return;g(!0),o(j.user),h.current=j.user.id;const H=await y(j.user);f&&(a(H),g(!1))}}}),S=setTimeout(()=>{f&&g(x=>x&&(console.warn("‚ö†Ô∏è –°—Ä–∞–±–æ—Ç–∞–ª–∞ –ª–æ–≥–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞"),!1))},1e4);return()=>{f=!1,u.unsubscribe(),clearTimeout(S)}},[]);const b={user:e,profile:s,permissions:l,loading:p,signOut:async()=>{ot(),o(null),a(null);try{await Promise.race([O.auth.signOut(),new Promise(f=>setTimeout(f,2e3))])}catch(f){console.error("SignOut error (ignored):",f)}window.location.href="/Donishmand_platform/"},updateSelectedSubjects:async f=>{if(!e)return!1;try{const{error:w}=await O.from("profiles").update({selected_subjects:f}).eq("id",e.id);if(w)throw w;a(N=>({...N,selected_subjects:f}));try{const N=localStorage.getItem("sb-profile-cache");if(N){const u=JSON.parse(N);u.profile={...u.profile,selected_subjects:f},localStorage.setItem("sb-profile-cache",JSON.stringify(u))}}catch{}return!0}catch(w){return console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤:",w),!1}},isAuthenticated:!!e,isTeacher:(s==null?void 0:s.role)==="teacher",isAdmin:(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="super_admin",isSuperAdmin:(s==null?void 0:s.role)==="super_admin",setSkipAuthChange:f=>{m.current=f},canEditSubject:f=>(s==null?void 0:s.role)==="super_admin"?!0:(s==null?void 0:s.role)==="teacher"?l.some(w=>w.subject_id===f&&w.can_edit):!1,canViewSubject:f=>(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?!0:(s==null?void 0:s.role)==="teacher"?(s==null?void 0:s.subject)===f:!0};return i.jsx(Re.Provider,{value:b,children:t})},lt=()=>{var N;const{t,i18n:n}=z(),{user:r,profile:e,signOut:o,permissions:s}=te(),a=$e(),l=ee(),[d,p]=T.useState(!1),[g,m]=T.useState(!1),[h,y]=T.useState(!1),c=T.useRef(null);T.useEffect(()=>{const u=()=>m(window.scrollY>20);window.addEventListener("scroll",u);const S=x=>{c.current&&!c.current.contains(x.target)&&y(!1)};return document.addEventListener("mousedown",S),()=>{window.removeEventListener("scroll",u),document.removeEventListener("mousedown",S)}},[]);const v=()=>{const u=n.resolvedLanguage==="ru"?"tj":"ru";n.changeLanguage(u)},b=async()=>{await o(),a("/"),y(!1),p(!1)},M=n.resolvedLanguage||"ru",f=e!=null&&e.full_name?e.full_name.split(" ").map(u=>u[0]).join("").substring(0,2).toUpperCase():((N=r==null?void 0:r.email)==null?void 0:N[0].toUpperCase())||"U",w=u=>{switch(u){case"super_admin":return t("profilePage.roleSuperAdmin");case"admin":return t("profilePage.roleAdmin");case"teacher":return t("profilePage.roleTeacher");default:return t("studentRole")}};return i.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${g?"bg-gaming-bg/80 backdrop-blur-xl border-b border-white/5 py-3":"bg-transparent py-6"}`,children:[i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs(C,{to:"/",className:"flex items-center gap-3 group cursor-pointer",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-gaming-primary to-gaming-pink rounded-xl flex items-center justify-center shadow-lg shadow-gaming-primary/20 group-hover:scale-105 transition-transform duration-300",children:i.jsx(Se,{className:"text-white w-6 h-6"})}),i.jsx("span",{className:"font-bold text-2xl tracking-tight text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-gaming-primary/80 transition-all",children:"Donishmand"})]}),i.jsxs("div",{className:"hidden md:flex items-center bg-white/5 backdrop-blur-md rounded-full border border-white/5 p-1.5 shadow-sm",children:[i.jsxs("button",{onClick:()=>{var u;l.pathname!=="/"?a({pathname:"/",hash:"#courses-section"}):(u=document.getElementById("courses-section"))==null||u.scrollIntoView({behavior:"smooth"})},className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[t("navCourses"),i.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),i.jsxs(C,{to:"/",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[t("navAbout"),i.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),r&&i.jsxs(C,{to:"/classes",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group border-l border-white/10 ml-2 pl-6",children:[(e==null?void 0:e.role)==="student"?"–ú–æ–∏ –∫–ª–∞—Å—Å—ã":"–ö–ª–∞—Å—Å—ã",i.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-purple -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="teacher"&&(s==null?void 0:s.some(u=>u.can_edit)))&&i.jsxs(C,{to:"/creator",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[t("navCreator"),i.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin")&&i.jsxs(C,{to:"/admin",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[t("navAdmin"),i.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-red-500 -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),i.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),i.jsx("button",{onClick:v,className:"px-3 py-1.5 text-xs font-bold bg-white/5 rounded-full text-white hover:bg-gaming-primary hover:text-white transition-colors uppercase ring-1 ring-white/10",children:M})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"hidden md:block",children:r?i.jsxs("div",{className:"relative",ref:c,children:[i.jsxs("button",{onClick:()=>y(!h),className:"flex items-center gap-3 pl-1 pr-3 py-1 bg-white/5 hover:bg-white/10 border border-white/5 rounded-full transition-all group",children:[i.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-gaming-primary to-gaming-purple flex items-center justify-center text-white font-bold text-sm shadow-inner",children:f}),i.jsxs("div",{className:"text-left hidden lg:block",children:[i.jsx("div",{className:"text-xs font-bold text-white leading-none mb-0.5",children:(e==null?void 0:e.full_name)||r.email}),i.jsx("div",{className:"text-[10px] text-gaming-textMuted uppercase tracking-wider leading-none",children:w(e==null?void 0:e.role)})]}),i.jsx(He,{size:14,className:`text-gaming-textMuted transition-transform ${h?"rotate-180":""}`})]}),h&&i.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-gaming-card border border-white/10 rounded-xl shadow-2xl py-2 animate-fade-in-up origin-top-right backdrop-blur-xl",children:[i.jsxs("div",{className:"px-4 py-3 border-b border-white/5 lg:hidden",children:[i.jsx("p",{className:"text-sm font-bold text-white truncate",children:(e==null?void 0:e.full_name)||r.email}),i.jsx("p",{className:"text-xs text-gaming-textMuted mt-0.5 uppercase tracking-wider",children:w(e==null?void 0:e.role)})]}),i.jsxs("div",{className:"py-1",children:[i.jsxs("button",{onClick:()=>{a("/profile"),y(!1)},className:"w-full text-left px-4 py-2.5 text-sm text-gaming-textMuted hover:text-white hover:bg-white/5 flex items-center gap-2 transition-colors",children:[i.jsx(Fe,{size:16}),t("profile")]}),i.jsxs("button",{onClick:b,className:"w-full text-left px-4 py-2.5 text-sm text-red-400 hover:text-red-300 hover:bg-red-500/10 flex items-center gap-2 transition-colors",children:[i.jsx(ue,{size:16}),t("logout")]})]})]})]}):i.jsx(C,{to:"/login",className:"bg-gradient-to-r from-gaming-primary to-gaming-pink text-white px-6 py-2.5 rounded-full font-medium text-sm transition-all shadow-lg shadow-gaming-primary/25 hover:shadow-gaming-pink/25 hover:scale-105 active:scale-95 inline-block",children:t("navLogin")})}),i.jsx("button",{onClick:()=>p(!d),className:"md:hidden p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:d?i.jsx(Be,{}):i.jsx(Xe,{})})]})]})}),d&&i.jsx("div",{className:"absolute top-full left-0 right-0 bg-gaming-card border-b border-white/5 p-4 shadow-xl md:hidden glass-panel",children:i.jsxs("div",{className:"flex flex-col gap-4",children:[r&&i.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white/5 rounded-xl border border-white/5",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gaming-primary to-gaming-purple flex items-center justify-center text-white font-bold shadow-inner",children:f}),i.jsxs("div",{className:"overflow-hidden",children:[i.jsx("div",{className:"font-bold text-white truncate",children:(e==null?void 0:e.full_name)||r.email}),i.jsx("div",{className:"text-xs text-gaming-textMuted uppercase tracking-wider",children:w(e==null?void 0:e.role)})]})]}),i.jsx("button",{onClick:()=>{var u;p(!1),l.pathname!=="/"?a({pathname:"/",hash:"#courses-section"}):(u=document.getElementById("courses-section"))==null||u.scrollIntoView({behavior:"smooth"})},className:"text-left font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:t("navCourses")}),i.jsx(C,{to:"/",onClick:()=>p(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:t("navAbout")}),r&&i.jsx(C,{to:"/classes",onClick:()=>p(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors border-l-2 border-gaming-purple ml-2",children:(e==null?void 0:e.role)==="student"?"–ú–æ–∏ –∫–ª–∞—Å—Å—ã":"–ö–ª–∞—Å—Å—ã"}),((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="teacher"&&(s==null?void 0:s.some(u=>u.can_edit)))&&i.jsx(C,{to:"/creator",onClick:()=>p(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:t("navCreator")}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin")&&i.jsx(C,{to:"/admin",onClick:()=>p(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:t("navAdmin")}),i.jsxs("div",{className:"border-t border-white/5 pt-4 flex items-center justify-between px-4",children:[i.jsx("button",{onClick:v,className:"px-3 py-1 bg-white/5 text-white rounded-md text-xs font-bold uppercase ring-1 ring-white/10",children:M}),r?i.jsxs("button",{onClick:b,className:"text-sm font-medium text-red-400 flex items-center gap-2",children:[i.jsx(ue,{size:16}),t("logout")]}):i.jsx(C,{to:"/login",onClick:()=>p(!1),className:"text-sm font-medium text-gaming-primary",children:t("navLogin")})]})]})})]})},ct=()=>{const{t}=z();return i.jsxs("footer",{className:"relative bg-gaming-bg border-t border-white/5 py-12 mt-20",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gaming-primary/5 to-transparent pointer-events-none"}),i.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center relative z-10",children:i.jsx("p",{className:"text-gaming-textMuted text-sm font-medium",children:t("footerText")})})]})},ut=()=>{const{t}=z();return i.jsxs("div",{className:"relative w-full overflow-hidden pt-36 pb-20 lg:pt-48 lg:pb-32",children:[i.jsx("div",{className:"absolute top-0 right-0 w-[800px] h-[800px] bg-gaming-primary/20 rounded-full blur-[150px] pointer-events-none translate-x-1/3 -translate-y-1/3 animate-pulse-slow"}),i.jsx("div",{className:"absolute bottom-0 left-0 w-[600px] h-[600px] bg-gaming-pink/10 rounded-full blur-[120px] pointer-events-none -translate-x-1/3 translate-y-1/3 animate-pulse-slow"}),i.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center z-10",children:[i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-md shadow-sm text-gaming-accent text-sm font-medium mb-8 animate-fade-in-up",children:[i.jsx(Se,{size:16,className:"text-gaming-gold"}),i.jsx("span",{className:"tracking-wide uppercase text-[11px] font-bold",children:t("badge")})]}),i.jsx("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight leading-[1.1] animate-fade-in-up delay-[100ms] drop-shadow-2xl",children:i.jsx("span",{dangerouslySetInnerHTML:{__html:t("heroTitle")}})}),i.jsx("p",{className:"text-lg md:text-xl text-gaming-textMuted mb-12 max-w-2xl mx-auto leading-relaxed animate-fade-in-up delay-[200ms]",children:t("heroSubtitle")}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center items-center w-full animate-fade-in-up delay-[300ms]",children:[i.jsxs("button",{onClick:()=>{var n;return(n=document.getElementById("courses-section"))==null?void 0:n.scrollIntoView({behavior:"smooth"})},className:"group relative bg-gaming-primary hover:bg-gaming-primary/90 text-white px-8 py-4 rounded-2xl font-bold transition-all active:scale-95 shadow-lg shadow-gaming-primary/25 flex items-center justify-center gap-2 text-lg overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),i.jsx("span",{children:t("ctaStart")}),i.jsx(Ve,{size:20,className:"text-gaming-gold group-hover:translate-x-1 transition-transform"})]}),i.jsx("button",{onClick:()=>{var n;return(n=document.getElementById("courses-section"))==null?void 0:n.scrollIntoView({behavior:"smooth"})},className:"group bg-transparent hover:bg-white/5 text-white border border-white/10 px-8 py-4 rounded-2xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 text-lg backdrop-blur-sm",children:t("ctaCatalog")})]}),i.jsx("div",{className:"absolute top-1/2 left-10 hidden lg:block animate-float opacity-30",children:i.jsx(_e,{size:80,className:"text-gaming-accent rotate-12 drop-shadow-[0_0_15px_rgba(0,224,255,0.5)]"})}),i.jsx("div",{className:"absolute top-1/3 right-10 hidden lg:block animate-float opacity-30",style:{animationDelay:"2s"},children:i.jsx(Ne,{size:80,className:"text-gaming-pink -rotate-12 drop-shadow-[0_0_15px_rgba(255,73,219,0.5)]"})})]})]})},ae={"tj-lang":{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:re},lit:{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:re},math:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:_e},phys:{color:"text-gaming-accent",bg:"bg-gaming-accent/10",icon:Ne},chem:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:Je},bio:{color:"text-gaming-gold",bg:"bg-gaming-gold/10",icon:We},geo:{color:"text-gaming-gold",bg:"bg-gaming-gold/10",icon:Qe},hist:{color:"text-gaming-text",bg:"bg-gaming-text/10",icon:Ge},eng:{color:"text-gaming-accent",bg:"bg-gaming-accent/10",icon:K},ger:{color:"text-gaming-text",bg:"bg-gaming-text/10",icon:K},fra:{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:K},ara:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:K}},Oe={"tj-lang":{ru:"–¢–∞–¥–∂–∏–∫—Å–∫–∏–π —è–∑—ã–∫",tj:"–ó–∞–±–æ–Ω–∏ –¢–æ“∑–∏–∫”£"},math:{ru:"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",tj:"–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"},phys:{ru:"–§–∏–∑–∏–∫–∞",tj:"–§–∏–∑–∏–∫–∞"},chem:{ru:"–•–∏–º–∏—è",tj:"–•–∏–º–∏—è"},geo:{ru:"–ì–µ–æ–≥—Ä–∞—Ñ–∏—è",tj:"–ì–µ–æ–≥—Ä–∞—Ñ–∏—è"},hist:{ru:"–ò—Å—Ç–æ—Ä–∏—è",tj:"–¢–∞—ä—Ä–∏—Ö"},lit:{ru:"–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",tj:"–ê–¥–∞–±–∏—ë—Ç"},bio:{ru:"–ë–∏–æ–ª–æ–≥–∏—è",tj:"–ë–∏–æ–ª–æ–≥–∏—è"},eng:{ru:"–ê–Ω–≥–ª–∏–π—Å–∫–∏–π",tj:"–ó–∞–±–æ–Ω–∏ –ê–Ω–≥–ª–∏—Å”£"},ger:{ru:"–ù–µ–º–µ—Ü–∫–∏–π",tj:"–ó–∞–±–æ–Ω–∏ –ù–µ–º–∏—Å”£"},fra:{ru:"–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π",tj:"–ó–∞–±–æ–Ω–∏ –§—Ä–∞–Ω—Å–∞–≤”£"},ara:{ru:"–ê—Ä–∞–±—Å–∫–∏–π",tj:"–ó–∞–±–æ–Ω–∏ –ê—Ä–∞–±”£"}},q=[{id:1,titleRu:"–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏ —Ç–µ—Ö.",titleTj:"–¢–∞–±–∏”£ –≤–∞ —Ç–µ—Ö–Ω–∏–∫”£",subjects:["tj-lang","math","phys","chem"]},{id:2,titleRu:"–≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –ì–µ–æ.",titleTj:"–ò“õ—Ç–∏—Å–æ–¥ –≤–∞ –ì–µ–æ–≥—Ä–∞—Ñ–∏—è",subjects:["tj-lang","math","geo","eng","fra","ger","ara"]},{id:3,titleRu:"–§–∏–ª–æ–ª–æ–≥–∏—è –∏ –ò—Å–∫—É—Å—Å—Ç–≤–æ",titleTj:"–§–∏–ª–æ–ª–æ–≥–∏—è –≤–∞ –°–∞–Ω—ä–∞—Ç",subjects:["tj-lang","hist","lit","eng","fra","ger","ara"]},{id:4,titleRu:"–û–±—â–µ—Å—Ç–≤–æ –∏ –ü—Ä–∞–≤–æ",titleTj:"“∂–æ–º–µ–∞—à–∏–Ω–æ—Å”£ –≤–∞ “≤—É“õ—É“õ",subjects:["tj-lang","hist","eng","fra","ger","ara"]},{id:5,titleRu:"–ú–µ–¥–∏—Ü–∏–Ω–∞ –∏ –ë–∏–æ–ª–æ–≥–∏—è",titleTj:"–¢–∏–± –≤–∞ –ë–∏–æ–ª–æ–≥–∏—è",subjects:["tj-lang","bio","chem","phys"]}],Y=Object.keys(ae),dt=({subjectId:t,progress:n=0})=>{const{i18n:r}=z(),e=r.resolvedLanguage||"ru",o=ae[t],s=Oe[t][e],a=o.icon;return i.jsxs(C,{to:`/subject/${t}`,className:"block group relative bg-gaming-card rounded-3xl p-6 border border-white/5 hover:border-gaming-primary/30 shadow-lg shadow-black/20 hover:shadow-gaming-primary/10 transition-all duration-500 hover:-translate-y-2 cursor-pointer overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gaming-primary/0 via-gaming-primary/0 to-gaming-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),i.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-6",children:[i.jsx("div",{className:`w-14 h-14 rounded-2xl ${o.bg} flex items-center justify-center group-hover:scale-110 transition-transform duration-300 ring-1 ring-white/5`,children:i.jsx(a,{size:28,className:o.color})}),i.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-white/40 group-hover:bg-gaming-primary group-hover:text-white transition-all duration-300",children:i.jsx(Ke,{size:16})})]}),i.jsx("h3",{className:"relative z-10 text-xl font-bold text-white mb-4 leading-tight group-hover:text-gaming-accent transition-colors",children:s}),i.jsxs("div",{className:"relative z-10",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[i.jsx("span",{className:"text-xs text-gaming-textMuted",children:n>0?"–ü—Ä–æ–≥—Ä–µ—Å—Å":""}),n>0&&i.jsxs("span",{className:"text-xs font-bold text-gaming-primary",children:[n,"%"]})]}),i.jsx("div",{className:"w-full h-1.5 bg-white/5 rounded-full overflow-hidden",children:i.jsx("div",{className:"h-full bg-gradient-to-r from-gaming-primary to-gaming-pink rounded-full transition-all duration-1000 ease-out",style:{width:`${n}%`}})})]})]})},mt=({activeClusterId:t,setActiveClusterId:n})=>{const{t:r,i18n:e}=z(),o=e.resolvedLanguage||"ru";return i.jsx("div",{id:"courses-section",className:"sticky top-20 z-30 transition-all mt-8",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4",children:i.jsx("div",{className:"glass-panel rounded-2xl p-2 overflow-x-auto no-scrollbar",children:i.jsxs("div",{className:"flex space-x-1 min-w-max",children:[i.jsxs("button",{onClick:()=>n(0),className:`
                px-4 py-2.5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 border
                ${t===0?"bg-gaming-card border-gaming-primary/50 text-white shadow-lg shadow-gaming-primary/10":"border-transparent text-gaming-textMuted hover:text-white hover:bg-white/5"}
              `,children:[i.jsx(qe,{size:18,className:t===0?"text-gaming-accent":""}),r("allSubjects")]}),i.jsx("div",{className:"w-px h-8 bg-white/10 mx-2 self-center"}),q.map(s=>i.jsxs("button",{onClick:()=>n(s.id),className:`
                  px-4 py-2.5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 border
                  ${t===s.id?"bg-gaming-card border-gaming-primary/50 text-white shadow-lg shadow-gaming-primary/10":"border-transparent text-gaming-textMuted hover:text-white hover:bg-white/5"}
                `,children:[i.jsx("span",{className:`
                  flex items-center justify-center w-5 h-5 rounded-md text-[10px] font-bold transition-colors
                  ${t===s.id?"bg-gaming-primary text-white":"bg-white/10 text-white/50"}
                `,children:s.id}),o==="ru"?s.titleRu:s.titleTj]},s.id))]})})})})},gt=()=>{const{i18n:t}=z(),{updateSelectedSubjects:n,profile:r}=te(),[e,o]=T.useState([]),[s,a]=T.useState(!1),l=t.resolvedLanguage||"ru",d=g=>{o(m=>m.includes(g)?m.filter(h=>h!==g):[...m,g])},p=async()=>{e.length!==0&&(a(!0),await n(e),a(!1))};return i.jsxs("div",{className:"min-h-[80vh] flex flex-col items-center justify-center p-6 text-center animate-fade-in",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-gaming-primary/20 flex items-center justify-center mb-6 ring-2 ring-gaming-primary/50 shadow-lg shadow-gaming-primary/30",children:i.jsx(re,{className:"text-gaming-primary w-8 h-8"})}),i.jsxs("h1",{className:"text-4xl md:text-5xl font-heading font-bold text-white mb-4 drop-shadow-lg",children:["–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ",(r==null?void 0:r.full_name)||"–£—á–µ–Ω–∏–∫","!"]}),i.jsx("p",{className:"text-xl text-gray-300 mb-12 max-w-2xl",children:"–î–∞–≤–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–¥ –≤–∞—Å. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏–∑—É—á–∞—Ç—å:"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full max-w-5xl mb-12",children:Y.map(g=>{var c;const m=ae[g];if(!m)return null;const h=m.icon,y=e.includes(g);return i.jsxs("div",{onClick:()=>d(g),className:`relative cursor-pointer rounded-2xl p-6 flex flex-col items-center gap-4 transition-all duration-300 border-2
                                ${y?"bg-gaming-card/80 border-gaming-primary shadow-lg shadow-gaming-primary/20 scale-105":"bg-black/30 border-white/5 hover:bg-white/5 hover:border-white/20"}
                            `,children:[i.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-transform ${y?"scale-110":""} ${m.bg}`,children:i.jsx(h,{size:28,className:m.color})}),i.jsx("span",{className:"font-medium text-white text-center",children:((c=Oe[g])==null?void 0:c[l])||g}),i.jsx("div",{className:`absolute top-4 right-4 transition-all duration-300 ${y?"opacity-100 transform scale-100":"opacity-0 transform scale-50"}`,children:i.jsx(Ye,{className:"text-gaming-primary w-6 h-6"})})]},g)})}),i.jsx("button",{onClick:p,disabled:e.length===0||s,className:`
                    px-12 py-4 rounded-xl font-bold text-lg flex items-center gap-3 transition-all duration-300 shadow-xl
                    ${e.length>0?"bg-gaming-primary text-white hover:bg-gaming-primary-hover hover:scale-105 shadow-gaming-primary/30":"bg-white/5 text-gray-500 cursor-not-allowed border border-white/5"}
                `,children:s?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..."]}):i.jsxs(i.Fragment,{children:["–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ",i.jsx(Ze,{size:20})]})}),i.jsx("p",{className:"mt-4 text-sm text-gray-500 max-w-md",children:"–í –±—É–¥—É—â–µ–º –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞."})]})},ft=t=>{var o,s,a,l,d,p,g;if(!t)return{contentRu:null,contentTj:null};const n=m=>{if(!m||!Array.isArray(m))return{ru:[],tj:[]};const h=m.map(c=>{const v={id:c.id,type:c.type,image:c.imageRu||c.image};return v.text=c.textRu||"",c.type==="multiple_choice"?(v.options=(c.options||[]).map(b=>({id:b.id,text:b.textRu||"",image:b.imageRu||b.image})),v.correctId=c.correctId):c.type==="matching"?(v.leftItems=(c.leftItems||[]).map(b=>({id:b.id,text:b.textRu||"",image:b.imageRu||b.image})),v.rightItems=(c.rightItems||[]).map(b=>({id:b.id,text:b.textRu||"",image:b.imageRu||b.image})),v.correctMatches=c.correctMatches):c.type==="numeric"&&(v.digits=c.digits,v.unit=c.unit),v}),y=m.map(c=>{const v={id:c.id,type:c.type,image:c.imageTj||c.imageRu||c.image};return v.text=c.textTj||"",c.type==="multiple_choice"?(v.options=(c.options||[]).map(b=>({id:b.id,text:b.textTj||"",image:b.imageTj||b.imageRu||b.image})),v.correctId=c.correctId):c.type==="matching"?(v.leftItems=(c.leftItems||[]).map(b=>({id:b.id,text:b.textTj||"",image:b.imageTj||b.imageRu||b.image})),v.rightItems=(c.rightItems||[]).map(b=>({id:b.id,text:b.textTj||"",image:b.imageTj||b.imageRu||b.image})),v.correctMatches=c.correctMatches):c.type==="numeric"&&(v.digits=c.digits,v.unit=c.unit),v});return{ru:h,tj:y}},{ru:r,tj:e}=n((o=t.test)==null?void 0:o.questions);return{contentRu:{video:{url:((s=t.video)==null?void 0:s.url)||"",description:((a=t.video)==null?void 0:a.descriptionRu)||""},text:{body:((l=t.text)==null?void 0:l.bodyRu)||""},test:{questions:r},slides:t.slidesRu||[]},contentTj:{video:{url:((d=t.video)==null?void 0:d.urlTj)||"",description:((p=t.video)==null?void 0:p.descriptionTj)||""},text:{body:((g=t.text)==null?void 0:g.bodyTj)||""},test:{questions:e},slides:t.slidesTj||[]}}},ht=(t,n)=>{var p,g,m,h,y,c,v,b,M,f,w,N;const r=u=>u?u.toString().replace(/<[^>]*>?/gm,"").replace(/&nbsp;/g," ").trim():"",e=u=>{const S=r(u);return S!==""&&/^\d+$/.test(S)},o=u=>{if(!u)return"";const S=[u.question,u.text,u.title];for(const x of S)if(x&&!e(x))return x;return""},s=u=>!u||!Array.isArray(u)?u:u.map(S=>{const x={...S};if(x.textRu||(x.textRu=o(S)),!x.textTj){const j=[S.textTj,S.question,S.text,S.title];for(const _ of j)if(_&&!e(_)&&_!==x.textRu){x.textTj=_;break}}return x.options&&(x.options=x.options.map(j=>({...j,textRu:j.textRu?j.textRu:o(j),textTj:j.textTj||""}))),x.leftItems&&(x.leftItems=x.leftItems.map(j=>({...j,textRu:j.textRu?j.textRu:o(j),textTj:j.textTj||""}))),x.rightItems&&(x.rightItems=x.rightItems.map(j=>({...j,textRu:j.textRu?j.textRu:o(j),textTj:j.textTj||""}))),x});if(t&&(t.slidesRu||(p=t.text)!=null&&p.bodyRu))return(g=t.test)!=null&&g.questions?{...t,test:{...t.test,questions:s(t.test.questions)}}:t;const a=t||{},l=n||{};console.log("[DEBUG mergeContent] ru.test?.questions:",JSON.stringify((m=a.test)==null?void 0:m.questions,null,2)),console.log("[DEBUG mergeContent] tj.test?.questions:",JSON.stringify((h=l.test)==null?void 0:h.questions,null,2));const d=(u,S)=>{const x=u||[],j=S||[];return x.map((_,H)=>{const P=j[H]||{},k={id:_.id,type:_.type,imageRu:_.image,imageTj:P.image,textRu:_.text||"",textTj:P.text||""};return _.type==="multiple_choice"?(k.options=(_.options||[]).map((R,$)=>{var D;const A=((D=P.options)==null?void 0:D[$])||{};return{id:R.id,imageRu:R.image,imageTj:A.image,textRu:R.text||"",textTj:A.text||""}}),k.correctId=_.correctId):_.type==="matching"?(k.leftItems=(_.leftItems||[]).map((R,$)=>{var D;const A=((D=P.leftItems)==null?void 0:D[$])||{};return{id:R.id,imageRu:R.image,imageTj:A.image,textRu:R.text||"",textTj:A.text||""}}),k.rightItems=(_.rightItems||[]).map((R,$)=>{var D;const A=((D=P.rightItems)==null?void 0:D[$])||{};return{id:R.id,imageRu:R.image,imageTj:A.image,textRu:R.text||"",textTj:A.text||""}}),k.correctMatches=_.correctMatches):_.type==="numeric"&&(k.digits=_.digits,k.unit=_.unit),k})};return{video:{url:((y=a.video)==null?void 0:y.url)||"",urlTj:((c=l.video)==null?void 0:c.url)||"",descriptionRu:((v=a.video)==null?void 0:v.description)||"",descriptionTj:((b=l.video)==null?void 0:b.description)||""},text:{bodyRu:((M=a.text)==null?void 0:M.body)||"",bodyTj:((f=l.text)==null?void 0:f.body)||""},test:{questions:d((w=a.test)==null?void 0:w.questions,(N=l.test)==null?void 0:N.questions)},slidesRu:a.slides||[],slidesTj:l.slides||[]}},B={structures:{},lessons:{}},pt={invalidateCache(t){t?delete B.structures[t]:(B.structures={},B.lessons={})},async saveStructure(t,n){const r=n.sections.map(o=>({id:o.id,title:o.title,titleTj:o.titleTj,topics:o.topics.map(s=>({id:s.id,title:s.title,titleTj:s.titleTj,lessons:s.lessons.map(a=>({id:a.id,title:a.title,titleTj:a.titleTj,type:a.type}))}))})),{error:e}=await O.from("subject_syllabus").upsert({subject:t,data:{sections:r},updated_at:new Date},{onConflict:"subject"});if(e)throw console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:",e),e;return!0},async getStructure(t){if(!t||t==="undefined"||t==="null")return null;if(B.structures[t])return B.structures[t];const{data:n,error:r}=await O.from("subject_syllabus").select("data").eq("subject",t).maybeSingle();if(r)throw r;return n?(B.structures[t]=n.data,n.data):null},async saveLesson(t,n){const{contentRu:r,contentTj:e}=ft(t.content),o=l=>Array.isArray(l)?l.map(o):l instanceof Date?l:l!==null&&typeof l=="object"?Object.fromEntries(Object.entries(l).filter(([d,p])=>p!==void 0).map(([d,p])=>[d,o(p)])):l,s=o({id:t.id,title_ru:t.title,title_tj:t.titleTj,subject:n,content_ru:r,content_tj:e,is_published:!0,updated_at:new Date}),{error:a}=await O.from("lessons").upsert(s,{onConflict:"id"});if(a)throw a;return!0},async deleteLesson(t){const{error:n}=await O.from("lessons").delete().eq("id",t);if(n)throw n;return!0},async deleteLessons(t){if(!t||t.length===0)return!0;const{error:n}=await O.from("lessons").delete().in("id",t);if(n)throw n;return!0},async getLesson(t,n=null){var a;const r=n==="ru"?"id, title_ru, title_tj, subject, content_ru":n==="tj"?"id, title_ru, title_tj, subject, content_tj":"*",{data:e,error:o}=await O.from("lessons").select(r).eq("id",t).single();if(o){if(o.code==="PGRST116")return null;throw o}let s;if(n){const l=n==="ru"?e.content_ru:e.content_tj;l&&(l.slidesRu||(a=l.text)!=null&&a.bodyRu)?s=l:s=xt(l,n)}else s=ht(e.content_ru,e.content_tj);return{id:e.id,title:e.title_ru,titleTj:e.title_tj,content:s,subject:e.subject}}},xt=(t,n)=>{var o,s,a,l,d,p,g;if(!t)return{video:{url:"",urlTj:"",descriptionRu:"",descriptionTj:""},text:{bodyRu:"",bodyTj:""},test:{questions:[]},slidesRu:[],slidesTj:[]};const r=n==="ru",e=m=>(m||[]).map(h=>{const y={id:h.id,type:h.type,imageRu:r&&h.image||null,imageTj:r?null:h.image||null,textRu:r&&h.text||"",textTj:r?"":h.text||""};return h.type==="multiple_choice"?(y.options=(h.options||[]).map(c=>({id:c.id,imageRu:r&&c.image||null,imageTj:r?null:c.image||null,textRu:r&&c.text||"",textTj:r?"":c.text||""})),y.correctId=h.correctId):h.type==="matching"?(y.leftItems=(h.leftItems||[]).map(c=>({id:c.id,imageRu:r&&c.image||null,imageTj:r?null:c.image||null,textRu:r&&c.text||"",textTj:r?"":c.text||""})),y.rightItems=(h.rightItems||[]).map(c=>({id:c.id,imageRu:r&&c.image||null,imageTj:r?null:c.image||null,textRu:r&&c.text||"",textTj:r?"":c.text||""})),y.correctMatches=h.correctMatches):h.type==="numeric"&&(y.digits=h.digits,y.unit=h.unit),y});return{video:{url:r&&((o=t.video)==null?void 0:o.url)||"",urlTj:r?"":((s=t.video)==null?void 0:s.url)||"",descriptionRu:r&&((a=t.video)==null?void 0:a.description)||"",descriptionTj:r?"":((l=t.video)==null?void 0:l.description)||""},text:{bodyRu:r&&((d=t.text)==null?void 0:d.body)||"",bodyTj:r?"":((p=t.text)==null?void 0:p.body)||""},test:{questions:e((g=t.test)==null?void 0:g.questions)},slidesRu:r?t.slides||[]:[],slidesTj:r?[]:t.slides||[]}},bt=()=>{const{t,i18n:n}=z(),[r,e]=T.useState(0),o=n.resolvedLanguage||"ru",{profile:s}=te(),a=ee(),[l,d]=T.useState({});T.useEffect(()=>{a.hash==="#courses-section"&&setTimeout(()=>{var f;(f=document.getElementById("courses-section"))==null||f.scrollIntoView({behavior:"smooth"})},100)},[a]),T.useEffect(()=>{if(!s)return;(async()=>{var w;try{const{data:{user:N}}=await O.auth.getUser();if(!(N!=null&&N.id))return;const{data:u,error:S}=await O.from("user_lesson_progress").select("lesson_id").eq("user_id",N.id),{data:x,error:j}=await O.from("user_test_results").select("lesson_id").eq("user_id",N.id);S&&console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ lesson_progress:",S),j&&console.warn("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ test_results:",j);const _=new Set;if(u&&u.forEach(P=>_.add(P.lesson_id)),x&&x.forEach(P=>_.add(P.lesson_id)),console.log(`üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: –Ω–∞–π–¥–µ–Ω–æ ${_.size} —É—Ä–æ–∫–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é`),console.log("üìä ID —É—Ä–æ–∫–æ–≤:",[..._]),_.size===0)return;const H={};for(const P of Y)try{const k=await pt.getStructure(P);if(console.log(`üìä ${P}: structure =`,k?"OK":"null","sections:",((w=k==null?void 0:k.sections)==null?void 0:w.length)||0),!(k!=null&&k.sections))continue;let R=0,$=0;const A=[];for(const D of k.sections)if(D.topics){for(const le of D.topics)if(le.lessons)for(const ce of le.lessons)R++,A.push(ce.id),_.has(ce.id)&&$++}console.log(`üìä ${P}: ${$}/${R} —É—Ä–æ–∫–æ–≤, IDs:`,A.slice(0,3)),R>0&&(H[P]=Math.round($/R*100))}catch(k){console.error(`üìä –û—à–∏–±–∫–∞ –¥–ª—è ${P}:`,k)}console.log("üìä –ò—Ç–æ–≥–æ–≤—ã–π progressMap:",H),d(H)}catch(N){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:",N)}})()},[s]);const g=(()=>{if((s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"){if(r===0)return Y;const w=q.find(N=>N.id===r);return w?w.subjects:[]}if((s==null?void 0:s.role)==="teacher"&&(s!=null&&s.subject))return[s.subject];if(s!=null&&s.selected_subjects&&s.selected_subjects.length>0)return s.selected_subjects;if(r===0)return Y;const f=q.find(w=>w.id===r);return f?f.subjects:[]})(),m=(s==null?void 0:s.role)==="student"||!(s!=null&&s.role),h=(s==null?void 0:s.selected_subjects)&&s.selected_subjects.length>0,y=(s==null?void 0:s.role)==="teacher";(s==null?void 0:s.role)==="admin"||(s==null||s.role);const c=!s,v=()=>{if(y&&(s!=null&&s.subject))return t("allSubjects");if(m&&h)return"–ú–æ–∏ –ø—Ä–µ–¥–º–µ—Ç—ã";if(r===0)return t("allSubjects");const f=q.find(w=>w.id===r);return`${t("cluster")} ${r}: ${o==="ru"?f==null?void 0:f.titleRu:f==null?void 0:f.titleTj}`},b=c,M=c;return!c&&m&&!h?i.jsx("main",{className:"relative",children:i.jsx(gt,{})}):i.jsxs("main",{className:"relative",children:[M&&i.jsx(ut,{}),b&&i.jsx(mt,{activeClusterId:r,setActiveClusterId:e}),i.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 min-h-[600px] mt-10",children:[i.jsx("div",{className:"flex items-end justify-between mb-8 px-2",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-bold text-white tracking-tight drop-shadow-lg",children:v()}),i.jsx("p",{className:"text-gaming-textMuted mt-2 text-lg",children:t("popularSubtitle")})]})}),g.length>0?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 animate-fade-in-up",children:g.map((f,w)=>i.jsx(dt,{subjectId:f,progress:l[f]||0},`${r}-${f}-${w}`))}):i.jsx("div",{className:"text-center py-20 bg-white/5 rounded-3xl border border-white/10",children:i.jsx("p",{className:"text-white/60 text-lg",children:"–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤"})})]})]})},Q=({children:t,requireTeacher:n=!1,requireAdmin:r=!1,requireSuperAdmin:e=!1})=>{const{user:o,profile:s,loading:a}=te(),l=ee();return a?i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gaming-bg",children:i.jsx(et,{size:40,className:"text-gaming-primary animate-spin"})}):o?e&&(s==null?void 0:s.role)!=="super_admin"?i.jsx(J,{to:"/",replace:!0}):r&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="super_admin"?i.jsx(J,{to:"/",replace:!0}):n&&(s==null?void 0:s.role)!=="teacher"&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="super_admin"?i.jsx(J,{to:"/",replace:!0}):t:i.jsx(J,{to:"/login",state:{from:l},replace:!0})},yt=E.lazy(()=>L(()=>import("./SubjectPage-CE_sDkf9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),wt=E.lazy(()=>L(()=>import("./SectionPage-IKG3i2eP.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),jt=E.lazy(()=>L(()=>import("./TopicPage-zrx60W5j.js"),__vite__mapDeps([9,1,2,3,4,5,6,7]))),vt=E.lazy(()=>L(()=>import("./LessonPage-BHeghCnm.js").then(t=>t.L),__vite__mapDeps([10,1,2,3,4,5,11]))),St=E.lazy(()=>L(()=>import("./CreatorPage-JLn7dRH3.js").then(t=>t.C),__vite__mapDeps([12,1,2,3,5,13]))),_t=E.lazy(()=>L(()=>import("./AdminPage-BbBX0an-.js"),__vite__mapDeps([14,1,2,3,15,13,7]))),Nt=E.lazy(()=>L(()=>import("./AuthPage-Dy6LokgU.js"),__vite__mapDeps([16,1,2,3,7]))),Tt=E.lazy(()=>L(()=>import("./ClassesPage-Q9daPVOr.js"),__vite__mapDeps([17,1,2,3,15,7]))),kt=E.lazy(()=>L(()=>import("./ClassDetailsPage-nGxOhO6n.js"),__vite__mapDeps([18,1,2,3,15,13,7]))),Rt=E.lazy(()=>L(()=>import("./ProfilePage-CIogB2Fw.js"),__vite__mapDeps([19,1,2,3,7]))),Ot=E.lazy(()=>L(()=>import("./NotFoundPage-C-a0jAnt.js"),__vite__mapDeps([20,1,2,3]))),Pt=()=>i.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gaming-primary/30 border-t-gaming-primary rounded-full animate-spin"}),i.jsx("span",{className:"text-gaming-textMuted text-sm",children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})]})});function Et(){const{i18n:t}=z(),n=ee();return E.useEffect(()=>{window.scrollTo(0,0)},[n.pathname]),i.jsxs("div",{className:"min-h-screen bg-gaming-bg font-sans text-white selection:bg-gaming-pink/30 selection:text-white overflow-hidden flex flex-col",children:[i.jsx(lt,{}),i.jsx("main",{className:"flex-grow pt-24",children:i.jsx(T.Suspense,{fallback:i.jsx(Pt,{}),children:i.jsxs(ze,{children:[i.jsx(I,{path:"/",element:i.jsx(bt,{})}),i.jsx(I,{path:"/subject/:subjectId",element:i.jsx(yt,{})}),i.jsx(I,{path:"/subject/:subjectId/section/:sectionId",element:i.jsx(wt,{})}),i.jsx(I,{path:"/subject/:subjectId/section/:sectionId/topic/:topicId",element:i.jsx(jt,{})}),i.jsx(I,{path:"/lesson/:lessonId",element:i.jsx(vt,{})}),i.jsx(I,{path:"/creator",element:i.jsx(Q,{allowedRoles:["teacher","admin","super_admin"],children:i.jsx(St,{})})}),i.jsx(I,{path:"/admin",element:i.jsx(Q,{allowedRoles:["admin","super_admin"],children:i.jsx(_t,{})})}),i.jsx(I,{path:"/classes",element:i.jsx(Q,{children:i.jsx(Tt,{})})}),i.jsx(I,{path:"/classes/:classId",element:i.jsx(Q,{children:i.jsx(kt,{})})}),i.jsx(I,{path:"/login",element:i.jsx(Nt,{})}),i.jsx(I,{path:"/profile",element:i.jsx(Q,{children:i.jsx(Rt,{})})}),i.jsx(I,{path:"*",element:i.jsx(Ot,{})})]})})}),i.jsx(ct,{})]})}function It(){return i.jsx(at,{children:i.jsx(Ue,{basename:"/Donishmand_platform/",children:i.jsx(Et,{})})})}const{slice:Ct,forEach:Lt}=[];function At(t){return Lt.call(Ct.call(arguments,1),n=>{if(n)for(const r in n)t[r]===void 0&&(t[r]=n[r])}),t}function Dt(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(t))}const ge=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,Mt=function(t,n){const e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},o=encodeURIComponent(n);let s=`${t}=${o}`;if(e.maxAge>0){const a=e.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(a)}`}if(e.domain){if(!ge.test(e.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${e.domain}`}if(e.path){if(!ge.test(e.path))throw new TypeError("option path is invalid");s+=`; Path=${e.path}`}if(e.expires){if(typeof e.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${e.expires.toUTCString()}`}if(e.httpOnly&&(s+="; HttpOnly"),e.secure&&(s+="; Secure"),e.sameSite)switch(typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return e.partitioned&&(s+="; Partitioned"),s},fe={create(t,n,r,e){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(o.expires=new Date,o.expires.setTime(o.expires.getTime()+r*60*1e3)),e&&(o.domain=e),document.cookie=Mt(t,n,o)},read(t){const n=`${t}=`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){let o=r[e];for(;o.charAt(0)===" ";)o=o.substring(1,o.length);if(o.indexOf(n)===0)return o.substring(n.length,o.length)}return null},remove(t,n){this.create(t,"",-1,n)}};var $t={name:"cookie",lookup(t){let{lookupCookie:n}=t;if(n&&typeof document<"u")return fe.read(n)||void 0},cacheUserLanguage(t,n){let{lookupCookie:r,cookieMinutes:e,cookieDomain:o,cookieOptions:s}=n;r&&typeof document<"u"&&fe.create(r,t,e,o,s)}},Ut={name:"querystring",lookup(t){var e;let{lookupQuerystring:n}=t,r;if(typeof window<"u"){let{search:o}=window.location;!window.location.search&&((e=window.location.hash)==null?void 0:e.indexOf("?"))>-1&&(o=window.location.hash.substring(window.location.hash.indexOf("?")));const a=o.substring(1).split("&");for(let l=0;l<a.length;l++){const d=a[l].indexOf("=");d>0&&a[l].substring(0,d)===n&&(r=a[l].substring(d+1))}}return r}},zt={name:"hash",lookup(t){var o;let{lookupHash:n,lookupFromHashIndex:r}=t,e;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const a=s.substring(1);if(n){const l=a.split("&");for(let d=0;d<l.length;d++){const p=l[d].indexOf("=");p>0&&l[d].substring(0,p)===n&&(e=l[d].substring(p+1))}}if(e)return e;if(!e&&r>-1){const l=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(o=l[typeof r=="number"?r:0])==null?void 0:o.replace("/",""):void 0}}}return e}};let X=null;const he=()=>{if(X!==null)return X;try{if(X=typeof window<"u"&&window.localStorage!==null,!X)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{X=!1}return X};var Ht={name:"localStorage",lookup(t){let{lookupLocalStorage:n}=t;if(n&&he())return window.localStorage.getItem(n)||void 0},cacheUserLanguage(t,n){let{lookupLocalStorage:r}=n;r&&he()&&window.localStorage.setItem(r,t)}};let V=null;const pe=()=>{if(V!==null)return V;try{if(V=typeof window<"u"&&window.sessionStorage!==null,!V)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{V=!1}return V};var Ft={name:"sessionStorage",lookup(t){let{lookupSessionStorage:n}=t;if(n&&pe())return window.sessionStorage.getItem(n)||void 0},cacheUserLanguage(t,n){let{lookupSessionStorage:r}=n;r&&pe()&&window.sessionStorage.setItem(r,t)}},Bt={name:"navigator",lookup(t){const n=[];if(typeof navigator<"u"){const{languages:r,userLanguage:e,language:o}=navigator;if(r)for(let s=0;s<r.length;s++)n.push(r[s]);e&&n.push(e),o&&n.push(o)}return n.length>0?n:void 0}},Xt={name:"htmlTag",lookup(t){let{htmlTag:n}=t,r;const e=n||(typeof document<"u"?document.documentElement:null);return e&&typeof e.getAttribute=="function"&&(r=e.getAttribute("lang")),r}},Vt={name:"path",lookup(t){var o;let{lookupFromPathIndex:n}=t;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?(o=r[typeof n=="number"?n:0])==null?void 0:o.replace("/",""):void 0}},Gt={name:"subdomain",lookup(t){var o,s;let{lookupFromSubdomainIndex:n}=t;const r=typeof n=="number"?n+1:1,e=typeof window<"u"&&((s=(o=window.location)==null?void 0:o.hostname)==null?void 0:s.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(e)return e[r]}};let Pe=!1;try{document.cookie,Pe=!0}catch{}const Ee=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Pe||Ee.splice(1,1);const Qt=()=>({order:Ee,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class Ie{constructor(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(n,r)}init(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=At(r,this.options||{},Qt()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=o=>o.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=e,this.addDetector($t),this.addDetector(Ut),this.addDetector(Ht),this.addDetector(Ft),this.addDetector(Bt),this.addDetector(Xt),this.addDetector(Vt),this.addDetector(Gt),this.addDetector(zt)}addDetector(n){return this.detectors[n.name]=n,this}detect(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return n.forEach(e=>{if(this.detectors[e]){let o=this.detectors[e].lookup(this.options);o&&typeof o=="string"&&(o=[o]),o&&(r=r.concat(o))}}),r=r.filter(e=>e!=null&&!Dt(e)).map(e=>this.options.convertDetectedLanguage(e)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||r.forEach(e=>{this.detectors[e]&&this.detectors[e].cacheUserLanguage(n,this.options)}))}}Ie.type="languageDetector";function ie(t){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ie(t)}function Ce(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":ie(XMLHttpRequest))==="object"}function Wt(t){return!!t&&typeof t.then=="function"}function Jt(t){return Wt(t)?t:Promise.resolve(t)}function xe(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,e)}return r}function be(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?xe(Object(r),!0).forEach(function(e){Kt(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Kt(t,n,r){return(n=qt(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function qt(t){var n=Yt(t,"string");return F(n)=="symbol"?n:n+""}function Yt(t,n){if(F(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var e=r.call(t,n);if(F(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function F(t){"@babel/helpers - typeof";return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},F(t)}var U=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?U=global.fetch:typeof window<"u"&&window.fetch&&(U=window.fetch);var W;Ce()&&(typeof global<"u"&&global.XMLHttpRequest?W=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(W=window.XMLHttpRequest));var Z;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?Z=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(Z=window.ActiveXObject));typeof U!="function"&&(U=void 0);if(!U&&!W&&!Z)try{L(()=>import("./browser-ponyfill-DPU6vdVN.js").then(t=>t.b),__vite__mapDeps([21,2])).then(function(t){U=t.default}).catch(function(){})}catch{}var oe=function(n,r){if(r&&F(r)==="object"){var e="";for(var o in r)e+="&"+encodeURIComponent(o)+"="+encodeURIComponent(r[o]);if(!e)return n;n=n+(n.indexOf("?")!==-1?"&":"?")+e.slice(1)}return n},ye=function(n,r,e,o){var s=function(d){if(!d.ok)return e(d.statusText||"Error",{status:d.status});d.text().then(function(p){e(null,{status:d.status,data:p})}).catch(e)};if(o){var a=o(n,r);if(a instanceof Promise){a.then(s).catch(e);return}}typeof fetch=="function"?fetch(n,r).then(s).catch(e):U(n,r).then(s).catch(e)},we=!1,Zt=function(n,r,e,o){n.queryStringParams&&(r=oe(r,n.queryStringParams));var s=be({},typeof n.customHeaders=="function"?n.customHeaders():n.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(s["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),e&&(s["Content-Type"]="application/json");var a=typeof n.requestOptions=="function"?n.requestOptions(e):n.requestOptions,l=be({method:e?"POST":"GET",body:e?n.stringify(e):void 0,headers:s},we?{}:a),d=typeof n.alternateFetch=="function"&&n.alternateFetch.length>=1?n.alternateFetch:void 0;try{ye(r,l,o,d)}catch(p){if(!a||Object.keys(a).length===0||!p.message||p.message.indexOf("not implemented")<0)return o(p);try{Object.keys(a).forEach(function(g){delete l[g]}),ye(r,l,o,d),we=!0}catch(g){o(g)}}},en=function(n,r,e,o){e&&F(e)==="object"&&(e=oe("",e).slice(1)),n.queryStringParams&&(r=oe(r,n.queryStringParams));try{var s=W?new W:new Z("MSXML2.XMLHTTP.3.0");s.open(e?"POST":"GET",r,1),n.crossDomain||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.withCredentials=!!n.withCredentials,e&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.overrideMimeType&&s.overrideMimeType("application/json");var a=n.customHeaders;if(a=typeof a=="function"?a():a,a)for(var l in a)s.setRequestHeader(l,a[l]);s.onreadystatechange=function(){s.readyState>3&&o(s.status>=400?s.statusText:null,{status:s.status,data:s.responseText})},s.send(e)}catch(d){console&&console.log(d)}},tn=function(n,r,e,o){if(typeof e=="function"&&(o=e,e=void 0),o=o||function(){},U&&r.indexOf("file:")!==0)return Zt(n,r,e,o);if(Ce()||typeof ActiveXObject=="function")return en(n,r,e,o);o(new Error("No fetch and no xhr implementation found!"))};function G(t){"@babel/helpers - typeof";return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},G(t)}function je(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,e)}return r}function ne(t){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?je(Object(r),!0).forEach(function(e){Le(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function nn(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function rn(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,Ae(e.key),e)}}function sn(t,n,r){return n&&rn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Le(t,n,r){return(n=Ae(n))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Ae(t){var n=on(t,"string");return G(n)=="symbol"?n:n+""}function on(t,n){if(G(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var e=r.call(t,n);if(G(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var an=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,e,o){return Le({},e,o||"")},parseLoadPayload:function(r,e){},request:tn,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},De=function(){function t(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};nn(this,t),this.services=n,this.options=r,this.allOptions=e,this.type="backend",this.init(n,r,e)}return sn(t,[{key:"init",value:function(r){var e=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=ne(ne(ne({},an()),this.options||{}),o),this.allOptions=s,this.services&&this.options.reloadInterval){var a=setInterval(function(){return e.reload()},this.options.reloadInterval);G(a)==="object"&&typeof a.unref=="function"&&a.unref()}}},{key:"readMulti",value:function(r,e,o){this._readAny(r,r,e,e,o)}},{key:"read",value:function(r,e,o){this._readAny([r],r,[e],e,o)}},{key:"_readAny",value:function(r,e,o,s,a){var l=this,d=this.options.loadPath;typeof this.options.loadPath=="function"&&(d=this.options.loadPath(r,o)),d=Jt(d),d.then(function(p){if(!p)return a(null,{});var g=l.services.interpolator.interpolate(p,{lng:r.join("+"),ns:o.join("+")});l.loadUrl(g,a,e,s)})}},{key:"loadUrl",value:function(r,e,o,s){var a=this,l=typeof o=="string"?[o]:o,d=typeof s=="string"?[s]:s,p=this.options.parseLoadPayload(l,d);this.options.request(this.options,r,p,function(g,m){if(m&&(m.status>=500&&m.status<600||!m.status))return e("failed loading "+r+"; status code: "+m.status,!0);if(m&&m.status>=400&&m.status<500)return e("failed loading "+r+"; status code: "+m.status,!1);if(!m&&g&&g.message){var h=g.message.toLowerCase(),y=["failed","fetch","network","load"].find(function(b){return h.indexOf(b)>-1});if(y)return e("failed loading "+r+": "+g.message,!0)}if(g)return e(g,!1);var c,v;try{typeof m.data=="string"?c=a.options.parse(m.data,o,s):c=m.data}catch{v="failed parsing "+r+" to json"}if(v)return e(v,!1);e(null,c)})}},{key:"create",value:function(r,e,o,s,a){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var d=this.options.parsePayload(e,o,s),p=0,g=[],m=[];r.forEach(function(h){var y=l.options.addPath;typeof l.options.addPath=="function"&&(y=l.options.addPath(h,e));var c=l.services.interpolator.interpolate(y,{lng:h,ns:e});l.options.request(l.options,c,d,function(v,b){p+=1,g.push(v),m.push(b),p===r.length&&typeof a=="function"&&a(g,m)})})}}},{key:"reload",value:function(){var r=this,e=this.services,o=e.backendConnector,s=e.languageUtils,a=e.logger,l=o.language;if(!(l&&l.toLowerCase()==="cimode")){var d=[],p=function(m){var h=s.toResolveHierarchy(m);h.forEach(function(y){d.indexOf(y)<0&&d.push(y)})};p(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(g){return p(g)}),d.forEach(function(g){r.allOptions.ns.forEach(function(m){o.read(g,m,"read",null,null,function(h,y){h&&a.warn("loading namespace ".concat(m," for language ").concat(g," failed"),h),!h&&y&&a.log("loaded namespace ".concat(m," for language ").concat(g),y),o.loaded("".concat(g,"|").concat(m),h,y)})})})}}}])}();De.type="backend";tt.use(De).use(Ie).use(nt).init({fallbackLng:"ru",debug:!1,interpolation:{escapeValue:!1},backend:{loadPath:"/Donishmand_platform/locales/{{lng}}/translation.json?v="+new Date().getTime()},detection:{order:["localStorage","navigator"],caches:["localStorage"]},react:{useSuspense:!1}});class ln extends E.Component{constructor(n){super(n),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Global Error Caught:",n,r),this.setState({errorInfo:r})}render(){return this.state.hasError?i.jsxs("div",{style:{padding:"2rem",backgroundColor:"#1a1a2e",color:"#fff",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"sans-serif"},children:[i.jsx("h1",{style:{color:"#ff49db",marginBottom:"1rem"},children:"–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ :("}),i.jsx("p",{style:{marginBottom:"2rem",opacity:.8},children:"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è."}),i.jsxs("div",{style:{padding:"1rem",backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:"0.5rem",maxWidth:"800px",width:"100%",overflow:"auto",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[i.jsx("code",{style:{color:"#ff7eb3",display:"block",marginBottom:"0.5rem"},children:this.state.error&&this.state.error.toString()}),i.jsx("pre",{style:{fontSize:"0.8rem",opacity:.6,whiteSpace:"pre-wrap"},children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}),i.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"2rem",padding:"0.75rem 2rem",backgroundColor:"#7c3aed",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),i.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{marginTop:"1rem",padding:"0.75rem 2rem",backgroundColor:"transparent",color:"#e2e8f0",border:"1px solid #4a5568",borderRadius:"0.5rem",cursor:"pointer",fontSize:"0.9rem"},children:"–°–±—Ä–æ—Å–∏—Ç—å –∫—ç—à –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å"})]}):this.props.children}}se.createRoot(document.getElementById("root")).render(i.jsx(E.StrictMode,{children:i.jsx(ln,{children:i.jsx(It,{})})}));export{Y as A,q as C,Oe as S,L as _,O as a,gn as b,pt as s,te as u};
