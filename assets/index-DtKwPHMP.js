const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SubjectPage-DQghJl_x.js","assets/editor-8tw8cCTw.js","assets/vendor-DfgOC3sD.js","assets/ui-DOqj-4Eh.js","assets/CourseLayout-C10EU-zn.js","assets/SyllabusContext-BoaOMks1.js","assets/syllabusService-vM0591ed.js","assets/progressHelpers-CJ7J7Gvk.js","assets/supabase-CQnWzhEg.js","assets/SectionPage-CEaLQ8Ug.js","assets/TopicPage-BihrF2T3.js","assets/LessonPage-CWfrdoST.js","assets/katex-G9EdgA5J.js","assets/CreatorPage-Cjnhu5E0.js","assets/useDebounce-DE7P2URC.js","assets/AdminPage-DnwIdr0P.js","assets/branchService-CHl-KD3o.js","assets/AuthPage-BWpXYA4V.js","assets/ClassesPage-g7xIVBEP.js","assets/ClassDetailsPage-Bc6eQ9kQ.js","assets/ProfilePage-B5NsHQRG.js","assets/NotFoundPage-DoXtDw6t.js","assets/browser-ponyfill-DPU6vdVN.js"])))=>i.map(i=>d[i]);
import{j as n}from"./editor-8tw8cCTw.js";import{a as Pe,r as w,u as Ee,c as X,L as O,N as $,R as N,B as Ce,d as Le,e as k}from"./vendor-DfgOC3sD.js";import{c as me}from"./supabase-CQnWzhEg.js";import{u as T,S as ge,C as Te,U as Re,L as ee,X as Ie,M as Ae,A as De,a as he,b as fe,c as z,d as qe,G as Me,e as Ue,B as $e,f as G,g as ze,h as He,i as Fe,j as Xe,k as Be,l as Ve,m as Ge}from"./ui-DOqj-4Eh.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function e(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var W={},te=Pe;W.createRoot=te.createRoot,W.hydrateRoot=te.hydrateRoot;const We="modulepreload",Ke=function(o){return"/Donishmand_platform/"+o},ne={},P=function(t,r,e){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=Ke(c),c in ne)return;ne[c]=!0;const g=c.endsWith(".css"),u=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const m=document.createElement("link");if(m.rel=g?"stylesheet":We,g||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),g)return new Promise((f,p)=>{m.addEventListener("load",f),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})},pe="https://holeptxxbmpmhlkgzpoa.supabase.co",xe="sb_publishable_p6Y6Ff7daOq0qNRUwD_aWQ_a14jcoFg",R=me(pe,xe),Je={getItem:()=>null,setItem:()=>{},removeItem:()=>{}},Zt=me(pe,xe,{auth:{storageKey:"sb-admin-create-user",storage:Je,persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}}),be=w.createContext({}),B=()=>w.useContext(be),Qe=()=>{Object.keys(localStorage).forEach(o=>{o.startsWith("sb-")&&localStorage.removeItem(o)}),Object.keys(sessionStorage).forEach(o=>{o.startsWith("sb-")&&sessionStorage.removeItem(o)})},Ye=({children:o})=>{var S;const r=(()=>{try{const h=localStorage.getItem("sb-profile-cache");if(h){let b;try{b=JSON.parse(h)}catch(_){return console.warn("⚠️ Ошибка парсинга кеша профиля, кеш будет сброшен",_),localStorage.removeItem("sb-profile-cache"),{user:null,profile:null,permissions:[],loading:!0}}if(Date.now()-b.timestamp<864e5)return{user:{id:b.userId},profile:b.profile,permissions:b.permissions||[],loading:!1}}}catch(h){console.error("Error reading initial cache",h)}return{user:null,profile:null,permissions:[],loading:!0}})(),[e,i]=w.useState(r.user),[s,a]=w.useState(r.profile),[l,c]=w.useState(r.permissions),[g,u]=w.useState(r.loading),m=w.useRef(!1),f=w.useRef(((S=r.user)==null?void 0:S.id)||null),p=async h=>{if(!h)return null;const b=(d,v=5e3)=>Promise.race([d,new Promise((y,C)=>setTimeout(()=>C(new Error("TIMEOUT")),v))]),_=async d=>{let v=[];if((d==null?void 0:d.role)==="teacher"){const{data:y}=await R.from("subject_permissions").select("subject_id, can_edit").eq("user_id",h.id);v=y||[]}c(v);try{d&&localStorage.setItem("sb-profile-cache",JSON.stringify({profile:d,permissions:v,userId:h.id,timestamp:Date.now()}))}catch(y){console.error("Ошибка сохранения кеша:",y)}return d};try{try{let{data:d,error:v}=await b(R.rpc("get_my_profile"),5e3);if(d&&d.length>0?d=d[0]:!v&&(!d||d.length===0)&&(d=null),d&&!v)return await _(d)}catch{}try{const{data:d,error:v}=await b(R.from("profiles").select("*").eq("id",h.id).maybeSingle(),1e4);if(d&&!v)return await _(d);v&&console.error("Ошибка прямого запроса:",v)}catch(d){console.error("Таймаут прямого запроса:",d)}}catch(d){console.error("Ошибка загрузки профиля (Global):",d)}return null};w.useEffect(()=>{let h=!0,b=!1;(async()=>{try{const{data:{session:y}}=await R.auth.getSession();if(y!=null&&y.user){f.current===y.user.id||h&&u(!0),h&&(i(y.user),f.current=y.user.id);const Z=await p(y.user);h&&a(Z)}else h&&(i(null),f.current=null,a(null),c([]))}catch(y){console.error("Ошибка при инициализации auth:",y)}finally{h&&(b=!0,u(!1))}})();const{data:{subscription:d}}=R.auth.onAuthStateChange(async(y,C)=>{if(!m.current&&h){if(y==="SIGNED_OUT")i(null),f.current=null,a(null),c([]),u(!1);else if((y==="SIGNED_IN"||y==="TOKEN_REFRESHED")&&(C==null?void 0:C.user)&&C.user.id!==f.current){if(b&&f.current===C.user.id)return;u(!0),i(C.user),f.current=C.user.id;const Oe=await p(C.user);h&&(a(Oe),u(!1))}}}),v=setTimeout(()=>{h&&u(y=>y&&(console.warn("⚠️ Сработала логика безопасного таймаута"),!1))},1e4);return()=>{h=!1,d.unsubscribe(),clearTimeout(v)}},[]);const x={user:e,profile:s,permissions:l,loading:g,signOut:async()=>{Qe(),i(null),a(null);try{await Promise.race([R.auth.signOut(),new Promise(h=>setTimeout(h,2e3))])}catch(h){console.error("SignOut error (ignored):",h)}window.location.href="/Donishmand_platform/"},updateSelectedSubjects:async h=>{if(!e)return!1;try{const{error:b}=await R.from("profiles").update({selected_subjects:h}).eq("id",e.id);if(b)throw b;a(_=>({..._,selected_subjects:h}));try{const _=localStorage.getItem("sb-profile-cache");if(_){const d=JSON.parse(_);d.profile={...d.profile,selected_subjects:h},localStorage.setItem("sb-profile-cache",JSON.stringify(d))}}catch{}return!0}catch(b){return console.error("Ошибка при обновлении выбранных предметов:",b),!1}},isAuthenticated:!!e,isTeacher:(s==null?void 0:s.role)==="teacher",isAdmin:(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="super_admin",isSuperAdmin:(s==null?void 0:s.role)==="super_admin",setSkipAuthChange:h=>{m.current=h},canEditSubject:h=>(s==null?void 0:s.role)==="super_admin"?!0:(s==null?void 0:s.role)==="teacher"?l.some(b=>b.subject_id===h&&b.can_edit):!1,canViewSubject:h=>(s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"?!0:(s==null?void 0:s.role)==="teacher"?(s==null?void 0:s.subject)===h:!0};return n.jsx(be.Provider,{value:x,children:o})},Ze=()=>{var _;const{t:o,i18n:t}=T(),{user:r,profile:e,signOut:i,permissions:s}=B(),a=Ee(),l=X(),[c,g]=w.useState(!1),[u,m]=w.useState(!1),[f,p]=w.useState(!1),j=w.useRef(null);w.useEffect(()=>{const d=()=>m(window.scrollY>20);window.addEventListener("scroll",d);const v=y=>{j.current&&!j.current.contains(y.target)&&p(!1)};return document.addEventListener("mousedown",v),()=>{window.removeEventListener("scroll",d),document.removeEventListener("mousedown",v)}},[]);const E=()=>{const d=t.resolvedLanguage==="ru"?"tj":"ru";t.changeLanguage(d)},x=async()=>{await i(),a("/"),p(!1),g(!1)},S=t.resolvedLanguage||"ru",h=e!=null&&e.full_name?e.full_name.split(" ").map(d=>d[0]).join("").substring(0,2).toUpperCase():((_=r==null?void 0:r.email)==null?void 0:_[0].toUpperCase())||"U",b=d=>{switch(d){case"super_admin":return o("profilePage.roleSuperAdmin");case"admin":return o("profilePage.roleAdmin");case"teacher":return o("profilePage.roleTeacher");default:return o("studentRole")}};return n.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${u?"bg-gaming-bg/80 backdrop-blur-xl border-b border-white/5 py-3":"bg-transparent py-6"}`,children:[n.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs(O,{to:"/",className:"flex items-center gap-3 group cursor-pointer",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-gaming-primary to-gaming-pink rounded-xl flex items-center justify-center shadow-lg shadow-gaming-primary/20 group-hover:scale-105 transition-transform duration-300",children:n.jsx(ge,{className:"text-white w-6 h-6"})}),n.jsx("span",{className:"font-bold text-2xl tracking-tight text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-gaming-primary/80 transition-all",children:"Donishmand"})]}),n.jsxs("div",{className:"hidden md:flex items-center bg-white/5 backdrop-blur-md rounded-full border border-white/5 p-1.5 shadow-sm",children:[n.jsxs("button",{onClick:()=>{var d;l.pathname!=="/"?a({pathname:"/",hash:"#courses-section"}):(d=document.getElementById("courses-section"))==null||d.scrollIntoView({behavior:"smooth"})},className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[o("navCourses"),n.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),n.jsxs(O,{to:"/",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[o("navAbout"),n.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),r&&n.jsxs(O,{to:"/classes",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group border-l border-white/10 ml-2 pl-6",children:[(e==null?void 0:e.role)==="student"?"Мои классы":"Классы",n.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-purple -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="teacher"&&(s==null?void 0:s.some(d=>d.can_edit)))&&n.jsxs(O,{to:"/creator",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[o("navCreator"),n.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-gaming-accent -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin")&&n.jsxs(O,{to:"/admin",className:"px-5 py-2 text-sm font-medium text-gaming-textMuted hover:text-white transition-colors relative group",children:[o("navAdmin"),n.jsx("span",{className:"absolute bottom-1 left-1/2 w-0 h-0.5 bg-red-500 -translate-x-1/2 group-hover:w-1/2 transition-all duration-300"})]}),n.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),n.jsx("button",{onClick:E,className:"px-3 py-1.5 text-xs font-bold bg-white/5 rounded-full text-white hover:bg-gaming-primary hover:text-white transition-colors uppercase ring-1 ring-white/10",children:S})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"hidden md:block",children:r?n.jsxs("div",{className:"relative",ref:j,children:[n.jsxs("button",{onClick:()=>p(!f),className:"flex items-center gap-3 pl-1 pr-3 py-1 bg-white/5 hover:bg-white/10 border border-white/5 rounded-full transition-all group",children:[n.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-gaming-primary to-gaming-purple flex items-center justify-center text-white font-bold text-sm shadow-inner",children:h}),n.jsxs("div",{className:"text-left hidden lg:block",children:[n.jsx("div",{className:"text-xs font-bold text-white leading-none mb-0.5",children:(e==null?void 0:e.full_name)||r.email}),n.jsx("div",{className:"text-[10px] text-gaming-textMuted uppercase tracking-wider leading-none",children:b(e==null?void 0:e.role)})]}),n.jsx(Te,{size:14,className:`text-gaming-textMuted transition-transform ${f?"rotate-180":""}`})]}),f&&n.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-gaming-card border border-white/10 rounded-xl shadow-2xl py-2 animate-fade-in-up origin-top-right backdrop-blur-xl",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-white/5 lg:hidden",children:[n.jsx("p",{className:"text-sm font-bold text-white truncate",children:(e==null?void 0:e.full_name)||r.email}),n.jsx("p",{className:"text-xs text-gaming-textMuted mt-0.5 uppercase tracking-wider",children:b(e==null?void 0:e.role)})]}),n.jsxs("div",{className:"py-1",children:[n.jsxs("button",{onClick:()=>{a("/profile"),p(!1)},className:"w-full text-left px-4 py-2.5 text-sm text-gaming-textMuted hover:text-white hover:bg-white/5 flex items-center gap-2 transition-colors",children:[n.jsx(Re,{size:16}),o("profile")]}),n.jsxs("button",{onClick:x,className:"w-full text-left px-4 py-2.5 text-sm text-red-400 hover:text-red-300 hover:bg-red-500/10 flex items-center gap-2 transition-colors",children:[n.jsx(ee,{size:16}),o("logout")]})]})]})]}):n.jsx(O,{to:"/login",className:"bg-gradient-to-r from-gaming-primary to-gaming-pink text-white px-6 py-2.5 rounded-full font-medium text-sm transition-all shadow-lg shadow-gaming-primary/25 hover:shadow-gaming-pink/25 hover:scale-105 active:scale-95 inline-block",children:o("navLogin")})}),n.jsx("button",{onClick:()=>g(!c),className:"md:hidden p-2 text-white hover:bg-white/10 rounded-lg transition-colors",children:c?n.jsx(Ie,{}):n.jsx(Ae,{})})]})]})}),c&&n.jsx("div",{className:"absolute top-full left-0 right-0 bg-gaming-card border-b border-white/5 p-4 shadow-xl md:hidden glass-panel",children:n.jsxs("div",{className:"flex flex-col gap-4",children:[r&&n.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white/5 rounded-xl border border-white/5",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-gaming-primary to-gaming-purple flex items-center justify-center text-white font-bold shadow-inner",children:h}),n.jsxs("div",{className:"overflow-hidden",children:[n.jsx("div",{className:"font-bold text-white truncate",children:(e==null?void 0:e.full_name)||r.email}),n.jsx("div",{className:"text-xs text-gaming-textMuted uppercase tracking-wider",children:b(e==null?void 0:e.role)})]})]}),n.jsx("button",{onClick:()=>{var d;g(!1),l.pathname!=="/"?a({pathname:"/",hash:"#courses-section"}):(d=document.getElementById("courses-section"))==null||d.scrollIntoView({behavior:"smooth"})},className:"text-left font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:o("navCourses")}),n.jsx(O,{to:"/",onClick:()=>g(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:o("navAbout")}),r&&n.jsx(O,{to:"/classes",onClick:()=>g(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors border-l-2 border-gaming-purple ml-2",children:(e==null?void 0:e.role)==="student"?"Мои классы":"Классы"}),((e==null?void 0:e.role)==="super_admin"||(e==null?void 0:e.role)==="teacher"&&(s==null?void 0:s.some(d=>d.can_edit)))&&n.jsx(O,{to:"/creator",onClick:()=>g(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:o("navCreator")}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin")&&n.jsx(O,{to:"/admin",onClick:()=>g(!1),className:"font-medium text-white/80 hover:text-white px-4 py-2 hover:bg-white/5 rounded-lg transition-colors",children:o("navAdmin")}),n.jsxs("div",{className:"border-t border-white/5 pt-4 flex items-center justify-between px-4",children:[n.jsx("button",{onClick:E,className:"px-3 py-1 bg-white/5 text-white rounded-md text-xs font-bold uppercase ring-1 ring-white/10",children:S}),r?n.jsxs("button",{onClick:x,className:"text-sm font-medium text-red-400 flex items-center gap-2",children:[n.jsx(ee,{size:16}),o("logout")]}):n.jsx(O,{to:"/login",onClick:()=>g(!1),className:"text-sm font-medium text-gaming-primary",children:o("navLogin")})]})]})})]})},et=()=>{const{t:o}=T();return n.jsxs("footer",{className:"relative bg-gaming-bg border-t border-white/5 py-12 mt-20",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gaming-primary/5 to-transparent pointer-events-none"}),n.jsx("div",{className:"max-w-7xl mx-auto px-4 text-center relative z-10",children:n.jsx("p",{className:"text-gaming-textMuted text-sm font-medium",children:o("footerText")})})]})},tt=()=>{const{t:o}=T();return n.jsxs("div",{className:"relative w-full overflow-hidden pt-36 pb-20 lg:pt-48 lg:pb-32",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[800px] h-[800px] bg-gaming-primary/20 rounded-full blur-[150px] pointer-events-none translate-x-1/3 -translate-y-1/3 animate-pulse-slow"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-[600px] h-[600px] bg-gaming-pink/10 rounded-full blur-[120px] pointer-events-none -translate-x-1/3 translate-y-1/3 animate-pulse-slow"}),n.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center z-10",children:[n.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-md shadow-sm text-gaming-accent text-sm font-medium mb-8 animate-fade-in-up",children:[n.jsx(ge,{size:16,className:"text-gaming-gold"}),n.jsx("span",{className:"tracking-wide uppercase text-[11px] font-bold",children:o("badge")})]}),n.jsx("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight leading-[1.1] animate-fade-in-up delay-[100ms] drop-shadow-2xl",children:n.jsx("span",{dangerouslySetInnerHTML:{__html:o("heroTitle")}})}),n.jsx("p",{className:"text-lg md:text-xl text-gaming-textMuted mb-12 max-w-2xl mx-auto leading-relaxed animate-fade-in-up delay-[200ms]",children:o("heroSubtitle")}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center items-center w-full animate-fade-in-up delay-[300ms]",children:[n.jsxs("button",{onClick:()=>{var t;return(t=document.getElementById("courses-section"))==null?void 0:t.scrollIntoView({behavior:"smooth"})},className:"group relative bg-gaming-primary hover:bg-gaming-primary/90 text-white px-8 py-4 rounded-2xl font-bold transition-all active:scale-95 shadow-lg shadow-gaming-primary/25 flex items-center justify-center gap-2 text-lg overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),n.jsx("span",{children:o("ctaStart")}),n.jsx(De,{size:20,className:"text-gaming-gold group-hover:translate-x-1 transition-transform"})]}),n.jsx("button",{onClick:()=>{var t;return(t=document.getElementById("courses-section"))==null?void 0:t.scrollIntoView({behavior:"smooth"})},className:"group bg-transparent hover:bg-white/5 text-white border border-white/10 px-8 py-4 rounded-2xl font-bold transition-all active:scale-95 flex items-center justify-center gap-2 text-lg backdrop-blur-sm",children:o("ctaCatalog")})]}),n.jsx("div",{className:"absolute top-1/2 left-10 hidden lg:block animate-float opacity-30",children:n.jsx(he,{size:80,className:"text-gaming-accent rotate-12 drop-shadow-[0_0_15px_rgba(0,224,255,0.5)]"})}),n.jsx("div",{className:"absolute top-1/3 right-10 hidden lg:block animate-float opacity-30",style:{animationDelay:"2s"},children:n.jsx(fe,{size:80,className:"text-gaming-pink -rotate-12 drop-shadow-[0_0_15px_rgba(255,73,219,0.5)]"})})]})]})},Y={"tj-lang":{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:G},lit:{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:G},math:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:he},phys:{color:"text-gaming-accent",bg:"bg-gaming-accent/10",icon:fe},chem:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:$e},bio:{color:"text-gaming-gold",bg:"bg-gaming-gold/10",icon:Ue},geo:{color:"text-gaming-gold",bg:"bg-gaming-gold/10",icon:Me},hist:{color:"text-gaming-text",bg:"bg-gaming-text/10",icon:qe},eng:{color:"text-gaming-accent",bg:"bg-gaming-accent/10",icon:z},ger:{color:"text-gaming-text",bg:"bg-gaming-text/10",icon:z},fra:{color:"text-gaming-pink",bg:"bg-gaming-pink/10",icon:z},ara:{color:"text-gaming-primary",bg:"bg-gaming-primary/10",icon:z}},ye={"tj-lang":{ru:"Таджикский язык",tj:"Забони Тоҷикӣ"},math:{ru:"Математика",tj:"Математика"},phys:{ru:"Физика",tj:"Физика"},chem:{ru:"Химия",tj:"Химия"},geo:{ru:"География",tj:"География"},hist:{ru:"История",tj:"Таърих"},lit:{ru:"Литература",tj:"Адабиёт"},bio:{ru:"Биология",tj:"Биология"},eng:{ru:"Английский",tj:"Забони Англисӣ"},ger:{ru:"Немецкий",tj:"Забони Немисӣ"},fra:{ru:"Французский",tj:"Забони Франсавӣ"},ara:{ru:"Арабский",tj:"Забони Арабӣ"}},H=[{id:1,titleRu:"Естественный и тех.",titleTj:"Табиӣ ва техникӣ",subjects:["tj-lang","math","phys","chem"]},{id:2,titleRu:"Экономика и Гео.",titleTj:"Иқтисод ва География",subjects:["tj-lang","math","geo","eng","fra","ger","ara"]},{id:3,titleRu:"Филология и Искусство",titleTj:"Филология ва Санъат",subjects:["tj-lang","hist","lit","eng","fra","ger","ara"]},{id:4,titleRu:"Общество и Право",titleTj:"Ҷомеашиносӣ ва Ҳуқуқ",subjects:["tj-lang","hist","eng","fra","ger","ara"]},{id:5,titleRu:"Медицина и Биология",titleTj:"Тиб ва Биология",subjects:["tj-lang","bio","chem","phys"]}],K=Object.keys(Y),nt=({subjectId:o})=>{const{i18n:t}=T(),r=t.resolvedLanguage||"ru",e=Y[o],i=ye[o][r],s=e.icon;return n.jsxs(O,{to:`/subject/${o}`,className:"block group relative bg-gaming-card rounded-3xl p-6 border border-white/5 hover:border-gaming-primary/30 shadow-lg shadow-black/20 hover:shadow-gaming-primary/10 transition-all duration-500 hover:-translate-y-2 cursor-pointer overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gaming-primary/0 via-gaming-primary/0 to-gaming-primary/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),n.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-6",children:[n.jsx("div",{className:`w-14 h-14 rounded-2xl ${e.bg} flex items-center justify-center group-hover:scale-110 transition-transform duration-300 ring-1 ring-white/5`,children:n.jsx(s,{size:28,className:e.color})}),n.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center text-white/40 group-hover:bg-gaming-primary group-hover:text-white transition-all duration-300",children:n.jsx(ze,{size:16})})]}),n.jsx("h3",{className:"relative z-10 text-xl font-bold text-white mb-4 leading-tight group-hover:text-gaming-accent transition-colors",children:i}),n.jsx("div",{className:"relative z-10 w-full h-1.5 bg-white/5 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gradient-to-r from-gaming-primary to-gaming-pink rounded-full",style:{width:"0%"}})})]})},rt=({activeClusterId:o,setActiveClusterId:t})=>{const{t:r,i18n:e}=T(),i=e.resolvedLanguage||"ru";return n.jsx("div",{id:"courses-section",className:"sticky top-20 z-30 transition-all mt-8",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4",children:n.jsx("div",{className:"glass-panel rounded-2xl p-2 overflow-x-auto no-scrollbar",children:n.jsxs("div",{className:"flex space-x-1 min-w-max",children:[n.jsxs("button",{onClick:()=>t(0),className:`
                px-4 py-2.5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 border
                ${o===0?"bg-gaming-card border-gaming-primary/50 text-white shadow-lg shadow-gaming-primary/10":"border-transparent text-gaming-textMuted hover:text-white hover:bg-white/5"}
              `,children:[n.jsx(He,{size:18,className:o===0?"text-gaming-accent":""}),r("allSubjects")]}),n.jsx("div",{className:"w-px h-8 bg-white/10 mx-2 self-center"}),H.map(s=>n.jsxs("button",{onClick:()=>t(s.id),className:`
                  px-4 py-2.5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 border
                  ${o===s.id?"bg-gaming-card border-gaming-primary/50 text-white shadow-lg shadow-gaming-primary/10":"border-transparent text-gaming-textMuted hover:text-white hover:bg-white/5"}
                `,children:[n.jsx("span",{className:`
                  flex items-center justify-center w-5 h-5 rounded-md text-[10px] font-bold transition-colors
                  ${o===s.id?"bg-gaming-primary text-white":"bg-white/10 text-white/50"}
                `,children:s.id}),i==="ru"?s.titleRu:s.titleTj]},s.id))]})})})})},ot=()=>{const{i18n:o}=T(),{updateSelectedSubjects:t,profile:r}=B(),[e,i]=w.useState([]),[s,a]=w.useState(!1),l=o.resolvedLanguage||"ru",c=u=>{i(m=>m.includes(u)?m.filter(f=>f!==u):[...m,u])},g=async()=>{e.length!==0&&(a(!0),await t(e),a(!1))};return n.jsxs("div",{className:"min-h-[80vh] flex flex-col items-center justify-center p-6 text-center animate-fade-in",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-gaming-primary/20 flex items-center justify-center mb-6 ring-2 ring-gaming-primary/50 shadow-lg shadow-gaming-primary/30",children:n.jsx(G,{className:"text-gaming-primary w-8 h-8"})}),n.jsxs("h1",{className:"text-4xl md:text-5xl font-heading font-bold text-white mb-4 drop-shadow-lg",children:["Добро пожаловать, ",(r==null?void 0:r.full_name)||"Ученик","!"]}),n.jsx("p",{className:"text-xl text-gray-300 mb-12 max-w-2xl",children:"Давайте настроим платформу под вас. Выберите предметы, которые вы планируете изучать:"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 w-full max-w-5xl mb-12",children:K.map(u=>{var j;const m=Y[u];if(!m)return null;const f=m.icon,p=e.includes(u);return n.jsxs("div",{onClick:()=>c(u),className:`relative cursor-pointer rounded-2xl p-6 flex flex-col items-center gap-4 transition-all duration-300 border-2
                                ${p?"bg-gaming-card/80 border-gaming-primary shadow-lg shadow-gaming-primary/20 scale-105":"bg-black/30 border-white/5 hover:bg-white/5 hover:border-white/20"}
                            `,children:[n.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-transform ${p?"scale-110":""} ${m.bg}`,children:n.jsx(f,{size:28,className:m.color})}),n.jsx("span",{className:"font-medium text-white text-center",children:((j=ye[u])==null?void 0:j[l])||u}),n.jsx("div",{className:`absolute top-4 right-4 transition-all duration-300 ${p?"opacity-100 transform scale-100":"opacity-0 transform scale-50"}`,children:n.jsx(Fe,{className:"text-gaming-primary w-6 h-6"})})]},u)})}),n.jsx("button",{onClick:g,disabled:e.length===0||s,className:`
                    px-12 py-4 rounded-xl font-bold text-lg flex items-center gap-3 transition-all duration-300 shadow-xl
                    ${e.length>0?"bg-gaming-primary text-white hover:bg-gaming-primary-hover hover:scale-105 shadow-gaming-primary/30":"bg-white/5 text-gray-500 cursor-not-allowed border border-white/5"}
                `,children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Сохранение..."]}):n.jsxs(n.Fragment,{children:["Продолжить ",n.jsx(Xe,{size:20})]})}),n.jsx("p",{className:"mt-4 text-sm text-gray-500 max-w-md",children:"В будущем вы сможете добавить или изменить список предметов через администратора."})]})},st=()=>{const{t:o,i18n:t}=T(),[r,e]=w.useState(0),i=t.resolvedLanguage||"ru",{profile:s}=B(),a=X();w.useEffect(()=>{a.hash==="#courses-section"&&setTimeout(()=>{var x;(x=document.getElementById("courses-section"))==null||x.scrollIntoView({behavior:"smooth"})},100)},[a]);const c=(()=>{if((s==null?void 0:s.role)==="super_admin"||(s==null?void 0:s.role)==="admin"){if(r===0)return K;const S=H.find(h=>h.id===r);return S?S.subjects:[]}if((s==null?void 0:s.role)==="teacher"&&(s!=null&&s.subject))return[s.subject];if(s!=null&&s.selected_subjects&&s.selected_subjects.length>0)return s.selected_subjects;if(r===0)return K;const x=H.find(S=>S.id===r);return x?x.subjects:[]})(),g=(s==null?void 0:s.role)==="student"||!(s!=null&&s.role),u=(s==null?void 0:s.selected_subjects)&&s.selected_subjects.length>0,m=(s==null?void 0:s.role)==="teacher";(s==null?void 0:s.role)==="admin"||(s==null||s.role);const f=!s,p=()=>{if(m&&(s!=null&&s.subject))return o("allSubjects");if(g&&u)return"Мои предметы";if(r===0)return o("allSubjects");const x=H.find(S=>S.id===r);return`${o("cluster")} ${r}: ${i==="ru"?x==null?void 0:x.titleRu:x==null?void 0:x.titleTj}`},j=f,E=f;return!f&&g&&!u?n.jsx("main",{className:"relative",children:n.jsx(ot,{})}):n.jsxs("main",{className:"relative",children:[E&&n.jsx(tt,{}),j&&n.jsx(rt,{activeClusterId:r,setActiveClusterId:e}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 min-h-[600px] mt-10",children:[n.jsx("div",{className:"flex items-end justify-between mb-8 px-2",children:n.jsxs("div",{children:[n.jsx("h2",{className:"text-3xl font-bold text-white tracking-tight drop-shadow-lg",children:p()}),n.jsx("p",{className:"text-gaming-textMuted mt-2 text-lg",children:o("popularSubtitle")})]})}),c.length>0?n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 animate-fade-in-up",children:c.map((x,S)=>n.jsx(nt,{subjectId:x},`${r}-${x}-${S}`))}):n.jsx("div",{className:"text-center py-20 bg-white/5 rounded-3xl border border-white/10",children:n.jsx("p",{className:"text-white/60 text-lg",children:"Нет доступных предметов"})})]})]})},M=({children:o,requireTeacher:t=!1,requireAdmin:r=!1,requireSuperAdmin:e=!1})=>{const{user:i,profile:s,loading:a}=B(),l=X();return a?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gaming-bg",children:n.jsx(Be,{size:40,className:"text-gaming-primary animate-spin"})}):i?e&&(s==null?void 0:s.role)!=="super_admin"?n.jsx($,{to:"/",replace:!0}):r&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="super_admin"?n.jsx($,{to:"/",replace:!0}):t&&(s==null?void 0:s.role)!=="teacher"&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="super_admin"?n.jsx($,{to:"/",replace:!0}):o:n.jsx($,{to:"/login",state:{from:l},replace:!0})},it=N.lazy(()=>P(()=>import("./SubjectPage-DQghJl_x.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),at=N.lazy(()=>P(()=>import("./SectionPage-CEaLQ8Ug.js"),__vite__mapDeps([9,1,2,3,4,5,6,7,8]))),lt=N.lazy(()=>P(()=>import("./TopicPage-BihrF2T3.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8]))),ct=N.lazy(()=>P(()=>import("./LessonPage-CWfrdoST.js").then(o=>o.L),__vite__mapDeps([11,1,2,3,4,5,6,12]))),dt=N.lazy(()=>P(()=>import("./CreatorPage-Cjnhu5E0.js").then(o=>o.C),__vite__mapDeps([13,1,2,3,6,5,14]))),ut=N.lazy(()=>P(()=>import("./AdminPage-DnwIdr0P.js"),__vite__mapDeps([15,1,2,3,16,14,8]))),mt=N.lazy(()=>P(()=>import("./AuthPage-BWpXYA4V.js"),__vite__mapDeps([17,1,2,3,8]))),gt=N.lazy(()=>P(()=>import("./ClassesPage-g7xIVBEP.js"),__vite__mapDeps([18,1,2,3,16,8]))),ht=N.lazy(()=>P(()=>import("./ClassDetailsPage-Bc6eQ9kQ.js"),__vite__mapDeps([19,1,2,3,16,14,6,8]))),ft=N.lazy(()=>P(()=>import("./ProfilePage-B5NsHQRG.js"),__vite__mapDeps([20,1,2,3,8]))),pt=N.lazy(()=>P(()=>import("./NotFoundPage-DoXtDw6t.js"),__vite__mapDeps([21,1,2,3]))),xt=()=>n.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:n.jsxs("div",{className:"flex flex-col items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 border-4 border-gaming-primary/30 border-t-gaming-primary rounded-full animate-spin"}),n.jsx("span",{className:"text-gaming-textMuted text-sm",children:"Загрузка..."})]})});function bt(){const{i18n:o}=T(),t=X();return N.useEffect(()=>{window.scrollTo(0,0)},[t.pathname]),n.jsxs("div",{className:"min-h-screen bg-gaming-bg font-sans text-white selection:bg-gaming-pink/30 selection:text-white overflow-hidden flex flex-col",children:[n.jsx(Ze,{}),n.jsx("main",{className:"flex-grow pt-24",children:n.jsx(w.Suspense,{fallback:n.jsx(xt,{}),children:n.jsxs(Le,{children:[n.jsx(k,{path:"/",element:n.jsx(st,{})}),n.jsx(k,{path:"/subject/:subjectId",element:n.jsx(it,{})}),n.jsx(k,{path:"/subject/:subjectId/section/:sectionId",element:n.jsx(at,{})}),n.jsx(k,{path:"/subject/:subjectId/section/:sectionId/topic/:topicId",element:n.jsx(lt,{})}),n.jsx(k,{path:"/lesson/:lessonId",element:n.jsx(ct,{})}),n.jsx(k,{path:"/creator",element:n.jsx(M,{allowedRoles:["teacher","admin","super_admin"],children:n.jsx(dt,{})})}),n.jsx(k,{path:"/admin",element:n.jsx(M,{allowedRoles:["admin","super_admin"],children:n.jsx(ut,{})})}),n.jsx(k,{path:"/classes",element:n.jsx(M,{children:n.jsx(gt,{})})}),n.jsx(k,{path:"/classes/:classId",element:n.jsx(M,{children:n.jsx(ht,{})})}),n.jsx(k,{path:"/login",element:n.jsx(mt,{})}),n.jsx(k,{path:"/profile",element:n.jsx(M,{children:n.jsx(ft,{})})}),n.jsx(k,{path:"*",element:n.jsx(pt,{})})]})})}),n.jsx(et,{})]})}function yt(){return n.jsx(Ye,{children:n.jsx(Ce,{basename:"/Donishmand_platform/",children:n.jsx(bt,{})})})}const{slice:wt,forEach:vt}=[];function jt(o){return vt.call(wt.call(arguments,1),t=>{if(t)for(const r in t)o[r]===void 0&&(o[r]=t[r])}),o}function St(o){return typeof o!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(o))}const re=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,_t=function(o,t){const e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(t);let s=`${o}=${i}`;if(e.maxAge>0){const a=e.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(a)}`}if(e.domain){if(!re.test(e.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${e.domain}`}if(e.path){if(!re.test(e.path))throw new TypeError("option path is invalid");s+=`; Path=${e.path}`}if(e.expires){if(typeof e.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${e.expires.toUTCString()}`}if(e.httpOnly&&(s+="; HttpOnly"),e.secure&&(s+="; Secure"),e.sameSite)switch(typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return e.partitioned&&(s+="; Partitioned"),s},oe={create(o,t,r,e){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+r*60*1e3)),e&&(i.domain=e),document.cookie=_t(o,t,i)},read(o){const t=`${o}=`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){let i=r[e];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(t)===0)return i.substring(t.length,i.length)}return null},remove(o,t){this.create(o,"",-1,t)}};var Nt={name:"cookie",lookup(o){let{lookupCookie:t}=o;if(t&&typeof document<"u")return oe.read(t)||void 0},cacheUserLanguage(o,t){let{lookupCookie:r,cookieMinutes:e,cookieDomain:i,cookieOptions:s}=t;r&&typeof document<"u"&&oe.create(r,o,e,i,s)}},kt={name:"querystring",lookup(o){var e;let{lookupQuerystring:t}=o,r;if(typeof window<"u"){let{search:i}=window.location;!window.location.search&&((e=window.location.hash)==null?void 0:e.indexOf("?"))>-1&&(i=window.location.hash.substring(window.location.hash.indexOf("?")));const a=i.substring(1).split("&");for(let l=0;l<a.length;l++){const c=a[l].indexOf("=");c>0&&a[l].substring(0,c)===t&&(r=a[l].substring(c+1))}}return r}},Ot={name:"hash",lookup(o){var i;let{lookupHash:t,lookupFromHashIndex:r}=o,e;if(typeof window<"u"){const{hash:s}=window.location;if(s&&s.length>2){const a=s.substring(1);if(t){const l=a.split("&");for(let c=0;c<l.length;c++){const g=l[c].indexOf("=");g>0&&l[c].substring(0,g)===t&&(e=l[c].substring(g+1))}}if(e)return e;if(!e&&r>-1){const l=s.match(/\/([a-zA-Z-]*)/g);return Array.isArray(l)?(i=l[typeof r=="number"?r:0])==null?void 0:i.replace("/",""):void 0}}}return e}};let A=null;const se=()=>{if(A!==null)return A;try{if(A=typeof window<"u"&&window.localStorage!==null,!A)return!1;const o="i18next.translate.boo";window.localStorage.setItem(o,"foo"),window.localStorage.removeItem(o)}catch{A=!1}return A};var Pt={name:"localStorage",lookup(o){let{lookupLocalStorage:t}=o;if(t&&se())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(o,t){let{lookupLocalStorage:r}=t;r&&se()&&window.localStorage.setItem(r,o)}};let D=null;const ie=()=>{if(D!==null)return D;try{if(D=typeof window<"u"&&window.sessionStorage!==null,!D)return!1;const o="i18next.translate.boo";window.sessionStorage.setItem(o,"foo"),window.sessionStorage.removeItem(o)}catch{D=!1}return D};var Et={name:"sessionStorage",lookup(o){let{lookupSessionStorage:t}=o;if(t&&ie())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(o,t){let{lookupSessionStorage:r}=t;r&&ie()&&window.sessionStorage.setItem(r,o)}},Ct={name:"navigator",lookup(o){const t=[];if(typeof navigator<"u"){const{languages:r,userLanguage:e,language:i}=navigator;if(r)for(let s=0;s<r.length;s++)t.push(r[s]);e&&t.push(e),i&&t.push(i)}return t.length>0?t:void 0}},Lt={name:"htmlTag",lookup(o){let{htmlTag:t}=o,r;const e=t||(typeof document<"u"?document.documentElement:null);return e&&typeof e.getAttribute=="function"&&(r=e.getAttribute("lang")),r}},Tt={name:"path",lookup(o){var i;let{lookupFromPathIndex:t}=o;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?(i=r[typeof t=="number"?t:0])==null?void 0:i.replace("/",""):void 0}},Rt={name:"subdomain",lookup(o){var i,s;let{lookupFromSubdomainIndex:t}=o;const r=typeof t=="number"?t+1:1,e=typeof window<"u"&&((s=(i=window.location)==null?void 0:i.hostname)==null?void 0:s.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(e)return e[r]}};let we=!1;try{document.cookie,we=!0}catch{}const ve=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];we||ve.splice(1,1);const It=()=>({order:ve,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:o=>o});class je{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,r)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=jt(r,this.options||{},It()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=e,this.addDetector(Nt),this.addDetector(kt),this.addDetector(Pt),this.addDetector(Et),this.addDetector(Ct),this.addDetector(Lt),this.addDetector(Tt),this.addDetector(Rt),this.addDetector(Ot)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return t.forEach(e=>{if(this.detectors[e]){let i=this.detectors[e].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(r=r.concat(i))}}),r=r.filter(e=>e!=null&&!St(e)).map(e=>this.options.convertDetectedLanguage(e)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||r.forEach(e=>{this.detectors[e]&&this.detectors[e].cacheUserLanguage(t,this.options)}))}}je.type="languageDetector";function J(o){"@babel/helpers - typeof";return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(o)}function Se(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":J(XMLHttpRequest))==="object"}function At(o){return!!o&&typeof o.then=="function"}function Dt(o){return At(o)?o:Promise.resolve(o)}function ae(o,t){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);t&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),r.push.apply(r,e)}return r}function le(o){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ae(Object(r),!0).forEach(function(e){qt(o,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function qt(o,t,r){return(t=Mt(t))in o?Object.defineProperty(o,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[t]=r,o}function Mt(o){var t=Ut(o,"string");return I(t)=="symbol"?t:t+""}function Ut(o,t){if(I(o)!="object"||!o)return o;var r=o[Symbol.toPrimitive];if(r!==void 0){var e=r.call(o,t);if(I(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(o)}function I(o){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(o)}var L=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?L=global.fetch:typeof window<"u"&&window.fetch&&(L=window.fetch);var U;Se()&&(typeof global<"u"&&global.XMLHttpRequest?U=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(U=window.XMLHttpRequest));var F;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?F=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(F=window.ActiveXObject));typeof L!="function"&&(L=void 0);if(!L&&!U&&!F)try{P(()=>import("./browser-ponyfill-DPU6vdVN.js").then(o=>o.b),__vite__mapDeps([22,2])).then(function(o){L=o.default}).catch(function(){})}catch{}var Q=function(t,r){if(r&&I(r)==="object"){var e="";for(var i in r)e+="&"+encodeURIComponent(i)+"="+encodeURIComponent(r[i]);if(!e)return t;t=t+(t.indexOf("?")!==-1?"&":"?")+e.slice(1)}return t},ce=function(t,r,e,i){var s=function(c){if(!c.ok)return e(c.statusText||"Error",{status:c.status});c.text().then(function(g){e(null,{status:c.status,data:g})}).catch(e)};if(i){var a=i(t,r);if(a instanceof Promise){a.then(s).catch(e);return}}typeof fetch=="function"?fetch(t,r).then(s).catch(e):L(t,r).then(s).catch(e)},de=!1,$t=function(t,r,e,i){t.queryStringParams&&(r=Q(r,t.queryStringParams));var s=le({},typeof t.customHeaders=="function"?t.customHeaders():t.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(s["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),e&&(s["Content-Type"]="application/json");var a=typeof t.requestOptions=="function"?t.requestOptions(e):t.requestOptions,l=le({method:e?"POST":"GET",body:e?t.stringify(e):void 0,headers:s},de?{}:a),c=typeof t.alternateFetch=="function"&&t.alternateFetch.length>=1?t.alternateFetch:void 0;try{ce(r,l,i,c)}catch(g){if(!a||Object.keys(a).length===0||!g.message||g.message.indexOf("not implemented")<0)return i(g);try{Object.keys(a).forEach(function(u){delete l[u]}),ce(r,l,i,c),de=!0}catch(u){i(u)}}},zt=function(t,r,e,i){e&&I(e)==="object"&&(e=Q("",e).slice(1)),t.queryStringParams&&(r=Q(r,t.queryStringParams));try{var s=U?new U:new F("MSXML2.XMLHTTP.3.0");s.open(e?"POST":"GET",r,1),t.crossDomain||s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.withCredentials=!!t.withCredentials,e&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.overrideMimeType&&s.overrideMimeType("application/json");var a=t.customHeaders;if(a=typeof a=="function"?a():a,a)for(var l in a)s.setRequestHeader(l,a[l]);s.onreadystatechange=function(){s.readyState>3&&i(s.status>=400?s.statusText:null,{status:s.status,data:s.responseText})},s.send(e)}catch(c){console&&console.log(c)}},Ht=function(t,r,e,i){if(typeof e=="function"&&(i=e,e=void 0),i=i||function(){},L&&r.indexOf("file:")!==0)return $t(t,r,e,i);if(Se()||typeof ActiveXObject=="function")return zt(t,r,e,i);i(new Error("No fetch and no xhr implementation found!"))};function q(o){"@babel/helpers - typeof";return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(o)}function ue(o,t){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);t&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),r.push.apply(r,e)}return r}function V(o){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ue(Object(r),!0).forEach(function(e){_e(o,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})}return o}function Ft(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function Xt(o,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,Ne(e.key),e)}}function Bt(o,t,r){return t&&Xt(o.prototype,t),Object.defineProperty(o,"prototype",{writable:!1}),o}function _e(o,t,r){return(t=Ne(t))in o?Object.defineProperty(o,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[t]=r,o}function Ne(o){var t=Vt(o,"string");return q(t)=="symbol"?t:t+""}function Vt(o,t){if(q(o)!="object"||!o)return o;var r=o[Symbol.toPrimitive];if(r!==void 0){var e=r.call(o,t);if(q(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}var Gt=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,e,i){return _e({},e,i||"")},parseLoadPayload:function(r,e){},request:Ht,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},ke=function(){function o(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ft(this,o),this.services=t,this.options=r,this.allOptions=e,this.type="backend",this.init(t,r,e)}return Bt(o,[{key:"init",value:function(r){var e=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=V(V(V({},Gt()),this.options||{}),i),this.allOptions=s,this.services&&this.options.reloadInterval){var a=setInterval(function(){return e.reload()},this.options.reloadInterval);q(a)==="object"&&typeof a.unref=="function"&&a.unref()}}},{key:"readMulti",value:function(r,e,i){this._readAny(r,r,e,e,i)}},{key:"read",value:function(r,e,i){this._readAny([r],r,[e],e,i)}},{key:"_readAny",value:function(r,e,i,s,a){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(r,i)),c=Dt(c),c.then(function(g){if(!g)return a(null,{});var u=l.services.interpolator.interpolate(g,{lng:r.join("+"),ns:i.join("+")});l.loadUrl(u,a,e,s)})}},{key:"loadUrl",value:function(r,e,i,s){var a=this,l=typeof i=="string"?[i]:i,c=typeof s=="string"?[s]:s,g=this.options.parseLoadPayload(l,c);this.options.request(this.options,r,g,function(u,m){if(m&&(m.status>=500&&m.status<600||!m.status))return e("failed loading "+r+"; status code: "+m.status,!0);if(m&&m.status>=400&&m.status<500)return e("failed loading "+r+"; status code: "+m.status,!1);if(!m&&u&&u.message){var f=u.message.toLowerCase(),p=["failed","fetch","network","load"].find(function(x){return f.indexOf(x)>-1});if(p)return e("failed loading "+r+": "+u.message,!0)}if(u)return e(u,!1);var j,E;try{typeof m.data=="string"?j=a.options.parse(m.data,i,s):j=m.data}catch{E="failed parsing "+r+" to json"}if(E)return e(E,!1);e(null,j)})}},{key:"create",value:function(r,e,i,s,a){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var c=this.options.parsePayload(e,i,s),g=0,u=[],m=[];r.forEach(function(f){var p=l.options.addPath;typeof l.options.addPath=="function"&&(p=l.options.addPath(f,e));var j=l.services.interpolator.interpolate(p,{lng:f,ns:e});l.options.request(l.options,j,c,function(E,x){g+=1,u.push(E),m.push(x),g===r.length&&typeof a=="function"&&a(u,m)})})}}},{key:"reload",value:function(){var r=this,e=this.services,i=e.backendConnector,s=e.languageUtils,a=e.logger,l=i.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],g=function(m){var f=s.toResolveHierarchy(m);f.forEach(function(p){c.indexOf(p)<0&&c.push(p)})};g(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(u){return g(u)}),c.forEach(function(u){r.allOptions.ns.forEach(function(m){i.read(u,m,"read",null,null,function(f,p){f&&a.warn("loading namespace ".concat(m," for language ").concat(u," failed"),f),!f&&p&&a.log("loaded namespace ".concat(m," for language ").concat(u),p),i.loaded("".concat(u,"|").concat(m),f,p)})})})}}}])}();ke.type="backend";Ve.use(ke).use(je).use(Ge).init({fallbackLng:"ru",debug:!1,interpolation:{escapeValue:!1},backend:{loadPath:"/Donishmand_platform/locales/{{lng}}/translation.json?v="+new Date().getTime()},detection:{order:["localStorage","navigator"],caches:["localStorage"]},react:{useSuspense:!1}});class Wt extends N.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Global Error Caught:",t,r),this.setState({errorInfo:r})}render(){return this.state.hasError?n.jsxs("div",{style:{padding:"2rem",backgroundColor:"#1a1a2e",color:"#fff",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"sans-serif"},children:[n.jsx("h1",{style:{color:"#ff49db",marginBottom:"1rem"},children:"Что-то пошло не так :("}),n.jsx("p",{style:{marginBottom:"2rem",opacity:.8},children:"Произошла ошибка при отрисовке приложения."}),n.jsxs("div",{style:{padding:"1rem",backgroundColor:"rgba(255, 255, 255, 0.05)",borderRadius:"0.5rem",maxWidth:"800px",width:"100%",overflow:"auto",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[n.jsx("code",{style:{color:"#ff7eb3",display:"block",marginBottom:"0.5rem"},children:this.state.error&&this.state.error.toString()}),n.jsx("pre",{style:{fontSize:"0.8rem",opacity:.6,whiteSpace:"pre-wrap"},children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}),n.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"2rem",padding:"0.75rem 2rem",backgroundColor:"#7c3aed",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontSize:"1rem",fontWeight:"bold"},children:"Перезагрузить страницу"}),n.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},style:{marginTop:"1rem",padding:"0.75rem 2rem",backgroundColor:"transparent",color:"#e2e8f0",border:"1px solid #4a5568",borderRadius:"0.5rem",cursor:"pointer",fontSize:"0.9rem"},children:"Сбросить кэш и перезагрузить"})]}):this.props.children}}W.createRoot(document.getElementById("root")).render(n.jsx(N.StrictMode,{children:n.jsx(Wt,{children:n.jsx(yt,{})})}));export{K as A,H as C,ye as S,P as _,Zt as a,R as s,B as u};
